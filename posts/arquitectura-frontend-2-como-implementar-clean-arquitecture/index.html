<!DOCTYPE html><html lang="es-ES" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Arquitectura Frontend 2. Cómo implementar Clean Architecture en el Frontend." /><meta name="author" content="Benjamín" /><meta property="og:locale" content="es_ES" /><meta name="description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><meta property="og:description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><link rel="canonical" href="https://nullpointer-excelsior.github.io/posts/arquitectura-frontend-2-como-implementar-clean-arquitecture/" /><meta property="og:url" content="https://nullpointer-excelsior.github.io/posts/arquitectura-frontend-2-como-implementar-clean-arquitecture/" /><meta property="og:site_name" content="Nullpointer Excelsior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-11T02:38:47-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Arquitectura Frontend 2. Cómo implementar Clean Architecture en el Frontend." /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Benjamín"},"dateModified":"2023-10-11T02:38:47-03:00","datePublished":"2023-10-11T02:38:47-03:00","description":"Ingeniería de software aplicada, tips, buenas práctias y códigos","headline":"Arquitectura Frontend 2. Cómo implementar Clean Architecture en el Frontend.","mainEntityOfPage":{"@type":"WebPage","@id":"https://nullpointer-excelsior.github.io/posts/arquitectura-frontend-2-como-implementar-clean-arquitecture/"},"url":"https://nullpointer-excelsior.github.io/posts/arquitectura-frontend-2-como-implementar-clean-arquitecture/"}</script><title>Arquitectura Frontend 2. Cómo implementar Clean Architecture en el Frontend. | Nullpointer Excelsior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nullpointer Excelsior"><meta name="application-name" content="Nullpointer Excelsior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.webp" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nullpointer Excelsior</a></div><div class="site-subtitle font-italic">Ingeniería de software aplicada</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/nullpointer-excelsior" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Arquitectura Frontend 2. Cómo implementar Clean Architecture en el Frontend.</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Arquitectura Frontend 2. Cómo implementar Clean Architecture en el Frontend.</h1><div class="post-meta text-muted"> <span> Publicado <em class="" data-ts="1697002727" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2023-10-11 </em> </span><div class="d-flex justify-content-between"> <span> Por <em> Benjamin </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3959 palabras"> <em>21 min</em> de lectura</span></div></div></div><div class="post-content"><p><img data-src="https://i.ibb.co/LCChSkp/Screenshot-2023-10-12-at-11-54-36.png" alt="img" data-proofer-ignore></p><p>La aplicación de los principios de la arquitectura limpia (Clean Architecture) no se limita al ámbito del backend; de hecho, pueden ser igualmente beneficiosos cuando se aplican al frontend, ofreciendo una serie de ventajas sustanciales:</p><ul><li><p><code class="language-plaintext highlighter-rouge">Separación de Lógica de Negocio y Interfaz de Usuario:</code> Al implementar la Clean Architecture en el frontend, podemos lograr la separación efectiva de la lógica empresarial compleja de la interfaz de usuario. Esta clara división permite una gestión más efectiva de ambos componentes, simplificando el mantenimiento y la escalabilidad.</p><li><p><code class="language-plaintext highlighter-rouge">Independencia Tecnológica:</code> La arquitectura limpia garantiza que el código de negocio no dependa de tecnologías específicas de interfaz de usuario, frameworks o bibliotecas. Esta independencia facilita la adaptación a nuevas tecnologías o la actualización de las existentes sin afectar la lógica central del negocio.</p><li><p><code class="language-plaintext highlighter-rouge">Pruebas Unitarias sobre la Lógica Central:</code> La estructura de Clean Architecture permite realizar pruebas unitarias de manera eficiente en la lógica central de la aplicación, asegurando su funcionamiento correcto y confiable. Esto reduce los errores y mejora la calidad del software.</p><li><p><code class="language-plaintext highlighter-rouge">Resistencia a Cambios Disruptivos en las Interfaces de Usuario:</code> La arquitectura limpia minimiza el impacto de cambios drásticos en las interfaces de usuario, como actualizaciones de librerías o frameworks, en la lógica de negocio. Esto resulta en una mayor estabilidad y reducción de riesgos.</p><li><p><code class="language-plaintext highlighter-rouge">Simplificación de Migraciones de Código:</code> La estructura ordenada y modular de la Clean Architecture facilita las migraciones de código, ya sea a nuevas tecnologías, plataformas o arquitecturas. Esto es especialmente valioso a medida que la aplicación crece y evoluciona.</p></ul><p>Clean Architecture, particularmente en aplicaciones complejas, es una estrategia poderosa. Aquí, exploraremos un ejemplo concreto en el contexto de React, la cual es una potente librería para crear UI. Sin embargo, en mi experiencia personal, es muy propensa a convertirse en código espagueti. Si bien siempre podremos separar las funciones de negocio de las de UI, hay casos donde las lógicas asíncronas ligadas a nuestra lógica de negocio no nos permitirán separarnos totalmente de los Hooks de React.</p><h2 id="no-abusaremos-de-useeffect-usestate-y-usecontext-en-el-código-principal-de-negocio"><span class="mr-2">No abusaremos de useEffect, useState y useContext en el código principal de negocio.</span><a href="#no-abusaremos-de-useeffect-usestate-y-usecontext-en-el-código-principal-de-negocio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>¡Nos volvimos locos!. Trataremos de usar React solo en la parte de componentes visuales, y nos ayudaremos del paradigma de programación reactiva con RxJs. Comunicaremos la capa de negocio con la UI con 2 custom hooks: <code class="language-plaintext highlighter-rouge">useObservable()</code> y <code class="language-plaintext highlighter-rouge">useObservableValue()</code>. Estos son los intermediarios de nuestra lógica. Con este enfoque, nuestros componentes podrán suscribirse al estado de nuestra lógica de negocio de forma sencilla y limpia al componente.</p><h3 id="creando-el-custom-hook-useobservable"><span class="mr-2">Creando el custom hook <code class="language-plaintext highlighter-rouge">useObservable()</code></span><a href="#creando-el-custom-hook-useobservable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Este hook nos permite usar la subscripción hacia un observable y también terminará las subscripciones sin que nos preocupemos nosotros.</p><div class="language-tsx highlighter-rouge"><div class="code-header"> <span data-label-text="Tsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span><span class="p">,</span> <span class="nx">Observer</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">rxjs</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">useObservable</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">observable$</span><span class="p">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">Observer</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;&gt;</span> <span class="o">|</span> <span class="p">((</span><span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">))</span> <span class="p">{</span>
    
    <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">subscription</span> <span class="o">=</span> <span class="nx">observable$</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">subscription</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">()</span>
    <span class="p">},[])</span>    

<span class="p">}</span>
</pre></table></code></div></div><h3 id="escuchando-estados-globales-o-locales-con-useobservablevalue"><span class="mr-2">Escuchando estados globales o locales con <code class="language-plaintext highlighter-rouge">useObservableValue()</code>.</span><a href="#escuchando-estados-globales-o-locales-con-useobservablevalue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Este otro hook simulará a <code class="language-plaintext highlighter-rouge">useState()</code> y nos permitirá usar cualquier observable como estado de un componente.</p><div class="language-tsx highlighter-rouge"><div class="code-header"> <span data-label-text="Tsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">useEffect</span><span class="p">,</span> <span class="nx">useState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">rxjs</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">type</span> <span class="nx">ObservableValue</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
    <span class="nx">error</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span>
    <span class="nx">isCompleted</span><span class="p">:</span> <span class="nx">boolean</span>
<span class="p">]</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">useObservableValue</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">observable$</span><span class="p">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">defaultValue</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">ObservableValue</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="kd">const</span> <span class="p">[</span><span class="nx">value</span><span class="p">,</span> <span class="nx">setValue</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">defaultValue</span><span class="p">)</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">error</span><span class="p">,</span> <span class="nx">setError</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="kc">false</span> <span class="o">|</span> <span class="nb">Error</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">isCompleted</span><span class="p">,</span> <span class="nx">setIsCompleted</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
    
    <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">subscription</span> <span class="o">=</span> <span class="nx">observable$</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">({</span>
            <span class="na">next</span><span class="p">:</span> <span class="p">(</span><span class="na">nextValue</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">setValue</span><span class="p">(</span><span class="nx">nextValue</span><span class="p">),</span>
            <span class="na">error</span><span class="p">:</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">useObservableValueError</span><span class="dl">"</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
                <span class="nx">setError</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="na">complete</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">setIsCompleted</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">subscription</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">()</span>
    <span class="p">},[])</span>    

    <span class="k">return</span> <span class="p">[</span>
        <span class="nx">value</span><span class="p">,</span> 
        <span class="nx">error</span><span class="p">,</span>
        <span class="nx">isCompleted</span>
    <span class="p">]</span>

<span class="p">}</span>
</pre></table></code></div></div><p>Explico estos hooks de mejor manera en este post <a href="https://nullpointer-excelsior.github.io/posts/arquitectura-frontend-1-como-integrar-rxjs-4-react-para-aplicaciones-asincronas-complejas/">arquitectura front 1</a> si bien por debajo aquí usamos useState y useEffect, solo serán aquí, ya nos olvidamos de estos hooks para las lógicas de negocio.</p><h2 id="prueba-de-concepto-juego-interactivo-con-un-laberinto-el-clásico-ratón-atrapado-y-el-ingrediente-x"><span class="mr-2">Prueba de concepto: Juego interactivo con un laberinto, el clásico ratón atrapado y el ingrediente X.</span><a href="#prueba-de-concepto-juego-interactivo-con-un-laberinto-el-clásico-ratón-atrapado-y-el-ingrediente-x" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Nuestra aplicación será un juego donde podemos generar un laberinto aleatorio y la misión del jugador será ayudar a un ratoncito a salir del laberinto. Es un juego clásico pero que tendrá un ingrediente especial. Para sacar al ratoncito debemos hacerlo con código, ya sea con código TypeScript o JavaScript.</p><p>Nuestra aplicación ahora suena compleja por los siguientes motivos:</p><ul><li>Generación del laberinto aleatorio.<li>Control del ratoncito y definición de restricciones de negocio del juego.<li>Transpilar TypeScript a JavaScript.<li>Interpretar y controlar la ejecución de código JavaScript.<li>Creación de sandbox de ejecución.<li>Integración con editor de código.<li>Medir puntajes del jugador.<li>Código asíncrono por todos lados.</ul><p>En pocas palabras, esto resume la complejidad del proyecto. Inicialmente, se sitúa en un nivel de complejidad moderado, pero debemos estar preparados para garantizar que el código sea sostenible y adaptable a medida que el proyecto crezca en el futuro.</p><h2 id="estructura-de-directorios"><span class="mr-2">Estructura de directorios</span><a href="#estructura-de-directorios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La estructura de directorio diferirá de la que puede ser hecha en un backend. Si quieres saber cómo es, puedes ver este artículo: <a href="https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part1/">arquitectura hexagonal</a>. En el frontend tendremos otras prioridades en cuanto a los componentes de software de nuestra aplicación. Serán los siguientes:</p><ul><li><code class="language-plaintext highlighter-rouge">application</code>:<ul><li>casos de uso<li>puertos:<ul><li>Browser api<li>utilidades varias</ul></ul><li><code class="language-plaintext highlighter-rouge">domain</code>:<ul><li>puertos:<ul><li>apis<li>serverless sdks</ul><li>modelo<li>estado</ul><li><code class="language-plaintext highlighter-rouge">infrastructure</code>:<ul><li>adapters: implementaciones de puertos cuando corresponda<li>UI: componentes visuales, libs, frameworks, etc.<li>librerías de terceros</ul></ul><p>Si comparamos el frontend con el backend, el dominio del backend contendrá entidades y repositorios, pero en el frontend tendríamos los modelos de datos representados del backend y, en vez de la existencia de repositorios, tendremos el manejador de estados.</p><h2 id="micromouse-feature"><span class="mr-2">MicroMouse Feature</span><a href="#micromouse-feature" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>No explicaremos la totalidad de las funcionalidades del proyecto, ya que alargaríamos mucho este artículo. Si deseas, puedes verlo y estudiarlo en el siguiente <a href="https://github.com/nullpointer-excelsior/micromouse-challenger">repositorio</a>. Me enfocaré en explicar la funcionalidad de Micromouse, la cual lleva la lógica principal del juego.</p><p>La estructura del módulo <code class="language-plaintext highlighter-rouge">micromouse</code> es la siguiente:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre> micromouse
├──  application
│   ├──  MicroMouse.ts
│   └──  MicromouseGame.ts
├──  domain
│   ├──  Cell.ts
│   ├──  CellPosition.ts
│   ├──  Events.ts
│   ├──  Mouse.ts
│   ├──  MouseMaze.ts
│   ├──  MoveMouseResponse.ts
│   └──  state
│       └──  MicromouseState.ts
├──  dto.ts
├──  exceptions.ts
└──  infrastructure
    ├──  services.ts
    └──  ui
        └──  components
            ├──  maze
            │   ├──  CellContent.tsx
            │   └──  Maze.tsx
            └──  start-code-challenge-button
                └──  StartCodeChallengeButton.tsx
</pre></table></code></div></div><p>Esta estructura contiene lo siguiente:</p><ul><li><code class="language-plaintext highlighter-rouge">application</code>: casos de uso de la aplicación<li><code class="language-plaintext highlighter-rouge">domain</code>:<ul><li>estructura del estado del módulo<li>lógica de negocio principal</ul><li><code class="language-plaintext highlighter-rouge">infraestructure</code>:<ul><li>componentes UI<li>instancia de servicios de uso global</ul></ul><h3 id="micromousegame-casos-de-uso-del-juego-del-laberinto"><span class="mr-2">MicroMouseGame: casos de uso del juego del laberinto</span><a href="#micromousegame-casos-de-uso-del-juego-del-laberinto" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Este componente se encarga de controlar el estado del juego. También actualizará el estado global del módulo.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">type</span> <span class="nx">MicromouseGameOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">stopwatch</span><span class="p">:</span> <span class="nx">Stopwatch</span><span class="p">,</span>
    <span class="na">gameTime</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="kr">number</span><span class="p">}</span><span class="s2">:</span><span class="p">${</span><span class="kr">number</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">MicromouseState</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MicromouseGame</span> <span class="p">{</span>

    <span class="k">private</span> <span class="nx">stopwatch</span><span class="p">:</span> <span class="nx">Stopwatch</span>
    <span class="k">private</span> <span class="nx">gameTime</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="kr">number</span><span class="p">}</span><span class="s2">:</span><span class="p">${</span><span class="kr">number</span><span class="p">}</span><span class="s2">`</span>
    <span class="k">private</span> <span class="nx">state$</span><span class="p">:</span> <span class="nx">MicromouseState</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="nx">options</span><span class="p">:</span> <span class="nx">MicromouseGameOptions</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">stopwatch</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">gameTime</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">gameTime</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state$</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">state</span>
    <span class="p">}</span>

    <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stopGameAt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gameTime</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">finish</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span><span class="p">.</span><span class="nx">stop</span><span class="p">()</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">resetMousePosition</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">reset</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span><span class="p">.</span><span class="nx">stop</span><span class="p">()</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">reset</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">time</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span><span class="p">.</span><span class="nx">time</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">stopGameAt</span><span class="p">(</span><span class="nx">time</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="kr">number</span><span class="p">}</span><span class="s2">:</span><span class="p">${</span><span class="kr">number</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span>
            <span class="p">.</span><span class="nx">time</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">filter</span><span class="p">(</span><span class="nx">timeValue</span> <span class="o">=&gt;</span> <span class="nx">timeValue</span> <span class="o">===</span> <span class="s2">`</span><span class="p">${</span><span class="nx">time</span><span class="p">}</span><span class="s2">:00`</span><span class="p">))</span>
            <span class="p">.</span><span class="nx">subscribe</span><span class="p">((</span><span class="nx">time</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span><span class="p">.</span><span class="nx">stop</span><span class="p">()</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">updatePlayerResult</span><span class="p">({</span>
                    <span class="na">time</span><span class="p">:</span> <span class="nx">time</span><span class="p">,</span>
                    <span class="na">isWinner</span><span class="p">:</span> <span class="kc">false</span>
                <span class="p">})</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">resetMousePosition</span><span class="p">()</span>
            <span class="p">})</span>

    <span class="p">}</span>

    <span class="nx">onGameOver</span><span class="p">(</span><span class="nx">callback</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span><span class="p">.</span><span class="nx">onStop</span><span class="p">().</span><span class="nx">subscribe</span><span class="p">({</span>
            <span class="na">next</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">callback</span><span class="p">()</span>
            <span class="p">},</span>
            <span class="na">error</span><span class="p">:</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">gameOver</span><span class="p">():</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">GameOverResponse</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">stopwatch</span><span class="p">.</span><span class="nx">onStop</span><span class="p">().</span><span class="nx">pipe</span><span class="p">(</span>
            <span class="nx">map</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">({</span>
                <span class="na">isWinner</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">getIsWinner</span><span class="p">()</span>
            <span class="p">}))</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">updateScore</span><span class="p">(</span><span class="nx">params</span><span class="p">:</span> <span class="p">{</span> <span class="nl">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">position</span><span class="p">:</span> <span class="kr">string</span> <span class="p">})</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">updateMousePosition</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">position</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">updateMessage</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">incrementMovements</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">movements</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">onMovement</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">setup</span><span class="p">(</span><span class="nx">code</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">setCode</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">getSetup</span><span class="p">():</span> <span class="nx">SetupGame</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="na">code</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">getCode</span><span class="p">(),</span>
            <span class="na">matrix</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">getMaze</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">win</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state$</span><span class="p">.</span><span class="nx">setIsWinner</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">finish</span><span class="p">()</span>
    <span class="p">}</span>

<span class="p">}</span>

</pre></table></code></div></div><h3 id="micromouse-casos-de-uso-de-control-del-ratoncito-dentro-del-laberinto"><span class="mr-2">MicroMouse: casos de uso de control del ratoncito dentro del laberinto</span><a href="#micromouse-casos-de-uso-de-control-del-ratoncito-dentro-del-laberinto" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Este servicio se encargará de enviar las instrucciones al ratoncito del laberinto para moverse y se encargará de enviar eventos de dominio de forma global. También servirá de fachada del estado de la clase <code class="language-plaintext highlighter-rouge">Mouse</code> (ratoncito), la cual tiene la responsabilidad de conocer el laberinto y poder realizar los movimientos cuando corresponda.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">EventBus</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../../utils/eventbus</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">eventbus</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../../utils/infrastructure</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Cell</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../domain/Cell</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MicromouseEvent</span><span class="p">,</span> <span class="nx">MouseMoveEvent</span><span class="p">,</span> <span class="nx">MouseWinEvent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../domain/Events</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Mouse</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../domain/Mouse</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MouseMaze</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../domain/MouseMaze</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MoveMouseResponse</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../domain/MoveMouseResponse</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MicroMouse</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="nx">eventbus</span><span class="p">:</span> <span class="nx">EventBus</span><span class="o">&lt;</span><span class="nx">MicromouseEvent</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="nx">mouse</span><span class="p">:</span> <span class="nx">Mouse</span><span class="p">,</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="nx">moveDelay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="k">async</span> <span class="nx">move</span><span class="p">(</span><span class="nx">position</span><span class="p">:</span> <span class="dl">'</span><span class="s1">up</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">down</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">left</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">right</span><span class="dl">'</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">MoveMouseResponse</span><span class="o">&gt;</span> <span class="p">{</span>

        <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">moveDelay</span><span class="p">));</span>

        <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">move</span><span class="p">(</span><span class="nx">position</span><span class="p">)</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">eventbus</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="k">new</span> <span class="nx">MouseMoveEvent</span><span class="p">({</span>
            <span class="na">isMoved</span><span class="p">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">mouseMoved</span><span class="p">,</span>
            <span class="na">message</span><span class="p">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
            <span class="na">position</span><span class="p">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">cellPosition</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">()</span>
        <span class="p">}))</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">mouseMoved</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">cellPosition</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">isExit</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">eventbus</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="k">new</span> <span class="nx">MouseWinEvent</span><span class="p">(</span><span class="dl">"</span><span class="s2">Felicitaciones ganaste maldito bastardo!!</span><span class="dl">"</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">response</span>

    <span class="p">}</span>

    <span class="k">static</span> <span class="nx">create</span><span class="p">(</span><span class="nx">params</span><span class="p">:</span> <span class="p">{</span> <span class="nl">matrix</span><span class="p">:</span> <span class="kr">string</span><span class="p">[][],</span> <span class="nx">moveDelay</span><span class="p">:</span> <span class="kr">number</span> <span class="p">})</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">maze</span> <span class="o">=</span> <span class="nx">MouseMaze</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
            <span class="na">matrix</span><span class="p">:</span> <span class="nx">params</span><span class="p">.</span><span class="nx">matrix</span>
        <span class="p">})</span>
        <span class="kd">const</span> <span class="nx">mouse</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mouse</span><span class="p">(</span><span class="nx">maze</span><span class="p">,</span> <span class="nx">maze</span><span class="p">.</span><span class="nx">getPosition</span><span class="p">(</span><span class="dl">'</span><span class="s1">A0</span><span class="dl">'</span><span class="p">))</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MicroMouse</span><span class="p">(</span>
            <span class="nx">eventbus</span><span class="p">,</span>
            <span class="nx">mouse</span><span class="p">,</span>
            <span class="nx">params</span><span class="p">.</span><span class="nx">moveDelay</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">getCurrentPosition</span><span class="p">():</span> <span class="kr">string</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">getCurrentCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">getCurrentCell</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">getUpCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">getUpCell</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nx">getDownCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">getDownCell</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">getLeftCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">getLeftCell</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">getRightCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">getRightCell</span><span class="p">()</span>
    <span class="p">}</span>

<span class="p">}</span>

</pre></table></code></div></div><h3 id="mouse-y-maze-objetos-de-dominio-que-contienen-la-lógica-principal-del-juego"><span class="mr-2">Mouse y Maze: objetos de dominio que contienen la lógica principal del juego.</span><a href="#mouse-y-maze-objetos-de-dominio-que-contienen-la-lógica-principal-del-juego" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Estos 2 componentes de dominio contienen la lógica principal del juego. <code class="language-plaintext highlighter-rouge">Mouse</code> tendrá la información de ubicación y de cómo moverse por el laberinto, y <code class="language-plaintext highlighter-rouge">MouseMaze</code> tendrá la lógica del laberinto y su estructura.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">Cell</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./Cell</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">CellPosition</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./CellPosition</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MouseMaze</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./MouseMaze</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MoveMouseResponse</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./MoveMouseResponse</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Mouse</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="nx">maze</span><span class="p">:</span> <span class="nx">MouseMaze</span><span class="p">,</span>
        <span class="k">private</span> <span class="nx">currentPosition</span><span class="p">:</span> <span class="nx">CellPosition</span>
    <span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="nx">move</span><span class="p">(</span><span class="nx">position</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">MoveMouseResponse</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">navigateTo</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">.</span><span class="nx">getCell</span><span class="p">(</span><span class="nx">position</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigateTo</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">MoveMouseResponse</span><span class="p">(</span>
                <span class="dl">'</span><span class="s1">⚠️  Raton culiao No puedes moverte fuera de tu universo 🪐</span><span class="dl">'</span><span class="p">,</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">,</span>
                <span class="kc">false</span>
            <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigateTo</span><span class="p">.</span><span class="nx">canWalk</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">MoveMouseResponse</span><span class="p">(</span>
                <span class="dl">'</span><span class="s1">✋ 🐁 no puedes ir por aca raton culiao.</span><span class="dl">'</span><span class="p">,</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">,</span>
                <span class="kc">false</span>
            <span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">const</span> <span class="nx">cellPosition</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">.</span><span class="nx">getPosition</span><span class="p">(</span><span class="nx">navigateTo</span><span class="p">.</span><span class="nx">position</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span> <span class="o">=</span> <span class="nx">cellPosition</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nx">MoveMouseResponse</span><span class="p">(</span>
            <span class="s2">`Me he movido 🐁 -&gt; (</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">()}</span><span class="s2">)`</span><span class="p">,</span>
            <span class="nx">cellPosition</span><span class="p">,</span>
            <span class="kc">true</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">getCurrentPosition</span><span class="p">():</span> <span class="kr">string</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nx">getCurrentCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">getUpCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">.</span><span class="nx">up</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">getDownCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">.</span><span class="nx">down</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">getLeftCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">getRightCell</span><span class="p">():</span> <span class="nx">Cell</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentPosition</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MouseMaze</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="k">public</span> <span class="k">readonly</span> <span class="nx">maze</span><span class="p">:</span> <span class="nx">Cell</span><span class="p">[][])</span> <span class="p">{</span> <span class="p">}</span>

    <span class="k">private</span> <span class="nx">findIndexes</span><span class="p">(</span><span class="nx">valor</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="p">[</span><span class="kr">number</span><span class="p">,</span> <span class="kr">number</span><span class="p">]</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">].</span><span class="nx">position</span> <span class="o">===</span> <span class="nx">valor</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="p">[</span><span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">getPosition</span><span class="p">(</span><span class="nx">position</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">CellPosition</span> <span class="o">|</span> <span class="kc">null</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">loc</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">findIndexes</span><span class="p">(</span><span class="nx">position</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">loc</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">showPositionMaze</span><span class="p">(</span><span class="nx">loc</span><span class="p">)</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">showPositionMaze</span><span class="p">(</span><span class="nx">loc</span><span class="p">:</span> <span class="p">[</span><span class="kr">number</span><span class="p">,</span> <span class="kr">number</span><span class="p">]):</span> <span class="nx">CellPosition</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">maze</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">row</span> <span class="o">=</span> <span class="nx">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="kd">const</span> <span class="nx">col</span> <span class="o">=</span> <span class="nx">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">row</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">col</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">InvalidMazeLocationException</span><span class="p">(</span><span class="dl">'</span><span class="s1">No se admiten coordenadas negativas</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">row</span> <span class="o">&gt;=</span> <span class="nx">maze</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">InvalidMazeLocationException</span><span class="p">(</span><span class="dl">'</span><span class="s1">No se admiten coordenadas fuera de rango</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">col</span> <span class="o">&gt;=</span> <span class="nx">maze</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">InvalidMazeLocationException</span><span class="p">(</span><span class="dl">'</span><span class="s1">No se admiten coordenadas fuera de rango</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">const</span> <span class="nx">currentLocation</span> <span class="o">=</span> <span class="nx">maze</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">];</span>

        <span class="kd">const</span> <span class="nx">up</span> <span class="o">=</span> <span class="nx">row</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="nx">maze</span><span class="p">[</span><span class="nx">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">down</span> <span class="o">=</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="nx">maze</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">?</span> <span class="nx">maze</span><span class="p">[</span><span class="nx">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">col</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="nx">maze</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">right</span> <span class="o">=</span> <span class="nx">col</span> <span class="o">&lt;</span> <span class="nx">maze</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">?</span> <span class="nx">maze</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nx">CellPosition</span><span class="p">(</span>
            <span class="nx">currentLocation</span><span class="p">,</span>
            <span class="nx">up</span><span class="p">,</span>
            <span class="nx">down</span><span class="p">,</span>
            <span class="nx">left</span><span class="p">,</span>
            <span class="nx">right</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="nx">create</span><span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">MouseMazeProps</span><span class="p">):</span> <span class="nx">MouseMaze</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="p">{</span><span class="nx">matrix</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span>
        <span class="kd">const</span> <span class="nx">matrixCells</span><span class="p">:</span> <span class="nx">Cell</span><span class="p">[][]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">matrix</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">row</span><span class="p">:</span> <span class="nx">Cell</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">position</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="dl">'</span><span class="s1">A</span><span class="dl">'</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">String</span><span class="p">(</span><span class="nx">j</span><span class="p">);</span>
                <span class="kd">const</span> <span class="nx">cell</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cell</span><span class="p">(</span><span class="nx">position</span><span class="p">,</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
                <span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">cell</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">matrixCells</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MouseMaze</span><span class="p">(</span><span class="nx">matrixCells</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="nx">mapMatrixToCells</span><span class="p">(</span><span class="nx">matrix</span><span class="p">:</span> <span class="kr">string</span><span class="p">[][]):</span> <span class="nx">Cell</span><span class="p">[][]</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">matrixCells</span><span class="p">:</span> <span class="nx">Cell</span><span class="p">[][]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">matrix</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">row</span><span class="p">:</span> <span class="nx">Cell</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">position</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="dl">'</span><span class="s1">A</span><span class="dl">'</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">String</span><span class="p">(</span><span class="nx">j</span><span class="p">);</span>
                <span class="kd">const</span> <span class="nx">cell</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cell</span><span class="p">(</span><span class="nx">position</span><span class="p">,</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
                <span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">cell</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">matrixCells</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">matrixCells</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><h3 id="eventos-de-dominio"><span class="mr-2">Eventos de dominio</span><a href="#eventos-de-dominio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Nuestro dominio contiene eventos definidos, los cuales podremos escuchar de forma global para saber qué está ocurriendo en el juego. Esto es de utilidad para desacoplar distintas lógicas o módulos de la aplicación. Por ejemplo, no queremos mezclar la lógica de puntajes con la lógica de movimientos o de tiempo. Los eventos de dominio nos son de gran utilidad en arquitecturas limpias.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">DomainEvent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../../utils/eventbus</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">MicromouseEvent</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">micromouse.mouse-move</span><span class="dl">"</span> <span class="o">|</span> <span class="dl">"</span><span class="s2">micromouse.mouse-win</span><span class="dl">"</span> <span class="o">|</span> <span class="dl">"</span><span class="s2">micromouse.mouse-timeout</span><span class="dl">"</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">MouseEventProps</span> <span class="p">{</span>
    <span class="nl">isMoved</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
    <span class="nl">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MouseMoveEvent</span> <span class="kd">extends</span> <span class="nx">DomainEvent</span><span class="o">&lt;</span><span class="nx">MouseEventProps</span><span class="p">,</span> <span class="nx">MicromouseEvent</span><span class="o">&gt;</span><span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="nx">MicromouseEvent</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">micromouse.mouse-move</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MouseWinEvent</span> <span class="kd">extends</span> <span class="nx">DomainEvent</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span> <span class="nx">MicromouseEvent</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="nx">MicromouseEvent</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">micromouse.mouse-win</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MouseTimeoutEvent</span> <span class="kd">extends</span> <span class="nx">DomainEvent</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span> <span class="nx">MicromouseEvent</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="nx">MicromouseEvent</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">micromouse.mouse-timeout</span><span class="dl">"</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Estos eventos son orquestados por un eventbus, una clase implementada con Rxjs. Si quieres saber más sobre este enfoque, te invito al siguiente artículo: <a href="https://nullpointer-excelsior.github.io/posts/como-implementar-un-eventbus-y-rxjs-en-conjunto/">Arquitectura orientadas a eventos</a></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nx">ReactiveEventBus</span><span class="o">&lt;</span><span class="nx">E</span> <span class="kd">extends</span> <span class="kr">string</span><span class="o">&gt;</span> <span class="k">implements</span> <span class="nx">EventBus</span><span class="o">&lt;</span><span class="nx">E</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="k">private</span> <span class="nx">events$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Subject</span><span class="o">&lt;</span><span class="nx">DomainEvent</span><span class="o">&lt;</span><span class="kr">any</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;&gt;</span><span class="p">()</span>

    <span class="nx">onEvent</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="nx">DomainEvent</span><span class="o">&lt;</span><span class="kr">any</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="nx">eventName</span><span class="p">?:</span> <span class="nx">E</span><span class="p">):</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">iif</span><span class="p">(</span>
            <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">eventName</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">,</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">events$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">filter</span><span class="p">(</span><span class="nx">event</span> <span class="o">=&gt;</span> <span class="nx">eventName</span> <span class="o">===</span> <span class="nx">event</span><span class="p">.</span><span class="nx">name</span><span class="p">)),</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">events$</span><span class="p">.</span><span class="nx">asObservable</span><span class="p">()</span>
        <span class="p">)</span> <span class="k">as</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">dispatch</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="nx">DomainEvent</span><span class="o">&lt;</span><span class="kr">any</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="na">event</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">events$</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">eventbus</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReactiveEventBus</span><span class="o">&lt;</span><span class="nx">MicromouseEvent</span><span class="o">&gt;</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="statemanager-sin-las-ultraconocidas-librerías"><span class="mr-2">StateManager sin las ultraconocidas librerías.</span><a href="#statemanager-sin-las-ultraconocidas-librerías" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Nuestro estado global del módulo es manejado con RxJs. Podríamos haber empleado alguna otra alternativa con más características y definir puertos y adaptadores para no acoplarnos a una librería de terceros, pero RxJs nos da la posibilidad de crear un state manager de forma sencilla y entender qué realmente debemos considerar al crear un state manager por nosotros mismos.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
</pre><td class="rouge-code"><pre>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">State</span> <span class="p">{</span>
    <span class="nl">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">mousePosition</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">maze</span><span class="p">:</span> <span class="kr">string</span><span class="p">[][];</span>
    <span class="nl">time</span><span class="p">:</span> <span class="kr">string</span>
    <span class="nx">movements</span><span class="p">:</span> <span class="kr">number</span>
    <span class="nx">isWinner</span><span class="p">:</span> <span class="nx">boolean</span>
    <span class="nx">code</span><span class="p">:</span> <span class="kr">string</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MicromouseState</span> <span class="p">{</span>

    <span class="k">private</span> <span class="nx">defaultState</span><span class="p">:</span> <span class="nx">State</span> 
    <span class="k">private</span> <span class="nx">message</span><span class="p">:</span> <span class="nx">BehaviorSubject</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span>
    <span class="k">private</span> <span class="nx">maze</span><span class="p">:</span> <span class="nx">BehaviorSubject</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">[][]</span><span class="o">&gt;</span>
    <span class="k">private</span> <span class="nx">mousePosition</span><span class="p">:</span> <span class="nx">BehaviorSubject</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span>
    <span class="k">private</span> <span class="nx">time</span><span class="p">:</span> <span class="nx">BehaviorSubject</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span>
    <span class="k">private</span> <span class="nx">movements</span><span class="p">:</span> <span class="nx">BehaviorSubject</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span>
    <span class="k">private</span> <span class="nx">isWinner</span><span class="p">:</span> <span class="nx">BehaviorSubject</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span>
    <span class="k">private</span> <span class="nx">code</span><span class="p">:</span> <span class="nx">BehaviorSubject</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">defaultState</span> <span class="o">=</span> <span class="nx">props</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">maze</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BehaviorSubject</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">maze</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BehaviorSubject</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">mousePosition</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BehaviorSubject</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">mousePosition</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BehaviorSubject</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">time</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">movements</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BehaviorSubject</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">movements</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">isWinner</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BehaviorSubject</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">isWinner</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">code</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BehaviorSubject</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">code</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">setMaze</span><span class="p">(</span><span class="nx">maze</span><span class="p">:</span> <span class="kr">string</span><span class="p">[][])</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">maze</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">updateMousePosition</span><span class="p">(</span><span class="nx">position</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">mousePosition</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">position</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">updateMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">onMessage</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">distinctUntilChanged</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="nx">onMaze</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">distinctUntilChanged</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="nx">getMaze</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">}</span>

    <span class="nx">onMousePosition</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mousePosition</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">distinctUntilChanged</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="nx">reset</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">maze</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">defaultState</span><span class="p">.</span><span class="nx">maze</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">defaultState</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">mousePosition</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">defaultState</span><span class="p">.</span><span class="nx">mousePosition</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">resetMousePosition</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">mousePosition</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">defaultState</span><span class="p">.</span><span class="nx">mousePosition</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">movements</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">updatePlayerResult</span><span class="p">(</span><span class="nx">payload</span><span class="p">:</span> <span class="p">{</span> <span class="nl">time</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">isWinner</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">}){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">payload</span><span class="p">.</span><span class="nx">time</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">isWinner</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">payload</span><span class="p">.</span><span class="nx">isWinner</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">getIsWinner</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">isWinner</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">}</span>

    <span class="nx">setIsWinner</span><span class="p">(</span><span class="nx">payload</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">isWinner</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">incrementMovements</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">movements</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">movements</span><span class="p">.</span><span class="nx">value</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">onMovement</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">movements</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">distinctUntilChanged</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="nx">setCode</span><span class="p">(</span><span class="nx">payload</span><span class="p">:</span> <span class="kr">string</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">code</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">getCode</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">code</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><p>Cabe destacar el siguiente código:</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">onMousePosition</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mousePosition</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">distinctUntilChanged</span><span class="p">())</span>
<span class="p">}</span>
</pre></table></code></div></div><p>El operador <code class="language-plaintext highlighter-rouge">distinctUntilChanged()</code> nos permitirá que quienes escuchen el estado de <code class="language-plaintext highlighter-rouge">MicromouseState</code> no reciban actualizaciones innecesarias, lo cual evitaría un problema de renderizados innecesarios. RxJs nos permitirá realizar operaciones más complejas con el estado si es necesario, pero con esta implementación nos basta.</p><h3 id="instancia-de-servicios"><span class="mr-2">Instancia de servicios</span><a href="#instancia-de-servicios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ciertos componentes deben estar en un scope global, por lo que lo único que debemos hacer es instanciarlos en un único lugar, en este caso en el archivo <code class="language-plaintext highlighter-rouge">src/micromouse_challenger/micromouse/infraestructure/services.ts</code>.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>
<span class="kd">const</span> <span class="nx">configuration</span> <span class="o">=</span> <span class="nx">getGameConfiguration</span><span class="p">()</span>


<span class="k">export</span> <span class="kd">const</span> <span class="nx">micromouseState</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MicromouseState</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Micromouse challenger iniciando 🏆 &lt;- 🐁</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">mousePosition</span><span class="p">:</span> <span class="dl">'</span><span class="s1">A0</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">maze</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">],</span>
        <span class="p">[</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">],</span>
        <span class="p">[</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">],</span>
        <span class="p">[</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">],</span>
        <span class="p">[</span><span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">S</span><span class="dl">'</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="na">isWinner</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">movements</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">time</span><span class="p">:</span> <span class="dl">"</span><span class="s2">00:00:00</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">code</span><span class="p">:</span> <span class="dl">"</span><span class="s2">// you must to code a solution for Micromouse Challenge</span><span class="dl">"</span><span class="p">,</span>
<span class="p">})</span>


<span class="k">export</span> <span class="kd">const</span> <span class="nx">micromouseGame</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MicromouseGame</span><span class="p">({</span>
    <span class="na">stopwatch</span><span class="p">:</span> <span class="k">new</span> <span class="nx">Stopwatch</span><span class="p">(),</span>
    <span class="na">gameTime</span><span class="p">:</span> <span class="nx">configuration</span><span class="p">.</span><span class="nx">gameTimeout</span><span class="p">,</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">micromouseState</span>
<span class="p">})</span>

</pre></table></code></div></div><blockquote><p>Si necesitáramos una instancia a nivel de componentes podemos hacer uso del hook useRef() de React.</p></blockquote><h2 id="conectando-la-ui-con-nuestra-aplicación"><span class="mr-2">Conectando la UI con nuestra aplicación</span><a href="#conectando-la-ui-con-nuestra-aplicación" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Para hacer uso del estado de nuestra aplicación, solo debemos hacer uso de nuestros hooks previamente definidos:</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">[</span><span class="nx">time</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useObservableValue</span><span class="p">(</span><span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">time</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">00:00:00</span><span class="dl">"</span><span class="p">)</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">movements</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useObservableValue</span><span class="p">(</span><span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">movements</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">gameOver</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useObservableValue</span><span class="p">(</span><span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">gameOver</span><span class="p">(),</span> <span class="p">{</span> <span class="na">isWinner</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>
</pre></table></code></div></div><p>De esta manera, las variables <code class="language-plaintext highlighter-rouge">time</code>, <code class="language-plaintext highlighter-rouge">movements</code> y <code class="language-plaintext highlighter-rouge">gameOver</code> actuarán como estado global, y React renderizará los componentes cuando cualquiera de esos cambie.</p><p>Mostraré como ejemplo el componente <code class="language-plaintext highlighter-rouge">&lt;Sanbox/&gt;</code>, el cual debe ejecutar el juego dentro de un <code class="language-plaintext highlighter-rouge">WebWorker</code>. Para lograr esto, utilizamos el caso de uso <code class="language-plaintext highlighter-rouge">executeCodeRunnerWorker</code>, el cual pertenece al módulo <code class="language-plaintext highlighter-rouge">code-runner</code>. Este caso de uso ejecuta el flujo del juego y se comunicará con el <code class="language-plaintext highlighter-rouge">WebWorker</code> que controlará el servicio <code class="language-plaintext highlighter-rouge">Micromouse</code>.</p><h3 id="caso-de-uso-executecoderunnerworker"><span class="mr-2">Caso de uso: executeCodeRunnerWorker</span><a href="#caso-de-uso-executecoderunnerworker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Este caso de uso ejecutará el juego e internamente el código del jugador para poder mover el ratoncito en el laberinto. Todo este proceso debe ser ejecutado en un <code class="language-plaintext highlighter-rouge">WebWorker</code> para evitar interferir en el hilo principal del navegador.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>
<span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">executeCodeRunnerWorker</span><span class="p">(</span><span class="nx">options</span><span class="p">:</span> <span class="nx">ExecuteCodeRunnerWorkerOptions</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">const</span> <span class="nx">worker</span> <span class="o">=</span> <span class="nx">createCodeRunnerWorker</span><span class="p">()</span>

    <span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>

    <span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">onGameOver</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">worker</span><span class="p">.</span><span class="nx">terminate</span><span class="p">()</span>
        <span class="nx">options</span><span class="p">.</span><span class="nx">onGameOver</span><span class="p">()</span>
    <span class="p">})</span>

    <span class="nx">worker</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="k">new</span> <span class="nx">StartMicromouseMessage</span><span class="p">(</span><span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">getSetup</span><span class="p">()))</span>

    <span class="nx">worker</span>
        <span class="p">.</span><span class="nx">onMessage</span><span class="o">&lt;</span><span class="nx">MicromouseMoveMessage</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">"</span><span class="s2">MICROMOUSE_MOVE</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">map</span><span class="p">(</span><span class="nx">event</span> <span class="o">=&gt;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">micromouseEvent</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">subscribe</span><span class="p">({</span>
            <span class="na">next</span><span class="p">:</span> <span class="p">(</span><span class="nx">micromouseEvent</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">updateScore</span><span class="p">({</span>
                    <span class="na">message</span><span class="p">:</span> <span class="nx">micromouseEvent</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
                    <span class="na">position</span><span class="p">:</span> <span class="nx">micromouseEvent</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">position</span>
                <span class="p">})</span>
            <span class="p">},</span>
            <span class="na">error</span><span class="p">:</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="p">})</span>

    <span class="nx">worker</span><span class="p">.</span><span class="nx">onMessage</span><span class="o">&lt;</span><span class="nx">MicromouseMoveMessage</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">"</span><span class="s2">MICROMOUSE_WIN</span><span class="dl">"</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">({</span>
        <span class="na">next</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">win</span><span class="p">()</span>
        <span class="p">},</span>
        <span class="na">error</span><span class="p">:</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="k">return</span> <span class="nx">worker</span>

<span class="p">}</span>
</pre></table></code></div></div><p>Esta función debe retornar un worker, el cual debe ser terminado al desmontar el componente de forma obligatoria. Para lograrlo, podemos hacer uso del clásico <code class="language-plaintext highlighter-rouge">useEffect()</code>.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">worker</span> <span class="o">=</span> <span class="nx">executeCodeRunnerWorker</span><span class="p">({</span> <span class="na">onGameOver</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">setOpen</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">})</span>
    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> 
        <span class="nx">worker</span><span class="p">.</span><span class="nx">terminate</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="p">[])</span>
</pre></table></code></div></div><p>O mandamos a casa al <code class="language-plaintext highlighter-rouge">useEffect()</code> y lo hacemos con Observables de RxJs.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">const</span> <span class="nx">codeRunnerWorker$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Observable</span><span class="p">(</span><span class="nx">observer</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">worker</span> <span class="o">=</span> <span class="nx">executeCodeRunnerWorker</span><span class="p">({</span> <span class="na">onGameOver</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">()</span> <span class="p">})</span>
    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> 
        <span class="nx">worker</span><span class="p">.</span><span class="nx">terminate</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></table></code></div></div><p>Ya creado nuestro observable <code class="language-plaintext highlighter-rouge">codeRunnerWorker$</code>, lo usamos con el hook <code class="language-plaintext highlighter-rouge">useObservable()</code> en nuestros componentes.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">useObservable</span><span class="p">(</span><span class="nx">codeRunnerWorker$</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">GameOver</span><span class="dl">"</span><span class="p">)</span>
<span class="p">})</span>
</pre></table></code></div></div><p>Finalmente, nuestros componentes de UI quedan así:</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre>
<span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">SandBox</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//  libraries and React hooks</span>
    <span class="kd">const</span> <span class="p">[,</span> <span class="nx">navigate</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useLocation</span><span class="p">();</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">open</span><span class="p">,</span> <span class="nx">setOpen</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
    <span class="c1">// game logic </span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">time</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useObservableValue</span><span class="p">(</span><span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">time</span><span class="p">(),</span> <span class="dl">"</span><span class="s2">00:00:00</span><span class="dl">"</span><span class="p">)</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">movements</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useObservableValue</span><span class="p">(</span><span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">movements</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">gameOver</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useObservableValue</span><span class="p">(</span><span class="nx">micromouseGame</span><span class="p">.</span><span class="nx">gameOver</span><span class="p">(),</span> <span class="p">{</span> <span class="na">isWinner</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>
    
    <span class="c1">// we need to execute a worker for code execution</span>
    <span class="nx">useObservable</span><span class="p">(</span><span class="nx">codeRunnerWorker$</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">// game over showing Modal with game results</span>
        <span class="nx">setOpen</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="kd">const</span> <span class="nx">handleAcceptModal</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">setOpen</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
        <span class="nx">navigate</span><span class="p">(</span><span class="nx">Paths</span><span class="p">.</span><span class="nx">MICROMOUSE_CODERUNNER</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">rounded w-[800px] h-[500px] bg-gray-900</span><span class="dl">"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">flex flex-col items-center</span><span class="dl">"</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ScoreDashboard</span> <span class="nx">time</span><span class="o">=</span><span class="p">{</span><span class="nx">time</span><span class="p">}</span> <span class="nx">movements</span><span class="o">=</span><span class="p">{</span><span class="nx">movements</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">Maze</span> <span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">Modal</span> <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">gameOver</span><span class="p">.</span><span class="nx">isWinner</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">Felicitaciones</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">Que penita</span><span class="dl">"</span><span class="p">}</span> <span class="nx">open</span><span class="o">=</span><span class="p">{</span><span class="nx">open</span><span class="p">}</span> <span class="nx">onAccept</span><span class="o">=</span><span class="p">{</span><span class="nx">handleAcceptModal</span><span class="p">}</span> <span class="nx">onClose</span><span class="o">=</span><span class="p">{</span><span class="nx">handleAcceptModal</span><span class="p">}</span><span class="o">&gt;</span>
                    <span class="p">{</span><span class="nx">gameOver</span><span class="p">.</span><span class="nx">isWinner</span> <span class="p">?</span> <span class="o">&lt;</span><span class="nx">WinnerModalContent</span> <span class="nx">movements</span><span class="o">=</span><span class="p">{</span><span class="nx">movements</span><span class="p">}</span> <span class="nx">time</span><span class="o">=</span><span class="p">{</span><span class="nx">time</span><span class="p">}</span> <span class="sr">/&gt; : &lt;GameOverModalContent /</span><span class="o">&gt;</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="sr">/Modal</span><span class="err">&gt;
</span>                <span class="p">{</span><span class="nx">gameOver</span><span class="p">.</span><span class="nx">isWinner</span> <span class="p">?</span> <span class="o">&lt;</span><span class="nx">ConfettiExplosion</span> <span class="nx">zIndex</span><span class="o">=</span><span class="p">{</span><span class="mi">1000</span><span class="p">}</span> <span class="sr">/&gt; : null</span><span class="err">}
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="conclusión">Conclusión</h1><p>Clean architecture en el frontend nos brinda la capacidad de abordar los casos de uso de manera independiente de la interfaz de usuario. En este proyecto, se han logrado los siguientes hitos en el diseño de aplicaciones:</p><ul><li><p><code class="language-plaintext highlighter-rouge">Separación de Lógicas Complejas:</code> Hemos logrado aislar las lógicas de negocio complejas de la interfaz de usuario.</p><li><p><code class="language-plaintext highlighter-rouge">Conexión UI-Core Eficiente:</code> Implementamos una conexión efectiva entre la interfaz de usuario y el núcleo de la aplicación mediante dos sencillos custom hooks.</p><li><p><code class="language-plaintext highlighter-rouge">Programación Reactiva:</code> Utilizamos programación reactiva para permitir que cada componente de la aplicación se comunique de manera desacoplada.</p><li><p><code class="language-plaintext highlighter-rouge">State Manager Eficiente:</code> Creamos un gestor de estado sin recurrir a soluciones más pesadas como React Redux u otras alternativas altamente acopladas a React.</p><li><p><code class="language-plaintext highlighter-rouge">Mantenibilidad y Migración Transparente:</code> Nos hemos asegurado de que la mantenibilidad y migración de características sean lo más fluidas posible.</p></ul><p>Es importante destacar que no se pretende desacreditar el uso de los hooks de React. Cada caso puede requerir soluciones particulares, y React ofrece una amplia variedad de hooks diseñados para abordar escenarios específicos. Este proyecto aún no ha enfrentado todos los posibles desafíos donde React y sus hooks pueden abordar, por lo que es fundamental adaptar la solución a las necesidades específicas de cada contexto.</p><p>Ahora, si quieres probar el desafío y saber de qué se trata <code class="language-plaintext highlighter-rouge">Micromouse Challenger</code>, puedes intentarlo en el siguiente link: <a href="https://nullpointer-excelsior.github.io/micromouse-challenger/">MicroMouse Challenger Page</a>.</p><h2 id="github-repository"><span class="mr-2"><a href="https://github.com/nullpointer-excelsior/micromouse-challenger">Github repository</a></span><a href="#github-repository" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Meme de cortesía</p><p><img data-src="https://i.ibb.co/gRYDMpS/Screenshot-2023-10-12-at-11-40-34.png" alt="meme" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/frontend/'>Frontend</a>, <a href='//categories/react/'>React</a>, <a href='//categories/rxjs/'>Rxjs</a>, <a href='//categories/arquitectura-frontend/'>Arquitectura Frontend</a>, <a href='//categories/javascript/'>Javascript</a>, <a href='//categories/typescript/'>Typescript</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/frontend/" class="post-tag no-text-decoration" >frontend</a> <a href="//tags/react/" class="post-tag no-text-decoration" >react</a> <a href="//tags/rxjs/" class="post-tag no-text-decoration" >rxjs</a> <a href="//tags/arquitectura-frontend/" class="post-tag no-text-decoration" >arquitectura frontend</a> <a href="//tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="//tags/typescript/" class="post-tag no-text-decoration" >typescript</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada está licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Arquitectura+Frontend+2.+C%C3%B3mo+implementar+Clean+Architecture+en+el+Frontend.+-+Nullpointer+Excelsior&url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Farquitectura-frontend-2-como-implementar-clean-arquitecture%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Arquitectura+Frontend+2.+C%C3%B3mo+implementar+Clean+Architecture+en+el+Frontend.+-+Nullpointer+Excelsior&u=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Farquitectura-frontend-2-como-implementar-clean-arquitecture%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Farquitectura-frontend-2-como-implementar-clean-arquitecture%2F&text=Arquitectura+Frontend+2.+C%C3%B3mo+implementar+Clean+Architecture+en+el+Frontend.+-+Nullpointer+Excelsior" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Farquitectura-frontend-2-como-implementar-clean-arquitecture%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Actualizado recientemente</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/microservicios-observabilidad-en-microservicios-un-ejemplo-practico-de-trazas-distribuidas/">Microservicios 2 Observabilidad en NestJs, un ejemplo práctico de trazas distribuidas</a><li><a href="/posts/realtime-with-reactive-programming/">Aplicaciones en tiempo real con programación reactiva</a><li><a href="/posts/tranajando-con-1millon-de-registros-con-java-stream/">Trabajando con 1 millón de registros con Java Stream</a><li><a href="/posts/disenando-microservicios-con-ddd/">Diseñando Microservicios con Domain Driven Design y NestJS</a><li><a href="/posts/alto-rendimiento-con-cqrs-eventos-en-nestjs/">CQRS en Soluciones de Alto Rendimiento con Nestjs</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/arquitectura-frontend-1-como-integrar-rxjs-4-react-para-aplicaciones-asincronas-complejas/"><div class="card-body"> <em class="small" data-ts="1692640120" data-df="YYYY-MM-DD" > 2023-08-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Arquitectura Frontend 1. Cómo integrar RxJS en React para aplicaciones asíncronas complejas</h3><div class="text-muted small"><p> React es una excelente librería para crear componentes visuales. También nos brinda los hooks, con los cuales podemos trabajar con estados y efectos secundarios en situaciones asíncronas. Si bien...</p></div></div></a></div><div class="card"> <a href="/posts/Ejemplo-programaci%C3%B3n-reactiva-100-Real-No-Fake/"><div class="card-body"> <em class="small" data-ts="1663716720" data-df="YYYY-MM-DD" > 2022-09-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Ejemplo programación reactiva 100% Real No Fake</h3><div class="text-muted small"><p> Ejemplo programación reactiva 100% Real No Fake La programación reactiva es un paradigma enfocado en el trabajo con flujos de datos finitos o infinitos de manera asíncrona. Su concepción y evoluci...</p></div></div></a></div><div class="card"> <a href="/posts/Usando-los-Hooks-de-React-m%C3%A1s-all%C3%A1-del-useState/"><div class="card-body"> <em class="small" data-ts="1663803120" data-df="YYYY-MM-DD" > 2022-09-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Usando los Hooks de React más allá del useState</h3><div class="text-muted small"><p> Usando los Hooks de React más allá del useState Hack 1 - Petición asíncrona con useState() y useEffect() juntos El siguiente componente muestra los datos obtenidos mediante una operación asíncron...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/arquitectura-frontend-1-como-integrar-rxjs-4-react-para-aplicaciones-asincronas-complejas/" class="btn btn-outline-primary" prompt="Anterior"><p>Arquitectura Frontend 1. Cómo integrar RxJS en React para aplicaciones asíncronas complejas</p></a> <a href="//posts/microservicios-1-construyendo-aplicaciones-escalables-y-mantenibles/" class="btn btn-outline-primary" prompt="Nuevo"><p>MicroServicios 1 Construyendo aplicaciones escalables y mantenibles</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/nullpointer-excelsior">Benjamin</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Hecho con <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
