<!DOCTYPE html><html lang="es-ES" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Robusto control de errores más allá del Try Catch" /><meta name="author" content="Benjamin" /><meta property="og:locale" content="es_ES" /><meta name="description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><meta property="og:description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><link rel="canonical" href="https://nullpointer-excelsior.github.io/posts/robust-error-handling-beyond-try-catch/" /><meta property="og:url" content="https://nullpointer-excelsior.github.io/posts/robust-error-handling-beyond-try-catch/" /><meta property="og:site_name" content="Nullpointer Excelsior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-13T12:32:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Robusto control de errores más allá del Try Catch" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Benjamin"},"dateModified":"2023-03-13T12:32:00-03:00","datePublished":"2023-03-13T12:32:00-03:00","description":"Ingeniería de software aplicada, tips, buenas práctias y códigos","headline":"Robusto control de errores más allá del Try Catch","mainEntityOfPage":{"@type":"WebPage","@id":"https://nullpointer-excelsior.github.io/posts/robust-error-handling-beyond-try-catch/"},"url":"https://nullpointer-excelsior.github.io/posts/robust-error-handling-beyond-try-catch/"}</script><title>Robusto control de errores más allá del Try Catch | Nullpointer Excelsior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nullpointer Excelsior"><meta name="application-name" content="Nullpointer Excelsior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.webp" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nullpointer Excelsior</a></div><div class="site-subtitle font-italic">Ingeniería de software aplicada</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/nullpointer-excelsior" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Robusto control de errores más allá del Try Catch</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Robusto control de errores más allá del Try Catch</h1><div class="post-meta text-muted"> <span> Publicado <em class="" data-ts="1678721520" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2023-03-13 </em> </span><div class="d-flex justify-content-between"> <span> Por <em> Benjamin </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1146 palabras"> <em>6 min</em> de lectura</span></div></div></div><div class="post-content"><p><img data-src="https://i.ibb.co/yFqbm4x/Screenshot-2023-03-13-at-15-33-52.png" alt="img" data-proofer-ignore></p><p>El control de errores en aplicaciones tradicionalmente los manejamos con <code class="language-plaintext highlighter-rouge">trycatch</code> si bien esto nos proporciona una manera efectiva y simple de controlar errores y definir lógicas un poco más elaboradas de cara al cliente, existe otra alternativa proveniente de la programación funcional.</p><h2 id="either-monad"><span class="mr-2">Either Monad</span><a href="#either-monad" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La <code class="language-plaintext highlighter-rouge">Either Monad</code> es una estructura de datos en programación funcional que se utiliza para manejar valores que pueden tener dos posibles estados: “éxito” o “falla”. Básicamente creamos una respuesta donde puede ser uno de estos 2 valores:</p><ul><li><code class="language-plaintext highlighter-rouge">Right value</code>: lo que queremos retornar cuando nuestro código realiza una operación exitosa.<li><code class="language-plaintext highlighter-rouge">Left value</code>: retornamos un objeto que representa un error.</ul><p>Este simple enfoque nos puede proveer una manera de control de errores mucho más robusta.</p><h2 id="try-catch-vs-either"><span class="mr-2">Try catch vs Either</span><a href="#try-catch-vs-either" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Dependiendo del escenario <code class="language-plaintext highlighter-rouge">trycatch</code> puede dejar de ser una manera efectiva de controlar errores, ya que una excepción se refiere a algo excepcional que ha ocurrido en el sistema y este debe interrumpirse o tratar de recuperarse. Una excepción es adecuada para los siguientes casos:</p><ul><li>Problemas de red o conexión<li>Errores en librerías de bajo nivel<li>Errores correspondiente al ambiente o sistema operativo</ul><p>En cambio <code class="language-plaintext highlighter-rouge">Either</code> es ideal para un control de errores más específicos relacionados con lógicas de dominio, ya que nos obliga a definir la respuesta correcta a ciertos errores, si bien la implementación de Either por si sola nos da la posibilidad entre una respuesta exitosa y una fallida, Este enfoque a menudo se implementa junto a <code class="language-plaintext highlighter-rouge">pattern matching</code> una estructura encontrada muy a menudo en la programación funcional. Esta combinación nos permite tener el control total de un flujo relacionado con la lógica principal del programa, ya que estaremos obligados a implementar todas las posibles respuestas fallidas incluyendo el caso exitoso esto separa totalmente las excepciones de los errores de lógicas. En typescript no disponemos de pattern matching, pero podemos hacer algo interesante con el tipado.</p><h2 id="implementando-un-control-de-errores-avanzados-con-typescript"><span class="mr-2">Implementando un control de errores avanzados con typescript</span><a href="#implementando-un-control-de-errores-avanzados-con-typescript" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La implementación básica de Either está dada por el siguiente código:</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">type</span> <span class="nx">Result</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">Success</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span> <span class="o">|</span> <span class="nx">Failure</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Success</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="k">readonly</span> <span class="na">success</span><span class="p">:</span> <span class="nx">T</span><span class="p">;</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="na">success</span><span class="p">:</span> <span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="nx">success</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">isSuccess</span><span class="p">():</span> <span class="k">this</span> <span class="k">is</span> <span class="nx">Success</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">isError</span><span class="p">():</span> <span class="k">this</span> <span class="k">is</span> <span class="nx">Failure</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Failure</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="k">readonly</span> <span class="na">error</span><span class="p">:</span> <span class="nx">E</span><span class="p">;</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="na">error</span><span class="p">:</span> <span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="nx">error</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">isSuccess</span><span class="p">():</span> <span class="k">this</span> <span class="k">is</span> <span class="nx">Success</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">isError</span><span class="p">():</span> <span class="k">this</span> <span class="k">is</span> <span class="nx">Failure</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>

</pre></table></code></div></div><p>El funcionamiento de estos componentes es el siguiente:</p><ul><li><code class="language-plaintext highlighter-rouge">Success</code>: Representa una respuesta exitosa y contendrá un valor para ser tratado.<li><code class="language-plaintext highlighter-rouge">Failure</code>: Representa un error específico este también contiene un valor el cual puede ser el detalle del error ocurrido en la lógica<li><code class="language-plaintext highlighter-rouge">Result</code>: este objeto representa una respuesta exitosa o fallida,</ul><p>Si <code class="language-plaintext highlighter-rouge">Result</code> es exitoso puede devolver el valor de <code class="language-plaintext highlighter-rouge">Success</code> pero no puede devolver el error definido del objeto <code class="language-plaintext highlighter-rouge">Failure</code>, en cambio si <code class="language-plaintext highlighter-rouge">Result</code> es de tipo <code class="language-plaintext highlighter-rouge">Failure</code> podremos obtener el valor de <code class="language-plaintext highlighter-rouge">Failure</code> pero no el valor de <code class="language-plaintext highlighter-rouge">Success</code>. Para consultar si el objeto <code class="language-plaintext highlighter-rouge">Result</code> es exitoso lo haremos por medio del método <code class="language-plaintext highlighter-rouge">isError()</code> o <code class="language-plaintext highlighter-rouge">isSuccessful()</code> a su vez al invocar alguno de estos 2 métodos typescript automáticamente hará un casting de <code class="language-plaintext highlighter-rouge">Result</code> a <code class="language-plaintext highlighter-rouge">Success</code> o <code class="language-plaintext highlighter-rouge">Failure</code> dependiendo de si la operación fue existosa o errónea</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">// example 1</span>
<span class="nx">result</span> <span class="o">=</span> <span class="nx">failureOperation</span><span class="p">()</span>
<span class="nx">result</span><span class="p">.</span><span class="nx">error</span> <span class="c1">// typing error: error no existe mientras no se llame a isError()</span>
<span class="k">if</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">IsError</span><span class="p">())</span> <span class="p">{</span>
  <span class="nx">result</span><span class="p">.</span><span class="nx">error</span> <span class="c1">// casting automatico</span>
<span class="p">}</span>

<span class="c1">//example 2</span>
<span class="nx">result</span> <span class="o">=</span> <span class="nx">succesOperation</span><span class="p">()</span>
<span class="nx">result</span><span class="p">.</span><span class="nx">success</span> <span class="c1">// typing error: success no existe mientras no se llame a !isError()</span>
<span class="nx">result</span><span class="p">.</span><span class="nx">error</span> <span class="c1">// typing error: error no existe mientras no se llame a isError()</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">IsError</span><span class="p">())</span> <span class="p">{</span>
  <span class="nx">result</span><span class="p">.</span><span class="nx">success</span> <span class="c1">// casting automatico</span>
<span class="p">}</span>

</pre></table></code></div></div><p>El uso de <code class="language-plaintext highlighter-rouge">Either</code> es bastante sencillo y poderoso ahora implementaremos un control de errores avanzado con esta clase de ayuda</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nx">ErrorHandler</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="kr">string</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="na">error</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="k">private</span> <span class="na">message</span><span class="p">:</span> <span class="kr">string</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">No provided error message</span><span class="dl">'</span><span class="p">)</span> <span class="p">{}</span>

    <span class="nx">match</span><span class="p">(</span><span class="na">handler</span><span class="p">:</span> <span class="nb">Record</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="p">(</span><span class="na">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">error</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">handler</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">error</span><span class="p">](</span><span class="k">this</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// si hay una coincidencia ejecutará el método callback</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>Esta clase recibe un tipo generico que representará los errores que pueden ocurrir, el método match se encarga de invocar una función callback asociada al error. Para entender mejor este código crearemos nuestro <code class="language-plaintext highlighter-rouge">ErrorHandler</code> basados en una API de productos</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>
<span class="c1">// definimos nuetsrso custom errors</span>
<span class="k">export</span> <span class="kd">type</span> <span class="nx">ProductErrors</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">unavailableStock</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">serverError</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">otherError</span><span class="dl">'</span>

<span class="c1">// heredamos una clase de ErrorHandler que representará nuestros errores</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductErrorHandler</span> <span class="kd">extends</span> <span class="nx">ErrorHandler</span><span class="o">&lt;</span><span class="nx">ProductErrors</span><span class="o">&gt;</span> <span class="p">{</span>

<span class="p">}</span>

</pre></table></code></div></div><p>El siguiente ejemplo nos permite entender el uso del patron <code class="language-plaintext highlighter-rouge">Either</code>, el método <code class="language-plaintext highlighter-rouge">udpateStock()</code> dependiendo del caso devolverá una respuesta exitosa o un error específico el cual puede tratarse de una manera más personalizada.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductService</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span>
        <span class="k">private</span> <span class="nx">productRepository</span><span class="p">:</span> <span class="nx">ProductRepository</span><span class="p">,</span>
        <span class="k">private</span> <span class="nx">stockRepository</span><span class="p">:</span> <span class="nx">StockService</span>
    <span class="p">)</span> <span class="p">{}</span>

    <span class="nx">updateStock</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">stock</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nx">Result</span><span class="o">&lt;</span><span class="kr">any</span><span class="p">,</span> <span class="nx">UpdateStockErrorHandler</span><span class="o">&gt;</span> <span class="p">{</span>

        <span class="kd">const</span> <span class="nx">product</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">productRepository</span><span class="p">.</span><span class="nx">findById</span><span class="p">(</span><span class="k">new</span> <span class="nx">ProductID</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">product</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">Failure</span><span class="p">(</span><span class="k">new</span> <span class="nx">UpdateStockErrorHandler</span><span class="p">(</span><span class="dl">'</span><span class="s1">productNotFound</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`Product(id=</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">) Not found`</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="kd">const</span> <span class="nx">stockAvailable</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stockRepository</span><span class="p">.</span><span class="nx">queryStock</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">ID</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">stockAvailable</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">Failure</span><span class="p">(</span><span class="k">new</span> <span class="nx">UpdateStockErrorHandler</span><span class="p">(</span><span class="dl">'</span><span class="s1">unavailableStock</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`Product(id=</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">) stock unavailable!!!`</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">stockAvailable</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">Failure</span><span class="p">(</span><span class="k">new</span> <span class="nx">UpdateStockErrorHandler</span><span class="p">(</span><span class="dl">'</span><span class="s1">insuffisientStock</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`Product(id=</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">) stock cannot be updated`</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">stockRepository</span><span class="p">.</span><span class="nx">updateStock</span><span class="p">(</span><span class="nx">product</span><span class="p">.</span><span class="nx">ID</span><span class="p">,</span> <span class="nx">stock</span><span class="p">)</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nx">Success</span><span class="p">({</span>
            <span class="na">productId</span><span class="p">:</span> <span class="nx">product</span><span class="p">.</span><span class="nx">ID</span><span class="p">,</span>
            <span class="na">newStock</span><span class="p">:</span> <span class="nx">stock</span>
        <span class="p">})</span>

    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>Y ahora cuando invocamos el servicio de productos Obtendremos nuestro objeto Result (patron Either)</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>
<span class="kd">const</span> <span class="nx">productId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">ab351bc97d</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">productService</span><span class="p">.</span><span class="nx">updateStock</span><span class="p">(</span><span class="nx">productId</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">isSuccess</span><span class="p">())</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">match</span><span class="p">({</span>
        <span class="na">insuffisientStock</span><span class="p">:(</span><span class="na">msg</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">alertService</span><span class="p">.</span><span class="nx">sendAlert</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="na">productNotFound</span><span class="p">:</span> <span class="p">(</span><span class="na">msg</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="c1">// some actions...</span>
        <span class="p">},</span>
        <span class="na">unavailableStock</span><span class="p">:</span> <span class="p">(</span><span class="na">msg</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="c1">// some actions...</span>
        <span class="p">}</span>
    <span class="p">})</span>
<span class="p">}</span>

</pre></table></code></div></div><p>Al invocar el método <code class="language-plaintext highlighter-rouge">match()</code> de Error nos obligará a implementar métodos callbacks basados en el type error definido previamente.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// my custom errors</span>
<span class="k">export</span> <span class="kd">type</span> <span class="nx">ProductErrors</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">unavailableStock</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">serverError</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">otherError</span><span class="dl">'</span>
</pre></table></code></div></div><h2 id="conclusiones"><span class="mr-2">Conclusiones</span><a href="#conclusiones" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Implementamos Either en typescript para un control de errores más robusto para la lógica principal de la aplicación. <code class="language-plaintext highlighter-rouge">Either</code> Puede ser interesante para abordar casos bordes de una manera sencilla con la posibilidad de cubrir de manera obligatoria los errores referentes al negocio, mientras que <code class="language-plaintext highlighter-rouge">trycatch</code> nos puede tratar las excepciones como eventos o errores externos a la lógica de negocio principal.</p><h2 id="meme-de-cortesía"><span class="mr-2">Meme de cortesía</span><a href="#meme-de-cortesía" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="https://i.ibb.co/rsm5f96/Screenshot-2023-03-13-at-15-27-29.png" alt="meme" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/programacion/'>Programacion</a>, <a href='//categories/arquitectura-de-software/'>Arquitectura de software</a>, <a href='//categories/typescript/'>Typescript</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/typescript/" class="post-tag no-text-decoration" >Typescript</a> <a href="//tags/javascript/" class="post-tag no-text-decoration" >Javascript</a> <a href="//tags/patterns-designs/" class="post-tag no-text-decoration" >Patterns Designs</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada está licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Robusto+control+de+errores+m%C3%A1s+all%C3%A1+del+Try+Catch+-+Nullpointer+Excelsior&url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Frobust-error-handling-beyond-try-catch%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Robusto+control+de+errores+m%C3%A1s+all%C3%A1+del+Try+Catch+-+Nullpointer+Excelsior&u=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Frobust-error-handling-beyond-try-catch%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Frobust-error-handling-beyond-try-catch%2F&text=Robusto+control+de+errores+m%C3%A1s+all%C3%A1+del+Try+Catch+-+Nullpointer+Excelsior" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Frobust-error-handling-beyond-try-catch%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Actualizado recientemente</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/microservicios-observabilidad-en-microservicios-un-ejemplo-practico-de-trazas-distribuidas/">Microservicios 2 Observabilidad en NestJs, un ejemplo práctico de trazas distribuidas</a><li><a href="/posts/realtime-with-reactive-programming/">Aplicaciones en tiempo real con programación reactiva</a><li><a href="/posts/tranajando-con-1millon-de-registros-con-java-stream/">Trabajando con 1 millón de registros con Java Stream</a><li><a href="/posts/disenando-microservicios-con-ddd/">Diseñando Microservicios con Domain Driven Design y NestJS</a><li><a href="/posts/alto-rendimiento-con-cqrs-eventos-en-nestjs/">CQRS en Soluciones de Alto Rendimiento con Nestjs</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/realtime-with-reactive-programming/"><div class="card-body"> <em class="small" data-ts="1677166320" data-df="YYYY-MM-DD" > 2023-02-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Aplicaciones en tiempo real con programación reactiva</h3><div class="text-muted small"><p> Las aplicaciones en tiempo real se definen como aquellas que ofrecen una respuesta en tiempo real a eventos del mundo real. Piensa en aplicaciones de chat en línea, aplicaciones de juegos, aplica...</p></div></div></a></div><div class="card"> <a href="/posts/state-machine-design-pattern/"><div class="card-body"> <em class="small" data-ts="1686151920" data-df="YYYY-MM-DD" > 2023-06-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Conociendo el patrón de diseño state machine.</h3><div class="text-muted small"><p> Sí correcto este es otro post de patrones de diseño. lo distinto es que es uno de los que nadie habla pero se usa muy a menudo y no nos damos ni cuenta. Hoy voy a hablarles del patrón de diseño c...</p></div></div></a></div><div class="card"> <a href="/posts/como-implementar-un-eventbus-y-rxjs-en-conjunto/"><div class="card-body"> <em class="small" data-ts="1692189120" data-df="YYYY-MM-DD" > 2023-08-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Arquitecturas Orientadas a Eventos. Implementando un EventBus y RxJS en Conjunto</h3><div class="text-muted small"><p> En el mundo de la arquitectura de software, especialmente en entornos orientados a microservicios, la comunicación y la coordinación entre componentes son cruciales. Una forma efectiva de lograrl...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/realtime-with-reactive-programming/" class="btn btn-outline-primary" prompt="Anterior"><p>Aplicaciones en tiempo real con programación reactiva</p></a> <a href="//posts/state-machine-design-pattern/" class="btn btn-outline-primary" prompt="Nuevo"><p>Conociendo el patrón de diseño state machine.</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/nullpointer-excelsior">Benjamin</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Hecho con <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
