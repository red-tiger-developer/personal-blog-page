<!DOCTYPE html><html lang="es-ES" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Integración de arquitectura hexagonal en Spring" /><meta name="author" content="Benjamin" /><meta property="og:locale" content="es_ES" /><meta name="description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><meta property="og:description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><link rel="canonical" href="https://nullpointer-excelsior.github.io/posts/integracion-de-arquitectura-hexagonal-en-spring/" /><meta property="og:url" content="https://nullpointer-excelsior.github.io/posts/integracion-de-arquitectura-hexagonal-en-spring/" /><meta property="og:site_name" content="Nullpointer Excelsior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-08-29T01:00:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Integración de arquitectura hexagonal en Spring" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Benjamin"},"dateModified":"2024-08-29T01:00:00-04:00","datePublished":"2024-08-29T01:00:00-04:00","description":"Ingeniería de software aplicada, tips, buenas práctias y códigos","headline":"Integración de arquitectura hexagonal en Spring","mainEntityOfPage":{"@type":"WebPage","@id":"https://nullpointer-excelsior.github.io/posts/integracion-de-arquitectura-hexagonal-en-spring/"},"url":"https://nullpointer-excelsior.github.io/posts/integracion-de-arquitectura-hexagonal-en-spring/"}</script><title>Integración de arquitectura hexagonal en Spring | Nullpointer Excelsior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nullpointer Excelsior"><meta name="application-name" content="Nullpointer Excelsior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.webp" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nullpointer Excelsior</a></div><div class="site-subtitle font-italic">Ingeniería de software aplicada</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/nullpointer-excelsior" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Integración de arquitectura hexagonal en Spring</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Integración de arquitectura hexagonal en Spring</h1><div class="post-meta text-muted"> <span> Publicado <em class="" data-ts="1724907600" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2024-08-29 </em> </span><div class="d-flex justify-content-between"> <span> Por <em> Benjamin </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1400 palabras"> <em>7 min</em> de lectura</span></div></div></div><div class="post-content"><p><img data-src="/assets/img/intros/intro8.webp" alt="intro" data-proofer-ignore></p><p>La arquitectura hexagonal busca separar el dominio de las implementaciones tecnológicas. El modelado de dominio se puede hacer mediante DDD, pero no es obligatorio. Sin embargo, hay patrones muy útiles que pueden ayudarte a crear un código más mantenible.</p><p><strong>RECUERDA:</strong> el diseño y la aplicación de patrones o ciertas arquitecturas dependerán del problema que quieres solucionar y si este aporta valor al objetivo planteado.</p><h2 id="ejemplo-práctico-de-una-arquitectura-hexagonal-aplicada-en-spring-boot"><span class="mr-2">Ejemplo práctico de una arquitectura hexagonal aplicada en Spring Boot</span><a href="#ejemplo-práctico-de-una-arquitectura-hexagonal-aplicada-en-spring-boot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Implementaremos una aplicación base CRUD para un clon de LinkedIn. Este ejemplo es simple, con una sola entidad que representa a un profesional. Si quieres ver el ejemplo más a fondo, revisa el siguiente repositorio <a href="https://github.com/nullpointer-excelsior/java-architecture-patterns/tree/master/hexagonal">Java Architecture Patterns</a></p><h2 id="qué-es-la-arquitectura-hexagonal"><span class="mr-2">¿Qué es la arquitectura hexagonal?</span><a href="#qué-es-la-arquitectura-hexagonal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La arquitectura hexagonal, también conocida como arquitectura de puertos y adaptadores, permite desacoplar el núcleo de la lógica de negocio de las implementaciones tecnológicas, haciendo que la aplicación sea más fácil de mantener, probar y escalar.</p><p>A continuación, se explica la estructura y los componentes principales de esta aplicación de ejemplo:</p><h2 id="capa-de-aplicación"><span class="mr-2">Capa de Aplicación</span><a href="#capa-de-aplicación" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>ProfessionalUseCases:</strong> Define los casos de uso que el sistema expone. En este caso, hay un método <code class="language-plaintext highlighter-rouge">createProfessional</code> que permite crear un nuevo profesional. Este método se encarga de coordinar la creación de un nuevo <code class="language-plaintext highlighter-rouge">Professional</code> en la capa de dominio, guardar ese profesional a través del repositorio y publicar un evento de dominio (<code class="language-plaintext highlighter-rouge">ProfessionalCreatedEvent</code>) en el bus de eventos.</ul><h2 id="capa-de-dominio"><span class="mr-2">Capa de Dominio</span><a href="#capa-de-dominio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="entidades"><span class="mr-2">Entidades:</span><a href="#entidades" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Professional:</strong> Es la entidad central en el dominio. Se encarga de representar a un profesional con atributos como <code class="language-plaintext highlighter-rouge">id</code>, <code class="language-plaintext highlighter-rouge">firstname</code> y <code class="language-plaintext highlighter-rouge">lastname</code>. Incluye una validación mediante el uso de Jakarta Bean Validation (<code class="language-plaintext highlighter-rouge">@NotBlank</code>, <code class="language-plaintext highlighter-rouge">@UUID</code>) para asegurar que los datos son correctos. La creación de un <code class="language-plaintext highlighter-rouge">Professional</code> se realiza a través del método estático <code class="language-plaintext highlighter-rouge">create</code>.</ul><h3 id="eventos-de-dominio"><span class="mr-2">Eventos de Dominio:</span><a href="#eventos-de-dominio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>ProfessionalCreatedEvent:</strong> Representa un evento que ocurre cuando un nuevo profesional es creado. Este evento se propaga a través del bus de eventos de dominio (<code class="language-plaintext highlighter-rouge">DomainEventBus</code>).</ul><h3 id="excepciones"><span class="mr-2">Excepciones:</span><a href="#excepciones" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>DomainException:</strong> Se lanza cuando hay un problema en la validación o en la lógica del dominio.</ul><h3 id="interfaces-puertos"><span class="mr-2">Interfaces (Puertos):</span><a href="#interfaces-puertos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>ProfessionalRepository:</strong> Define las operaciones que deben implementarse para interactuar con la persistencia de datos de <code class="language-plaintext highlighter-rouge">Professional</code>.<li><strong>DomainEventBus:</strong> Define el contrato para publicar eventos de dominio.</ul><h2 id="capa-de-infraestructura"><span class="mr-2">Capa de Infraestructura</span><a href="#capa-de-infraestructura" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="persistencia"><span class="mr-2">Persistencia:</span><a href="#persistencia" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>ProfessionalEntity:</strong> Es la representación de la entidad <code class="language-plaintext highlighter-rouge">Professional</code> en la base de datos, mapeada usando JPA. Define cómo se almacenan los datos en la tabla <code class="language-plaintext highlighter-rouge">professionals</code>.<li><strong>JpaProfessionalRepository:</strong> Extiende <code class="language-plaintext highlighter-rouge">JpaRepository</code> para proporcionar métodos CRUD para <code class="language-plaintext highlighter-rouge">ProfessionalEntity</code>.<li><strong>PostgresProfessionalRepository:</strong> Implementa el puerto <code class="language-plaintext highlighter-rouge">ProfessionalRepository</code> usando el repositorio JPA subyacente. Se encarga de mapear los datos entre las entidades de dominio (<code class="language-plaintext highlighter-rouge">Professional</code>) y las entidades de base de datos (<code class="language-plaintext highlighter-rouge">ProfessionalEntity</code>).</ul><h3 id="adaptadores"><span class="mr-2">Adaptadores:</span><a href="#adaptadores" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>InMemoryDomainEventBus:</strong> Es una implementación del bus de eventos que se utiliza para publicar eventos de dominio, aunque en este caso es una implementación en memoria que podría usarse en pruebas o desarrollo.</ul><h3 id="configuración"><span class="mr-2">Configuración:</span><a href="#configuración" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="coreconfig"><span class="mr-2">CoreConfig:</span><a href="#coreconfig" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Configura los beans de la aplicación, como el caso de uso (<code class="language-plaintext highlighter-rouge">ProfessionalUseCases</code>) y el bus de eventos (<code class="language-plaintext highlighter-rouge">DomainEventBus</code>), usando Spring.</p><h2 id="flujo-general"><span class="mr-2">Flujo General:</span><a href="#flujo-general" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Crear Profesional:</strong> El cliente invoca el caso de uso <code class="language-plaintext highlighter-rouge">createProfessional</code> pasando los datos necesarios.<li><strong>Validación:</strong> En la capa de dominio, se valida la creación del <code class="language-plaintext highlighter-rouge">Professional</code>.<li><strong>Persistencia:</strong> El <code class="language-plaintext highlighter-rouge">Professional</code> creado se guarda en la base de datos a través de <code class="language-plaintext highlighter-rouge">PostgresProfessionalRepository</code>.<li><strong>Publicación de Evento:</strong> Se publica un evento de dominio (<code class="language-plaintext highlighter-rouge">ProfessionalCreatedEvent</code>) usando el bus de eventos configurado.</ul><p>Este diseño modular permite que la aplicación sea flexible y fácilmente extensible, como por ejemplo, cambiar el sistema de almacenamiento o la implementación del bus de eventos sin afectar el núcleo de la lógica de negocio.</p><h2 id="integración-con-frameworks"><span class="mr-2">Integración con frameworks</span><a href="#integración-con-frameworks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Como hemos dicho antes, este enfoque de arquitectura nos permite separar el dominio y las lógicas de negocio de cualquier implementación externa tecnológica. Esto nos da la ventaja de poder crear aplicaciones más mantenibles y agrega más simplicidad al testing unitario. En este ejemplo, integramos la capa de dominio y la capa de aplicación con Spring, pero perfectamente este enfoque se puede hacer con cualquier otro framework.</p><h3 id="creando-adaptadores"><span class="mr-2">Creando adaptadores</span><a href="#creando-adaptadores" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Para poder instanciar los componentes de tipo servicio o repository en una aplicación de Spring con arquitectura hexagonal, debemos definir las implementaciones de los puertos, es decir, los adaptadores. En este caso, tenemos los siguientes puertos:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DomainEventBus</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">publish</span><span class="o">(</span><span class="nc">DomainEvent</span><span class="o">&lt;?&gt;</span> <span class="n">event</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ProfessionalRepository</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Professional</span> <span class="n">p</span><span class="o">);</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="nc">Professional</span> <span class="n">p</span><span class="o">);</span>
    <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">Professional</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Crearemos las implementaciones:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">InMemoryDomainEventBus</span> <span class="kd">implements</span> <span class="nc">DomainEventBus</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">publish</span><span class="o">(</span><span class="nc">DomainEvent</span><span class="o">&lt;?&gt;</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ... send events code</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Crearemos un repository de Spring y su entidad correspondiente:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"professionals"</span><span class="o">)</span>
<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProfessionalEntity</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">generator</span> <span class="o">=</span> <span class="s">"UUID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="no">UUID</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@NotBlank</span>
    <span class="nd">@Column</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">firstname</span><span class="o">;</span>

    <span class="nd">@Column</span>
    <span class="nd">@NotBlank</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastname</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">JpaProfessionalRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">ProfessionalEntity</span><span class="o">,</span> <span class="no">UUID</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Y ahora implementamos el puerto <code class="language-plaintext highlighter-rouge">ProfessionalRepository</code>:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="nd">@Repository</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PostgresProfessionalRepository</span> <span class="kd">implements</span> <span class="nc">ProfessionalRepository</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JpaProfessionalRepository</span> <span class="n">repository</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Professional</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">entity</span> <span class="o">=</span> <span class="nc">ProfessionalEntity</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getId</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">firstname</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getFirstname</span><span class="o">())</span>
                <span class="o">.</span><span class="na">lastname</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getLastname</span><span class="o">())</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">entity</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="nc">Professional</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">Professional</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">repository</span><span class="o">.</span><span class="na">findAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="nc">Professional</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                        <span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getId</span><span class="o">().</span><span class="na">toString</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">firstname</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getFirstname</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">lastname</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getLastname</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">build</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Debemos hacer hincapié en que la entidad ORM es distinta a una entidad de dominio. Muchos confunden ambos conceptos y los tratan de igual manera, y lo único que logran es acoplar las lógicas de negocio con implementaciones tecnológicas de persistencia. Las entidades ORM representan un mapeo de base de datos y pueden tener comportamientos inesperados si se tratan como lógicas de negocio.</p><h2 id="inyección-de-servicios-de-aplicación"><span class="mr-2">Inyección de Servicios de Aplicación</span><a href="#inyección-de-servicios-de-aplicación" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>En la capa de aplicación nos encontramos con los casos de uso o, propiamente dicho, la entrada y control del programa. Ahora debemos inyectar de manera manual el servicio <code class="language-plaintext highlighter-rouge">ProfessionalUseCases</code>. Para lograrlo, haremos uso de un componente de tipo <code class="language-plaintext highlighter-rouge">@Configuration</code> de Spring.</p><p>En esta clase inyectamos el puerto <code class="language-plaintext highlighter-rouge">ProfessionalRepository</code>, el cual es una interfaz. Spring, por debajo, encuentra el componente <code class="language-plaintext highlighter-rouge">PostgresProfessionalRepository</code> y lo inyectará, ya que esta es la implementación de <code class="language-plaintext highlighter-rouge">ProfessionalRepository</code>. Ahora solo debemos definir a <code class="language-plaintext highlighter-rouge">ProfessionalUseCases</code> mediante la anotación <code class="language-plaintext highlighter-rouge">@Bean</code>, la cual le indica a Spring que el componente puede ser llamado desde otros puntos de la aplicación. También creamos el bean <code class="language-plaintext highlighter-rouge">DomainEventBus</code>.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nd">@Configuration</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CoreConfig</span> <span class="o">{</span>

    <span class="nc">ProfessionalRepository</span> <span class="n">professionalRepository</span><span class="o">;</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">ProfessionalUseCases</span> <span class="nf">getProfessionalUseCase</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">ProfessionalUseCases</span><span class="o">(</span><span class="n">professionalRepository</span><span class="o">,</span> <span class="n">getDomainEventBus</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">DomainEventBus</span> <span class="nf">getDomainEventBus</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">InMemoryDomainEventBus</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Ahora, para hacer uso de los casos de uso de la aplicación, lo hacemos de manera tradicional con Spring:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">ProfessionalUseCases</span> <span class="n">useCases</span><span class="o">;</span>
</pre></table></code></div></div><p>Esta es la manera básica de implementar la inyección de dependencias en una arquitectura hexagonal. Puede que nos dé un poco de código extra comparado con la manera tradicional de hacer aplicaciones en Spring, pero obtendrás las siguientes ventajas:</p><ul><li><strong>Código portable:</strong> La lógica y las reglas de negocio serán portables entre frameworks, librerías e integraciones tecnológicas como bases de datos, integraciones con eventos, etc.<li><strong>Test unitario más simple:</strong> El testing unitario es el más simple de realizar; sin embargo, si tu código no sigue buenas prácticas, será complejo de igual manera. Enfoques de clean architecture te permitirán realizar testing de forma sencilla.<li><strong>Código de dominio se autoexplica:</strong> Si implementas hexagonal o cualquier arquitectura limpia, tenderás a crear código con mejores prácticas. Estas incluirán una definición de nombres y acciones más orientadas a comportamiento que a tecnologías.<li><strong>Mantenibilidad:</strong> Un código que separa el dominio de implementaciones tecnológicas podrá llevar a cabo cambios menos drásticos a los que pueden realizarse cuando ambos conceptos están acoplados.</ul><h2 id="conclusión"><span class="mr-2">Conclusión</span><a href="#conclusión" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La integración de la arquitectura hexagonal en aplicaciones Spring ofrece una sólida separación entre el dominio y las implementaciones tecnológicas, permitiendo un diseño modular y flexible. Aunque requiere un esfuerzo adicional en la configuración inicial, los beneficios a largo plazo en términos de mantenibilidad, portabilidad, y simplicidad en las pruebas unitarias son significativos. Al adoptar esta arquitectura, se fomenta un enfoque más limpio y organizado en el desarrollo de software, facilitando la evolución y escalabilidad de las aplicaciones con un menor costo técnico.</p><h2 id="github-repository"><span class="mr-2"><a href="https://github.com/nullpointer-excelsior/java-architecture-patterns/tree/master/hexagonal">Github repository</a></span><a href="#github-repository" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="meme-de-despedida"><span class="mr-2">Meme de despedida</span><a href="#meme-de-despedida" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="/assets/img/memes/meme7.webp" alt="meme" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/arquitectura-arquitectura/'>Arquitectura,Arquitectura</a>, <a href='//categories/software-spring-microservicios-backend/'>Software,Spring,Microservicios,Backend</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/arquitectura-arquitectura/" class="post-tag no-text-decoration" >arquitectura,arquitectura</a> <a href="//tags/software-spring-microservicios-backend/" class="post-tag no-text-decoration" >software,spring,microservicios,backend</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada está licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Integraci%C3%B3n+de+arquitectura+hexagonal+en+Spring+-+Nullpointer+Excelsior&url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fintegracion-de-arquitectura-hexagonal-en-spring%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Integraci%C3%B3n+de+arquitectura+hexagonal+en+Spring+-+Nullpointer+Excelsior&u=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fintegracion-de-arquitectura-hexagonal-en-spring%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fintegracion-de-arquitectura-hexagonal-en-spring%2F&text=Integraci%C3%B3n+de+arquitectura+hexagonal+en+Spring+-+Nullpointer+Excelsior" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fintegracion-de-arquitectura-hexagonal-en-spring%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Actualizado recientemente</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/microservicios-observabilidad-en-microservicios-un-ejemplo-practico-de-trazas-distribuidas/">Microservicios 2 Observabilidad en NestJs, un ejemplo práctico de trazas distribuidas</a><li><a href="/posts/realtime-with-reactive-programming/">Aplicaciones en tiempo real con programación reactiva</a><li><a href="/posts/tranajando-con-1millon-de-registros-con-java-stream/">Trabajando con 1 millón de registros con Java Stream</a><li><a href="/posts/disenando-microservicios-con-ddd/">Diseñando Microservicios con Domain Driven Design y NestJS</a><li><a href="/posts/alto-rendimiento-con-cqrs-eventos-en-nestjs/">CQRS en Soluciones de Alto Rendimiento con Nestjs</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/resena-del-libro-enterprise-integration-patterns/"><div class="card-body"> <em class="small" data-ts="1739854800" data-df="YYYY-MM-DD" > 2025-02-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reseña del Libro Enterprise Integration Patterns</h3><div class="text-muted small"><p> Resumen General Enterprise Integration Patterns: Designing, Building, and Deploying Messaging Solutions es un libro escrito en 2003 por Gregor Hohpe y Bobby Woolf que explora cómo integrar soluci...</p></div></div></a></div><div class="card"> <a href="/posts/que-es-cqrs-y-como-funciona-con-un-ejemplo-practico/"><div class="card-body"> <em class="small" data-ts="1738645200" data-df="YYYY-MM-DD" > 2025-02-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>¿Qué es CQRS y cómo funciona? Con un ejemplo práctico.</h3><div class="text-muted small"><p> ¿Qué es CQRS y qué problema soluciona? CQRS (Command Query Responsibility Segregation) es un patrón arquitectónico que separa las operaciones de lectura y escritura en una aplicación. En lugar d...</p></div></div></a></div><div class="card"> <a href="/posts/que-es-y-como-funciona-el-event-sourcing-con-un-ejemplo-practico/"><div class="card-body"> <em class="small" data-ts="1738040400" data-df="YYYY-MM-DD" > 2025-01-28 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>¿Qué es y cómo funciona el Event Sourcing con un ejemplo práctico?</h3><div class="text-muted small"><p> ¿Qué es Event Sourcing? Event Sourcing es un patrón de arquitectura de software que trata cada cambio en el estado de una aplicación como un evento. En lugar de almacenar el estado actual de un ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/backend-for-frontend-pattern/" class="btn btn-outline-primary" prompt="Anterior"><p>Backend for Frontend pattern</p></a> <a href="//posts/que-es-y-como-funciona-el-event-sourcing-con-un-ejemplo-practico/" class="btn btn-outline-primary" prompt="Nuevo"><p>¿Qué es y cómo funciona el Event Sourcing con un ejemplo práctico?</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/nullpointer-excelsior">Benjamin</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Hecho con <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
