<!DOCTYPE html><html lang="es-ES" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="¿Qué es CQRS y cómo funciona? Con un ejemplo práctico." /><meta name="author" content="Benjamin" /><meta property="og:locale" content="es_ES" /><meta name="description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><meta property="og:description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><link rel="canonical" href="https://nullpointer-excelsior.github.io/posts/que-es-cqrs-y-como-funciona-con-un-ejemplo-practico/" /><meta property="og:url" content="https://nullpointer-excelsior.github.io/posts/que-es-cqrs-y-como-funciona-con-un-ejemplo-practico/" /><meta property="og:site_name" content="Nullpointer Excelsior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-02-04T02:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="¿Qué es CQRS y cómo funciona? Con un ejemplo práctico." /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Benjamin"},"dateModified":"2025-02-04T02:00:00-03:00","datePublished":"2025-02-04T02:00:00-03:00","description":"Ingeniería de software aplicada, tips, buenas práctias y códigos","headline":"¿Qué es CQRS y cómo funciona? Con un ejemplo práctico.","mainEntityOfPage":{"@type":"WebPage","@id":"https://nullpointer-excelsior.github.io/posts/que-es-cqrs-y-como-funciona-con-un-ejemplo-practico/"},"url":"https://nullpointer-excelsior.github.io/posts/que-es-cqrs-y-como-funciona-con-un-ejemplo-practico/"}</script><title>¿Qué es CQRS y cómo funciona? Con un ejemplo práctico. | Nullpointer Excelsior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nullpointer Excelsior"><meta name="application-name" content="Nullpointer Excelsior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.webp" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nullpointer Excelsior</a></div><div class="site-subtitle font-italic">Ingeniería de software aplicada</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/nullpointer-excelsior" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>¿Qué es CQRS y cómo funciona? Con un ejemplo práctico.</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>¿Qué es CQRS y cómo funciona? Con un ejemplo práctico.</h1><div class="post-meta text-muted"> <span> Publicado <em class="" data-ts="1738645200" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2025-02-04 </em> </span><div class="d-flex justify-content-between"> <span> Por <em> Benjamin </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2242 palabras"> <em>12 min</em> de lectura</span></div></div></div><div class="post-content"><p><img data-src="/assets/img/intros/intro11.webp" alt="intro" data-proofer-ignore></p><h2 id="qué-es-cqrs-y-qué-problema-soluciona"><span class="mr-2">¿Qué es CQRS y qué problema soluciona?</span><a href="#qué-es-cqrs-y-qué-problema-soluciona" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>CQRS (Command Query Responsibility Segregation) es un patrón arquitectónico que separa las operaciones de lectura y escritura en una aplicación. En lugar de usar un solo modelo para ambas tareas, CQRS define modelos independientes: uno para procesar comandos (modificaciones de datos) y otro para ejecutar consultas (lectura de datos).</p><h2 id="escalabilidad-de-aplicaciones-mediante-arquitectura"><span class="mr-2">Escalabilidad de aplicaciones mediante arquitectura</span><a href="#escalabilidad-de-aplicaciones-mediante-arquitectura" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Esta separación mejora el rendimiento al evitar conflictos entre lecturas y escrituras, facilita la escalabilidad ajustando cada parte según sus necesidades y simplifica el mantenimiento en sistemas complejos. Es especialmente útil en aplicaciones con alta concurrencia o grandes volúmenes de datos, donde optimizar cada operación por separado marca la diferencia.</p><blockquote><p>En el siguiente artículo <a href="https://nullpointer-excelsior.github.io/posts/alto-rendimiento-con-cqrs-eventos-en-nestjs/">Alto rendimiento con CQRS y NestJs</a> Podrás ver cómo CQRS mejora el rendimiento de una aplicación.</p></blockquote><h2 id="ventajas-y-desventajas"><span class="mr-2">Ventajas y desventajas</span><a href="#ventajas-y-desventajas" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Ventajas:</strong></p><ul><li><strong>Escalabilidad:</strong> Permite escalar las partes de lectura y escritura de forma independiente, optimizando los recursos.<li><strong>Simplicidad:</strong> Simplifica el modelo de dominio al separar las responsabilidades de escritura y lectura.<li><strong>Rendimiento:</strong> Mejora el rendimiento al optimizar las bases de datos para cada tipo de operación.<li><strong>Flexibilidad:</strong> Facilita la implementación de diferentes modelos de datos para lectura y escritura.</ul><p><strong>Desventajas:</strong></p><ul><li><strong>Complejidad:</strong> Introduce complejidad arquitectónica al separar las responsabilidades.<li><strong>Consistencia eventual:</strong> Puede generar inconsistencia eventual entre los datos de escritura y lectura.<li><strong>Sobrecarga:</strong> Requiere la implementación de componentes adicionales como buses de comandos y consultas.</ul><h2 id="componentes-principales"><span class="mr-2">Componentes principales</span><a href="#componentes-principales" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>commands:</strong> Representan intenciones de cambiar el estado del sistema. Son objetos que contienen información sobre la operación a realizar, pero no el resultado de la operación.<li><strong>queries:</strong> Representan solicitudes de información del sistema. Son objetos que especifican qué datos se necesitan, pero no cómo obtenerlos.<li><strong>command handlers:</strong> Son responsables de ejecutar los comandos. Reciben un comando, validan la información y modifican el estado del dominio.<li><strong>query handlers:</strong> Son responsables de ejecutar las consultas. Reciben una consulta y devuelven los datos solicitados.<li><strong>command bus:</strong> Es el componente encargado de enrutar los comandos a sus respectivos handlers.<li><strong>query bus:</strong> Es el componente encargado de enrutar las consultas a sus respectivos handlers.<li><strong>read model:</strong> Es una representación optimizada de los datos para lectura. Puede ser una base de datos diferente o una vista materializada.<li><strong>write model:</strong> Es el modelo de dominio principal donde se realizan las operaciones de escritura.</ul><h2 id="ejemplo-práctico-con-java"><span class="mr-2">Ejemplo práctico con Java</span><a href="#ejemplo-práctico-con-java" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="sistema-de-reseñas-de-productos-con-cqrs"><span class="mr-2">Sistema de reseñas de productos con CQRS</span><a href="#sistema-de-reseñas-de-productos-con-cqrs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>El ejemplo práctico implementa un sistema de reseñas de productos utilizando el patrón CQRS. El sistema permite a los usuarios agregar reseñas, comentarios y reacciones a las reseñas, así como consultar las reseñas y comentarios de un producto.</p><h3 id="descripción-del-modelo-de-dominio"><span class="mr-2">Descripción del modelo de dominio</span><a href="#descripción-del-modelo-de-dominio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>El modelo de dominio incluye entidades como <code class="language-plaintext highlighter-rouge">Product</code>, <code class="language-plaintext highlighter-rouge">Review</code>, <code class="language-plaintext highlighter-rouge">ReviewComment</code>, <code class="language-plaintext highlighter-rouge">User</code> y <code class="language-plaintext highlighter-rouge">ReviewReaction</code>, que representan los elementos del sistema de reseñas. También se utilizan <em>value objects</em> como <code class="language-plaintext highlighter-rouge">Content</code> para encapsular el contenido de las reseñas y comentarios.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre><td class="rouge-code"><pre><span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="nd">@Builder</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Review</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Double</span> <span class="n">score</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Product</span> <span class="n">product</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Content</span> <span class="n">content</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewComment</span><span class="o">&gt;</span> <span class="n">comments</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewReaction</span><span class="o">&gt;</span> <span class="n">reactions</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addReaction</span><span class="o">(</span><span class="nc">ReviewReaction</span> <span class="n">reaction</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">reactions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">reaction</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addComment</span><span class="o">(</span><span class="nc">ReviewComment</span> <span class="n">comment</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">comments</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">comment</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@Builder</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReviewComment</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Content</span> <span class="n">content</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewReaction</span><span class="o">&gt;</span> <span class="n">reactions</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addReaction</span><span class="o">(</span><span class="nc">ReviewReaction</span> <span class="n">reaction</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">reactions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">reaction</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">sku</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fullname</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">ReactionType</span> <span class="o">{</span>
    <span class="no">LIKE</span><span class="o">,</span><span class="no">DISLIKE</span><span class="o">,</span><span class="no">HELPFUL</span>
<span class="o">}</span>

<span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReviewReaction</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">ReactionType</span> <span class="n">type</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Content</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="casos-de-uso"><span class="mr-2">Casos de uso</span><a href="#casos-de-uso" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Los casos de uso incluyen:</p><ul><li>Agregar una reseña a un producto.<li>Agregar un comentario a una reseña.<li>Agregar una reacción a una reseña o comentario.<li>Obtener las reseñas de un producto.<li>Obtener los comentarios de una reseña.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
</pre><td class="rouge-code"><pre><span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReviewUseCases</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">ReviewWriteRepository</span> <span class="n">reviewWriteRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">UserReadRepository</span> <span class="n">userReadRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">ProductReadRepository</span> <span class="n">productReadRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">ReviewReadRepository</span> <span class="n">reviewReadRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">EventBus</span> <span class="n">eventBus</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addReview</span><span class="o">(</span><span class="nc">AddReviewCommand</span> <span class="n">command</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">userReadRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">userId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoSuchElementException</span><span class="o">(</span><span class="s">"User not found"</span><span class="o">));</span>
        <span class="kt">var</span> <span class="n">product</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">productReadRepository</span><span class="o">.</span><span class="na">findBySku</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">sku</span><span class="o">())</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoSuchElementException</span><span class="o">(</span><span class="s">"Product not found"</span><span class="o">));</span>
        <span class="kt">var</span> <span class="n">review</span> <span class="o">=</span> <span class="nc">Review</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">score</span><span class="o">())</span>
                <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="k">new</span> <span class="nc">Content</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="n">command</span><span class="o">.</span><span class="na">content</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">product</span><span class="o">(</span><span class="n">product</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">reviewWriteRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">review</span><span class="o">);</span>
        <span class="kt">var</span> <span class="n">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReviewCreatedEvent</span><span class="o">(</span><span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">review</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">eventBus</span><span class="o">.</span><span class="na">dispatch</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addReviewReaction</span><span class="o">(</span><span class="nc">AddReviewReactionCommand</span> <span class="n">command</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">userReadRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">userId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoSuchElementException</span><span class="o">(</span><span class="s">"User not found"</span><span class="o">));</span>
        <span class="kt">var</span> <span class="n">review</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">reviewReadRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">reviewId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoSuchElementException</span><span class="o">(</span><span class="s">"Review not found"</span><span class="o">));</span>
        <span class="kt">var</span> <span class="n">reaction</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReviewReaction</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="n">command</span><span class="o">.</span><span class="na">reaction</span><span class="o">());</span>
        <span class="n">review</span><span class="o">.</span><span class="na">addReaction</span><span class="o">(</span><span class="n">reaction</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">reviewWriteRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">review</span><span class="o">);</span>
        <span class="kt">var</span> <span class="n">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReviewUpdatedEvent</span><span class="o">(</span><span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">review</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">eventBus</span><span class="o">.</span><span class="na">dispatch</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addReviewComment</span><span class="o">(</span><span class="nc">AddReviewCommentCommand</span> <span class="n">command</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">userReadRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">userId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoSuchElementException</span><span class="o">(</span><span class="s">"User not found"</span><span class="o">));</span>
        <span class="kt">var</span> <span class="n">review</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">reviewReadRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">reviewId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoSuchElementException</span><span class="o">(</span><span class="s">"Review not found"</span><span class="o">));</span>
        <span class="kt">var</span> <span class="n">comment</span> <span class="o">=</span> <span class="nc">ReviewComment</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">())</span>
                <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="k">new</span> <span class="nc">Content</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="n">command</span><span class="o">.</span><span class="na">content</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="n">review</span><span class="o">.</span><span class="na">addComment</span><span class="o">(</span><span class="n">comment</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">reviewWriteRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">review</span><span class="o">);</span>
        <span class="kt">var</span> <span class="n">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReviewUpdatedEvent</span><span class="o">(</span><span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">review</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">eventBus</span><span class="o">.</span><span class="na">dispatch</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewResult</span><span class="o">&gt;</span> <span class="nf">getReviewsByProduct</span><span class="o">(</span><span class="nc">GetReviewsByProductQuery</span> <span class="n">query</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">reviewReadRepository</span><span class="o">.</span><span class="na">findByProductSku</span><span class="o">(</span><span class="n">query</span><span class="o">.</span><span class="na">sku</span><span class="o">())</span>
                <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">ReviewResult:</span><span class="o">:</span><span class="n">map</span><span class="o">)</span>
                <span class="o">.</span><span class="na">toList</span><span class="o">();</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReviewCommentUseCases</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">UserReadRepository</span> <span class="n">userReadRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">ReviewCommentReadRepository</span> <span class="n">reviewCommentReadRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">ReviewCommentWriteRepository</span> <span class="n">reviewCommentWriteRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">EventBus</span> <span class="n">eventBus</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addReviewCommentReaction</span><span class="o">(</span><span class="nc">AddReviewCommentReactionCommand</span> <span class="n">command</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">userReadRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">userId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoSuchElementException</span><span class="o">(</span><span class="s">"User not found"</span><span class="o">));</span>
        <span class="kt">var</span> <span class="n">reviewComment</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">reviewCommentReadRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">reviewCommentId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoSuchElementException</span><span class="o">(</span><span class="s">"Review comment not found"</span><span class="o">));</span>
        <span class="kt">var</span> <span class="n">reaction</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReviewReaction</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="n">command</span><span class="o">.</span><span class="na">reaction</span><span class="o">());</span>
        <span class="n">reviewComment</span><span class="o">.</span><span class="na">addReaction</span><span class="o">(</span><span class="n">reaction</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">reviewCommentWriteRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">reviewComment</span><span class="o">);</span>
        <span class="kt">var</span> <span class="n">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReviewCommentCreatedEvent</span><span class="o">(</span><span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">reviewComment</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">eventBus</span><span class="o">.</span><span class="na">dispatch</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewCommentResult</span><span class="o">&gt;</span> <span class="nf">getReviewComments</span><span class="o">(</span><span class="nc">GetReviewCommentsQuery</span> <span class="n">query</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">reviewCommentReadRepository</span><span class="o">.</span><span class="na">findByReviewId</span><span class="o">(</span><span class="n">query</span><span class="o">.</span><span class="na">reviewId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">ReviewCommentResult:</span><span class="o">:</span><span class="n">map</span><span class="o">)</span>
                <span class="o">.</span><span class="na">toList</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></table></code></div></div><h3 id="repositorios-read-model-and-write-model"><span class="mr-2">Repositorios Read Model and Write Model</span><a href="#repositorios-read-model-and-write-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Se utilizan repositorios separados para lectura (<code class="language-plaintext highlighter-rouge">ReviewReadRepository</code>, <code class="language-plaintext highlighter-rouge">ReviewCommentReadRepository</code>, etc.) y escritura (<code class="language-plaintext highlighter-rouge">ReviewWriteRepository</code>, <code class="language-plaintext highlighter-rouge">ReviewCommentWriteRepository</code>, etc.). Esto permite optimizar cada repositorio para su respectiva función.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ReviewReadRepository</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Review</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">);</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Review</span><span class="o">&gt;</span> <span class="nf">findByProductSku</span><span class="o">(</span><span class="nc">String</span> <span class="n">sku</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ReviewWriteRepository</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Review</span> <span class="n">review</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ReviewCommentWriteRepository</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">ReviewComment</span> <span class="n">comment</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ReviewCommentReadRepository</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">ReviewComment</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">);</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewComment</span><span class="o">&gt;</span> <span class="nf">findByReviewId</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserReadRepository</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ProductReadRepository</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span> <span class="nf">findBySku</span><span class="o">(</span><span class="nc">String</span> <span class="n">sku</span><span class="o">);</span>
<span class="o">}</span>

</pre></table></code></div></div><blockquote><p>La implementación técnica puede incluir distintas tecnologías de almacenamiento optimizadas para lectura o escritura, dependiendo del caso; pero esto va más allá de este artículo.</p></blockquote><h3 id="ejecución-de-comandos"><span class="mr-2">Ejecución de comandos</span><a href="#ejecución-de-comandos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Los comandos se ejecutan a través del <code class="language-plaintext highlighter-rouge">CommandBus</code>. Por ejemplo, para agregar una reseña, se crea un objeto <code class="language-plaintext highlighter-rouge">AddReviewCommand</code> y se envía al <code class="language-plaintext highlighter-rouge">CommandBus</code>. El <code class="language-plaintext highlighter-rouge">CommandBus</code> enruta el comando al <code class="language-plaintext highlighter-rouge">AddReviewCommandHandler</code>, que ejecuta la lógica de negocio y modifica el modelo de dominio.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="c1">// Command</span>
<span class="nd">@Builder</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">AddReviewCommand</span> <span class="o">(</span><span class="nc">String</span> <span class="n">sku</span><span class="o">,</span> <span class="nc">Double</span> <span class="n">score</span><span class="o">,</span> <span class="nc">String</span> <span class="n">userId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">content</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Command</span> <span class="o">{}</span>

<span class="c1">// Ejemplo de ejecución de un comando</span>
<span class="nc">AddReviewCommand</span> <span class="n">command</span> <span class="o">=</span> <span class="nc">AddReviewCommand</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">sku</span><span class="o">(</span><span class="s">"SKU123"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="mf">4.5</span><span class="o">)</span>
    <span class="o">.</span><span class="na">userId</span><span class="o">(</span><span class="s">"user123"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="s">"Buena reseña"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="n">commandBus</span><span class="o">.</span><span class="na">dispatch</span><span class="o">(</span><span class="n">command</span><span class="o">);</span>

<span class="c1">// CommandBus</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CommandBus</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">dispatch</span><span class="o">(</span><span class="nc">Command</span> <span class="n">command</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// CommandHandler</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CommandHandler</span><span class="o">&lt;</span><span class="no">T</span> <span class="kd">extends</span> <span class="nc">Command</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">onCommand</span><span class="o">(</span><span class="no">T</span> <span class="n">command</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// Implementación de CommandBus</span>
<span class="nd">@Builder</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcurrentCommandBus</span> <span class="kd">implements</span> <span class="nc">CommandBus</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">AddReviewCommandHandler</span> <span class="n">addReviewCommandHandler</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">AddReviewCommentCommandHandler</span> <span class="n">addReviewCommentCommandHandler</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">AddReviewReactionCommandHandler</span> <span class="n">addReviewReactionCommandHandler</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">AddReviewCommentReactionCommandHandler</span> <span class="n">addReviewCommentReactionCommandHandler</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dispatch</span><span class="o">(</span><span class="nc">Command</span> <span class="n">command</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">(</span><span class="kt">var</span> <span class="n">executor</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newVirtualThreadPerTaskExecutor</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">switch</span> <span class="o">(</span><span class="n">command</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">case</span> <span class="nc">AddReviewCommand</span> <span class="n">addReviewCommand</span> <span class="o">-&gt;</span> <span class="n">executor</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span>
                        <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">addReviewCommandHandler</span><span class="o">.</span><span class="na">onCommand</span><span class="o">(</span><span class="n">addReviewCommand</span><span class="o">));</span>
                <span class="k">case</span> <span class="nc">AddReviewCommentCommand</span> <span class="n">addReviewCommentCommand</span> <span class="o">-&gt;</span> <span class="n">executor</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span>
                        <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">addReviewCommentCommandHandler</span><span class="o">.</span><span class="na">onCommand</span><span class="o">(</span><span class="n">addReviewCommentCommand</span><span class="o">));</span>
                <span class="k">case</span> <span class="nc">AddReviewReactionCommand</span> <span class="n">addReviewReactionCommand</span> <span class="o">-&gt;</span> <span class="n">executor</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span>
                        <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">addReviewReactionCommandHandler</span><span class="o">.</span><span class="na">onCommand</span><span class="o">(</span><span class="n">addReviewReactionCommand</span><span class="o">));</span>
                <span class="k">case</span> <span class="nc">AddReviewCommentReactionCommand</span> <span class="n">addReviewCommentReactionCommand</span> <span class="o">-&gt;</span> <span class="n">executor</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span>
                        <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">addReviewCommentReactionCommandHandler</span><span class="o">.</span><span class="na">onCommand</span><span class="o">(</span><span class="n">addReviewCommentReactionCommand</span><span class="o">));</span>
                <span class="k">default</span> <span class="o">-&gt;</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"Unknown command: "</span> <span class="o">+</span> <span class="n">command</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Implementación CommandHandler</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddReviewCommandHandler</span> <span class="kd">implements</span> <span class="nc">CommandHandler</span><span class="o">&lt;</span><span class="nc">AddReviewCommand</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ReviewUseCases</span> <span class="n">review</span><span class="o">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCommand</span><span class="o">(</span><span class="nc">AddReviewCommand</span> <span class="n">command</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">review</span><span class="o">.</span><span class="na">addReview</span><span class="o">(</span><span class="n">command</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="ejecución-de-queries"><span class="mr-2">Ejecución de queries</span><a href="#ejecución-de-queries" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Las consultas se ejecutan a través del QueryBus. Para obtener las reseñas de un producto, se crea un objeto GetReviewsByProductQuery y se envía al QueryBus. El QueryBus enruta la consulta al GetReviewsByProductQueryHandler, que consulta el Read Model y devuelve los resultados.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="c1">// Query</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">GetReviewsByProductQuery</span><span class="o">(</span><span class="nc">String</span> <span class="n">sku</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Query</span> <span class="o">{}</span>

<span class="c1">// Ejemplo de ejecución de una consulta</span>
<span class="nc">GetReviewsByProductQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GetReviewsByProductQuery</span><span class="o">(</span><span class="s">"SKU123"</span><span class="o">);</span>
<span class="nc">CompletableFuture</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewResult</span><span class="o">&gt;&gt;</span> <span class="n">future</span> <span class="o">=</span> <span class="n">queryBus</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="nc">ReviewResult</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewResult</span><span class="o">&gt;</span> <span class="n">reviews</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>

<span class="c1">// QueryBus</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">QueryBus</span> <span class="o">{</span>
    <span class="o">&lt;</span><span class="no">R</span> <span class="kd">extends</span> <span class="nc">Result</span><span class="o">&gt;</span> <span class="nc">CompletableFuture</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="no">R</span><span class="o">&gt;&gt;</span> <span class="nf">query</span><span class="o">(</span><span class="nc">Query</span> <span class="n">query</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;</span><span class="no">R</span><span class="o">&gt;</span> <span class="n">queryType</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// QueryHandler</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">QueryHandler</span><span class="o">&lt;</span><span class="no">Q</span> <span class="kd">extends</span> <span class="nc">Query</span><span class="o">,</span> <span class="no">R</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="no">R</span><span class="o">&gt;</span> <span class="nf">onQuery</span><span class="o">(</span><span class="no">Q</span> <span class="n">query</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// Implementación QueryBus</span>
<span class="nd">@Builder</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcurrentQueryBus</span> <span class="kd">implements</span> <span class="nc">QueryBus</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">GetReviewCommentsQueryHandler</span> <span class="n">getReviewCommentsQueryHandler</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">GetReviewsByProductQueryHandler</span> <span class="n">getReviewsByProductQueryHandler</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="no">R</span> <span class="kd">extends</span> <span class="nc">Result</span><span class="o">&gt;</span> <span class="nc">CompletableFuture</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="no">R</span><span class="o">&gt;&gt;</span> <span class="nf">query</span><span class="o">(</span><span class="nc">Query</span> <span class="n">query</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;</span><span class="no">R</span><span class="o">&gt;</span> <span class="n">queryType</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">(</span><span class="kt">var</span> <span class="n">executor</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newVirtualThreadPerTaskExecutor</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">switch</span> <span class="o">(</span><span class="n">query</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">case</span> <span class="nc">GetReviewCommentsQuery</span> <span class="n">getReviewCommentsQuery</span> <span class="o">-&gt;</span> <span class="nc">CompletableFuture</span><span class="o">.</span><span class="na">supplyAsync</span><span class="o">(</span>
                        <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="no">R</span><span class="o">&gt;)</span> <span class="n">getReviewCommentsQueryHandler</span><span class="o">.</span><span class="na">onQuery</span><span class="o">(</span><span class="n">getReviewCommentsQuery</span><span class="o">),</span> <span class="n">executor</span><span class="o">);</span>
                <span class="k">case</span> <span class="nc">GetReviewsByProductQuery</span> <span class="n">getReviewsByProductQuery</span> <span class="o">-&gt;</span> <span class="nc">CompletableFuture</span><span class="o">.</span><span class="na">supplyAsync</span><span class="o">(</span>
                        <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="no">R</span><span class="o">&gt;)</span> <span class="n">getReviewsByProductQueryHandler</span><span class="o">.</span><span class="na">onQuery</span><span class="o">(</span><span class="n">getReviewsByProductQuery</span><span class="o">),</span> <span class="n">executor</span><span class="o">);</span>
                <span class="k">default</span> <span class="o">-&gt;</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"Unknown query:"</span> <span class="o">+</span> <span class="n">query</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">());</span>
            <span class="o">};</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//Implementación QueryHandler</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GetReviewsByProductQueryHandler</span> <span class="kd">implements</span> <span class="nc">QueryHandler</span><span class="o">&lt;</span><span class="nc">GetReviewsByProductQuery</span><span class="o">,</span> <span class="nc">ReviewResult</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ReviewUseCases</span> <span class="n">reviewUseCases</span><span class="o">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ReviewResult</span><span class="o">&gt;</span> <span class="nf">onQuery</span><span class="o">(</span><span class="nc">GetReviewsByProductQuery</span> <span class="n">query</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">reviewUseCases</span><span class="o">.</span><span class="na">getReviewsByProduct</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="sincronización-del-read-model-con-el-write-model"><span class="mr-2">Sincronización del read model con el write model.</span><a href="#sincronización-del-read-model-con-el-write-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La separación del modelo de datos en uno de lectura y otro de escritura conlleva considerar que nuestro sistema tendrá que lidiar con la consistencia eventual y estos 2 modelos deben sincronizarse, por lo que tenemos las siguientes opciones:</p><ul><li><strong>CDC (change capture data) solucion de infraestructura:</strong> Una forma de sincronizar el Read Model con el Write Model es utilizando Change Data Capture (CDC). CDC captura los cambios en el Write Model (generalmente una base de datos) y los propaga al Read Model. Esto se puede implementar con herramientas como Debezium, Apache Kafka Connect, Etc.<li><strong>Réplicas de lectura de AWS:</strong> AWS ofrece la posibilidad de crear réplicas de lectura de las bases de datos. Estas réplicas se pueden utilizar como Read Model, ya que replican los cambios del Write Model de forma asíncrona. Esta opción es ideal para evitar preocuparnos de la infraestructura, solo debemos considerar los costos asociados.<li><strong>Vistas materializadas:</strong> Una vista materializada es una tabla que almacena el resultado de una consulta predefinida y se actualiza periódicamente para reflejar los cambios en los datos subyacentes. Esta técnica permite mejorar el rendimiento de las consultas de lectura sin afectar la base de datos principal. Este enfoque es utilizado cuando el Write Model y el Read Model están en el mismo motor de base de datos.<li><strong>Eventos de integración:</strong> Otra forma es utilizando eventos de integración. Cuando se realiza un cambio en el Write Model, se genera un evento que se publica en un bus de eventos (EventBus). Los componentes que mantienen el Read Model se suscriben a estos eventos y actualizan el Read Model en consecuencia. Este es el enfoque utilizado en el ejemplo de código. Cuando se crea una nueva review, se publica un evento ReviewCreatedEvent que es consumido por los event handlers que actualizan el Read Model.</ul><p>En el siguiente ejemplo, podemos ver la sincronización mediante eventos de integración. Estos pueden ser consumidos por componentes de la misma aplicación u otra aplicación que actúa como un worker o job.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">// Event</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">ReviewCreatedEvent</span><span class="o">(</span><span class="nc">String</span> <span class="n">eventId</span><span class="o">,</span> <span class="nc">LocalDateTime</span> <span class="n">createdAt</span><span class="o">,</span> <span class="nc">Review</span> <span class="n">payload</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Event</span> <span class="o">{</span>

<span class="o">}</span>
<span class="c1">// Ejemplo de publicación de un evento</span>
<span class="nc">ReviewCreatedEvent</span> <span class="n">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReviewCreatedEvent</span><span class="o">(</span><span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(),</span> <span class="n">review</span><span class="o">);</span>
<span class="n">eventBus</span><span class="o">.</span><span class="na">dispatch</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>

<span class="c1">// Ejemplo de un event handler</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReviewCreatedEventHandler</span> <span class="kd">implements</span> <span class="nc">EventHandler</span><span class="o">&lt;</span><span class="nc">ReviewCreatedEvent</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onEvent</span><span class="o">(</span><span class="nc">ReviewCreatedEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"saving Review on read model:"</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="na">payload</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="conclusión"><span class="mr-2">Conclusión</span><a href="#conclusión" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La separación de modelos de lectura y escritura en CQRS permite mejorar significativamente la escalabilidad y la organización del código. Al dividir estas responsabilidades, el sistema puede optimizar consultas y comandos de manera independiente, evitando bloqueos en la base de datos y permitiendo ajustar los recursos según las necesidades de cada operación. Esto resulta especialmente útil en aplicaciones con alta concurrencia o grandes volúmenes de datos, donde mantener un solo modelo puede generar cuellos de botella.</p><p>Sin embargo, esta separación introduce el desafío de sincronizar el modelo de lectura con el de escritura, asegurando que los datos reflejen cambios recientes sin comprometer el rendimiento. Estrategias como CDC, réplicas de lectura y eventos de integración permiten mantener la consistencia eventual, cada una con sus propias ventajas y consideraciones. Elegir el enfoque adecuado dependerá de los requisitos del sistema y su infraestructura, garantizando un balance entre rendimiento, consistencia y costos operativos.</p><h2 id="github-repository"><span class="mr-2"><a href="https://github.com/nullpointer-excelsior/java-architecture-patterns/tree/master/app/src/main/java/com/benjamin/cqrs">Github repository</a></span><a href="#github-repository" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/assets/img/memes/meme9.webp" alt="meme" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/java/'>Java</a>, <a href='//categories/architecture/'>Architecture</a>, <a href='//categories/coding/'>Coding</a>, <a href='//categories/backend/'>Backend</a>, <a href='//categories/fullstack/'>Fullstack</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/java/" class="post-tag no-text-decoration" >Java</a> <a href="//tags/architecture/" class="post-tag no-text-decoration" >Architecture</a> <a href="//tags/coding/" class="post-tag no-text-decoration" >Coding</a> <a href="//tags/backend/" class="post-tag no-text-decoration" >Backend</a> <a href="//tags/fullstack/" class="post-tag no-text-decoration" >Fullstack</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada está licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%C2%BFQu%C3%A9+es+CQRS+y+c%C3%B3mo+funciona%3F+Con+un+ejemplo+pr%C3%A1ctico.+-+Nullpointer+Excelsior&url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fque-es-cqrs-y-como-funciona-con-un-ejemplo-practico%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%C2%BFQu%C3%A9+es+CQRS+y+c%C3%B3mo+funciona%3F+Con+un+ejemplo+pr%C3%A1ctico.+-+Nullpointer+Excelsior&u=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fque-es-cqrs-y-como-funciona-con-un-ejemplo-practico%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fque-es-cqrs-y-como-funciona-con-un-ejemplo-practico%2F&text=%C2%BFQu%C3%A9+es+CQRS+y+c%C3%B3mo+funciona%3F+Con+un+ejemplo+pr%C3%A1ctico.+-+Nullpointer+Excelsior" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fque-es-cqrs-y-como-funciona-con-un-ejemplo-practico%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Actualizado recientemente</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/microservicios-observabilidad-en-microservicios-un-ejemplo-practico-de-trazas-distribuidas/">Microservicios 2 Observabilidad en NestJs, un ejemplo práctico de trazas distribuidas</a><li><a href="/posts/realtime-with-reactive-programming/">Aplicaciones en tiempo real con programación reactiva</a><li><a href="/posts/tranajando-con-1millon-de-registros-con-java-stream/">Trabajando con 1 millón de registros con Java Stream</a><li><a href="/posts/disenando-microservicios-con-ddd/">Diseñando Microservicios con Domain Driven Design y NestJS</a><li><a href="/posts/alto-rendimiento-con-cqrs-eventos-en-nestjs/">CQRS en Soluciones de Alto Rendimiento con Nestjs</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/que-es-y-como-funciona-el-event-sourcing-con-un-ejemplo-practico/"><div class="card-body"> <em class="small" data-ts="1738040400" data-df="YYYY-MM-DD" > 2025-01-28 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>¿Qué es y cómo funciona el Event Sourcing con un ejemplo práctico?</h3><div class="text-muted small"><p> ¿Qué es Event Sourcing? Event Sourcing es un patrón de arquitectura de software que trata cada cambio en el estado de una aplicación como un evento. En lugar de almacenar el estado actual de un ...</p></div></div></a></div><div class="card"> <a href="/posts/tranajando-con-1millon-de-registros-con-java-stream/"><div class="card-body"> <em class="small" data-ts="1675092720" data-df="YYYY-MM-DD" > 2023-01-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Trabajando con 1 millón de registros con Java Stream</h3><div class="text-muted small"><p> Trabajando con 1 millón de registros con Java Stream Cuando trabajamos con grandes cantidades de datos lo primero que hacemos es definir un filtrado de la fuente de datos para poder trabajar co...</p></div></div></a></div><div class="card"> <a href="/posts/high-performance-reactive-applications-with-spring-webflux/"><div class="card-body"> <em class="small" data-ts="1676043120" data-df="YYYY-MM-DD" > 2023-02-10 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Aplicaciones Reactivas de Alto Rendimiento con Spring WebFlux</h3><div class="text-muted small"><p> ¿Qué es Spring WebFlux Spring WebFlux es un proyecto del Framework Spring que permite el desarrollo de aplicaciones web asíncronas siguiendo el paradigma de programación reactivo. Ofrece una alt...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/que-es-y-como-funciona-el-event-sourcing-con-un-ejemplo-practico/" class="btn btn-outline-primary" prompt="Anterior"><p>¿Qué es y cómo funciona el Event Sourcing con un ejemplo práctico?</p></a> <a href="//posts/resena-del-libro-enterprise-integration-patterns/" class="btn btn-outline-primary" prompt="Nuevo"><p>Reseña del Libro Enterprise Integration Patterns</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/nullpointer-excelsior">Benjamin</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Hecho con <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
