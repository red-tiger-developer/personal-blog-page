<!DOCTYPE html><html lang="es-ES" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Arquitectura hexagonal con nestjs Parte I" /><meta name="author" content="Benjamin" /><meta property="og:locale" content="es_ES" /><meta name="description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><meta property="og:description" content="Ingeniería de software aplicada, tips, buenas práctias y códigos" /><link rel="canonical" href="https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part1/" /><meta property="og:url" content="https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part1/" /><meta property="og:site_name" content="Nullpointer Excelsior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-25T12:32:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Arquitectura hexagonal con nestjs Parte I" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Benjamin"},"dateModified":"2022-12-05T00:19:47-03:00","datePublished":"2022-10-25T12:32:00-03:00","description":"Ingeniería de software aplicada, tips, buenas práctias y códigos","headline":"Arquitectura hexagonal con nestjs Parte I","mainEntityOfPage":{"@type":"WebPage","@id":"https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part1/"},"url":"https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part1/"}</script><title>Arquitectura hexagonal con nestjs Parte I | Nullpointer Excelsior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nullpointer Excelsior"><meta name="application-name" content="Nullpointer Excelsior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.webp" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nullpointer Excelsior</a></div><div class="site-subtitle font-italic">Ingeniería de software aplicada</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/nullpointer-excelsior" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Arquitectura hexagonal con nestjs Parte I</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Arquitectura hexagonal con nestjs Parte I</h1><div class="post-meta text-muted"> <span> Publicado <em class="" data-ts="1666711920" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-10-25 </em> </span> <span> Actualizado <em class="" data-ts="1670210387" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-12-05 </em> </span><div class="d-flex justify-content-between"> <span> Por <em> Benjamin </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3956 palabras"> <em>21 min</em> de lectura</span></div></div></div><div class="post-content"><p><img data-src="https://i.ibb.co/5r0wpwC/Hexagonal-1207406438.png" alt="image" data-proofer-ignore></p><p>No voy a profundizar en que es una arquitectura hexagonal, ya que tenemos un montón de recursos que te lo explican de forma detallada, pero ojo que cuando hablamos de este tipo de arquitecturas debemos entender los conceptos principales y no cerrarnos a seguir una pauta al 100%, ya que lo importante acá es definir el dominio de tu lógica de negocio como el núcleo de tu aplicación de todas formas acá la típica explicación más resumida posible porque este post es más código y práctica.</p><h2 id="qué-es-la-arquitectura-hexagonal"><span class="mr-2">¿Qué es la arquitectura hexagonal?</span><a href="#qué-es-la-arquitectura-hexagonal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Es un tipo de arquitectura de software que busca separar el core lógico de la aplicación (modelo de entidades y casos de uso) y dejarlo en el centro, aislado del exterior y de otras interacciones. Donde las interacciones serán componentes tecnológicos como servicios, bases de datos, UI, APIs, otros sistemas, colas, etc. finalmente para lograr la conexión entre el core de la aplicación con el resto del sistema se realizara mediante puertos y adaptadores donde los puertos son el contrato definido para poder interactuar con el core y los adaptadores son la implementación lógica de estos es decir los puertos son interfaces y los adaptadores son las implementaciones.</p><h3 id="las-capas-básicas-serian-las-siguientes-en-esta-arquitectura"><span class="mr-2">Las capas básicas serian las siguientes en esta arquitectura:</span><a href="#las-capas-básicas-serian-las-siguientes-en-esta-arquitectura" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">Domain</code>: son las entidades, reglas de negocio y puertos que definiremos en nuestra aplicación las reglas y funcionalidades pueden estar encapsuladas en servicios de dominio.<li><code class="language-plaintext highlighter-rouge">Application</code>: aca definimos los casos de uso y puertos que necesitemos, esta capa se comunica con <code class="language-plaintext highlighter-rouge">domain</code> y hace uso de las reglas, las entidades y los servicios de dominio definidos. Los casos de uso pueden ser encapsulados en servicios de dominio<li><code class="language-plaintext highlighter-rouge">Infraestructure</code>: definimos nuestras implementaciones tecnologías configuraciones del framework, bases de datos, api rest y también acá implementamos la lógica de los adaptadores que se encargaran de comunicar la capa <code class="language-plaintext highlighter-rouge">infraestructure </code>con <code class="language-plaintext highlighter-rouge">application</code> o con <code class="language-plaintext highlighter-rouge">domain</code></ul><h1 id="de-verdad-nos-resulta-útil-esta-arquitectura-o-mejor-seguimos-jugando-al-programador-ninja">¿De verdad nos resulta útil esta arquitectura? ¿o mejor seguimos jugando al programador ninja?</h1><p>Una arquitectura hexagonal es autoexplicativa y define una separación de la lógica de negocio de la implementación tecnológica, para sistemas que sabemos que a futuro necesiten ser escalables y mantenibles, pensar en este tipo de soluciones nos alejara de crear monstruos difíciles de corregir o de mejorar funcionalidades sin que otra parte del sistema falle sin saber qué sucedió. Por último, no es solo aplicar patrones sofisticados de software ni la última moda de los libros de ingeniería, sino de que aplicaras los principios SOLID y podrás obtener una mejor forma de testear los casos de uso y reglas de negocio.</p><h3 id="veamos-el-siguiente-ejemplo-de-una-típica-arquitectura-en-capas-la-que-aparece-en-tutoriales-y-en-la-mayoría-de-las-aplicaciones-simples-funciona-perfecto"><span class="mr-2">Veamos el siguiente ejemplo de una típica arquitectura en capas la que aparece en tutoriales y en la mayoría de las aplicaciones simples funciona perfecto</span><a href="#veamos-el-siguiente-ejemplo-de-una-típica-arquitectura-en-capas-la-que-aparece-en-tutoriales-y-en-la-mayoría-de-las-aplicaciones-simples-funciona-perfecto" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> <span class="nb">.</span>
├──  controllers
│   └──  ProductController.ts
├──  model
│   └──  Product.ts
├──  repositories
│   └──  ProductRepository.ts
└──  services
    └──  ProductService.ts
</pre></table></code></div></div><p>En esta estructura podemos a simple vista decir que es una API de productos, pero no sabemos de qué se trata esa API, ¿es RESTful? ¿Es SOAP? O es un MVC también de seguro, la lógica está en la clase service, pero esto tampoco se explica por si solo para aplicaciones pequeñas este enfoque es suficiente, solo vemos el código fuente y listo, ¿pero en aplicaciones grandes en donde puede que no solo uses una base de datos? Y te integres con servicios como cache u otra estrategia de microservicios, podemos ordenar las capas de la aplicación y definir bien los servicios y separar responsabilidades, pero aún tendremos un problema que es el alto acoplamiento entre la lógica del negocio con el framework o librería implementada en el proyecto. Esto nos obliga a seguir las definiciones del framework o librería para hacer funcionar la aplicación, pero en realidad debe ser al revés el framework debe acoplarse a nuestras necesidades y no nosotros, entonces acá entra en juego los principios SOLID y las buenas prácticas de ingeniería.</p><h3 id="ahora-veamos-una-estructura-de-una-arquitectura-hexagonal"><span class="mr-2">Ahora veamos una estructura de una arquitectura hexagonal</span><a href="#ahora-veamos-una-estructura-de-una-arquitectura-hexagonal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>├──  core
│   ├──  application
│   │   ├──  ProductCreator.ts
│   │   └──  ProductSearcher.ts
│   └──  domain
│       ├──  entities
│       │   └──  Product.ts
│       ├──  ports
│       │   └──  repositories
│       │       └──  ProductRepository.ts
│       └──  services
│           └──  ProductService.ts
└──  infraestructure
    ├──  adapters
    │   └──  PostgresProductRepository.ts
    ├──  database
    │   └──  postgres
    │       └──  orm
    └──  http-server
        └──  api
            ├──  jwt
            ├──  model
            └──  restcontrollers
</pre></table></code></div></div><p>A simple vista ya entendemos la aplicación y la mayoría de su implementación tecnológica. Partimos desde la capa <code class="language-plaintext highlighter-rouge">core</code> en esta encontramos el dominio con una entidad Producto y un ServiceProduct que sería un servicio de dominio y una carpeta llamada <code class="language-plaintext highlighter-rouge">ports</code> la cual expone la interfaz ProductRepository de como las capas superiores se comunicaran con el dominio y la implementación de esta es hecha por <code class="language-plaintext highlighter-rouge">infrasestructure/adapters</code> y como apreciamos existe un implementación PostgresProductRepository. El dominio está definido ahora la capa superior de esta es llamada <code class="language-plaintext highlighter-rouge">application</code> la cual contiene los casos de uso, en esta ocasión vemos 2 casos de uso bastante descriptivos puede darse el caso que en vez de funciones creemos una clase ServiceApplication que contenga los casos de usos definidos como métodos. la siguiente capa es <code class="language-plaintext highlighter-rouge">infraestructure</code> la cual se comunica con la cap <code class="language-plaintext highlighter-rouge">core</code> mediante los adaptadores dependiendo del framework la forma de instanciar los componentes de la capa core cambiaran, pero generalmente debemos crear componentes con el principio de inyección de dependencias. En nuestra capa <code class="language-plaintext highlighter-rouge">infraestructure</code> podemos ver el módulo <code class="language-plaintext highlighter-rouge">database</code> donde se encuentra toda la lógica de conexión a postgres y finalmente vemos la capa <code class="language-plaintext highlighter-rouge">http-server</code> la cual contiene una api rest encapsulando toda la lógica http.</p><h2 id="ejemplo-con-northwind-database-caso-de-uso-crear-productos"><span class="mr-2">Ejemplo con northwind database: Caso de uso crear productos</span><a href="#ejemplo-con-northwind-database-caso-de-uso-crear-productos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Como vimos, la arquitectura hexagonal se centra en el dominio del negocio como núcleo y todo lo relacionado con aspectos tecnológicos, librerías, frameworks o estrategias está separado pero comunicados con el concepto de puertos y adapters. Muy bien, ahora crearemos un ejemplo muy parecido a la estructura anterior basada en un proyecto con Nestjs</p><h3 id="nos-transformamos-en-product-owner-y-describimos-nuestro-problema-de-negocio"><span class="mr-2">Nos transformamos en product owner y describimos nuestro problema de negocio</span><a href="#nos-transformamos-en-product-owner-y-describimos-nuestro-problema-de-negocio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Crearemos un servicio encargado de crear productos en la base de datos Northwind. Northwind es muy utilizada por Microsoft en ejemplos, Hablando brevemente sobre Northwind es un modelo de productos, órdenes de compras y empleados de una compañía que realizan las órdenes en esta primera iteración de nuestra implementación nos enfocaremos en los siguientes casos de usos.</p><ul><li>Creación de productos mediante un endpoint REST<li>Validación de producto con categoría y proveedor válidos</ul><p>Esta aplicación será una API Rest encargada de mantener los productos de la base de datos Northwind con el tiempo ira iterando con nuevas enseñanzas sobre arquitectura hexagonal.</p><h2 id="iniciando-el-projecto-nestjs"><span class="mr-2">Iniciando el projecto Nestjs</span><a href="#iniciando-el-projecto-nestjs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>
nvm use 14
npm i <span class="nt">-g</span> @nestjs/cli
nest new nestjs-northwind-hexagonal
<span class="nb">cd </span>nestjs-northwind-hexagonal

</pre></table></code></div></div><p>Ahora generaremos los siguientes módulos:</p><ul><li><code class="language-plaintext highlighter-rouge">core</code>: Contendrá los submódulos<ul><li><code class="language-plaintext highlighter-rouge">domain</code>: Entidades, Servicios y Puertos de dominio<li><code class="language-plaintext highlighter-rouge">application</code>: Casos de uso que se comunicaran con la capa inferior, es decir, la de dominio</ul><li><code class="language-plaintext highlighter-rouge">infraestructure</code>: Implementará lógicas de los adaptadores encargados de comunicarse con la capa de dominio y application (core module)</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nest g module core
nest g module infraestructure
</pre></table></code></div></div><h2 id="creando-la-capa-de-dominio"><span class="mr-2">Creando la capa de dominio</span><a href="#creando-la-capa-de-dominio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Generaremos la siguiente estructura en la capa de dominio:</p><ul><li><code class="language-plaintext highlighter-rouge">entities</code>: entidades relacionadas para la creación de un producto<li><code class="language-plaintext highlighter-rouge">ports/inbound</code>: acá se encuentran los puertos de entrada representan piezas de software que interactúan con el dominio y pueden cambiar el estado del dominio<li><code class="language-plaintext highlighter-rouge">ports/outbound</code>: representan los puertos de salida que interactúan con el mundo exterior es decir fuera de la capa de dominio y se relacionan con tecnologías o sistemas en este ejemplo son repositorios así que los adaptadores que implementen estas interfaces se comunicaran con alguna base de datos o método de persistencia cosa que el dominio no le interesa saber<li><code class="language-plaintext highlighter-rouge">services</code>: estos son los servicios de dominios serán las implementaciones de <code class="language-plaintext highlighter-rouge">ports/inbound</code> que son piezas de software que interactúan con las entidades y definen reglas de negocio también definiremos los tests unitarios.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre> domain
├──  entities
│   ├──  Category.ts
│   ├──  Product.ts
│   └──  Supplier.ts
├──  ports
│   ├──  inbound
│   │   ├──  CategoryService.ts
│   │   ├──  ProductService.ts
│   │   └──  SupplierService.ts
│   └──  outbound
│       ├──  CategoryRepository.ts
│       ├──  ProductRepository.ts
│       └──  SupplierRepository.ts
└──  services
    ├──  CategoryDomainService.spec.ts
    ├──  CategoryDomainService.ts
    ├──  ProductDomainService.spec.ts
    ├──  ProductDomainService.ts
    ├──  SupplierDomainService.spec.ts
    └──  SupplierDomainService.ts
</pre></table></code></div></div><p>Generaremos la siguiente estructura en la capa de application:</p><ul><li>ProductApplication.ts: este componente será el contrato de como la capa de infraestructura se comunica con los casos de uso en esta ocasión esta clase contienen el método <code class="language-plaintext highlighter-rouge">createProduct()</code><li>services: contendrá la implementación de los servicios de aplicación y sus correspondientes test unitarios</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> application
├──  ProductApplication.ts
└──  services
    ├──  ProductApplicationService.spec.ts
    └──  ProductApplicationService.ts
</pre></table></code></div></div><h3 id="definición-de-entidades"><span class="mr-2">Definición de entidades</span><a href="#definición-de-entidades" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">Category</span> <span class="p">{</span>
    <span class="nl">categoryId</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">categoryName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">description</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">picture</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Supplier</span> <span class="p">{</span>
    <span class="nl">supplierId</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">companyName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">contactName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">contactTitle</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">address</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">city</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">postalCode</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">country</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">phone</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">homepage</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>    
<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Product</span> <span class="p">{</span>

    <span class="nl">productId</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">productName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">category</span><span class="p">:</span> <span class="nx">Category</span><span class="p">;</span>
    <span class="nl">supplier</span><span class="p">:</span> <span class="nx">Supplier</span><span class="p">;</span>
    <span class="nl">quantityPerUnit</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">unitPrice</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">unitsInStock</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">unitsOnOrder</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">discontinued</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>

    <span class="k">static</span> <span class="nx">create</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">category</span><span class="p">:</span> <span class="nx">Category</span><span class="p">,</span> <span class="nx">supplier</span><span class="p">:</span> <span class="nx">Supplier</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">()</span>
        <span class="nx">product</span><span class="p">.</span><span class="nx">productName</span> <span class="o">=</span> <span class="nx">name</span>
        <span class="nx">product</span><span class="p">.</span><span class="nx">category</span> <span class="o">=</span> <span class="nx">category</span>
        <span class="nx">product</span><span class="p">.</span><span class="nx">supplier</span> <span class="o">=</span> <span class="nx">supplier</span>
        <span class="nx">product</span><span class="p">.</span><span class="nx">discontinued</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="nx">product</span><span class="p">.</span><span class="nx">quantityPerUnit</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nx">product</span><span class="p">.</span><span class="nx">unitPrice</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nx">product</span><span class="p">.</span><span class="nx">unitsInStock</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nx">product</span><span class="p">.</span><span class="nx">unitsOnOrder</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="nx">product</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><h3 id="definición-de-puertos"><span class="mr-2">Definición de Puertos</span><a href="#definición-de-puertos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">// inbound ports</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">CategoryService</span> <span class="p">{</span>
    <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Category</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nx">findAll</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Category</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">SupplierRepository</span> <span class="p">{</span>
    <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Supplier</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">ProductService</span> <span class="p">{</span>
    <span class="nx">save</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nx">validateProductPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">):</span> <span class="nx">boolean</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// outbound ports</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">CategoryRepository</span> <span class="p">{</span>
    <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Category</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nx">findAll</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Category</span><span class="p">[]</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">SupplierRepository</span> <span class="p">{</span>
    <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Supplier</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">ProductRepository</span> <span class="p">{</span>
    <span class="nx">save</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="definción-de-servicios"><span class="mr-2">Definción de Servicios</span><a href="#definción-de-servicios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Acá implementamos los contratos definidos en <code class="language-plaintext highlighter-rouge">ports/inbound</code> e inyectamos mediante su constructor los repositorios, entonces encapsulamos la lógica de negocio en la capa de dominio y no lo relacionamos con ningún ente externo como podrían ser anotaciones de Frameworks o librerías si necesitamos utilizar algo así solo debemos definir la funcionalidad como puertos</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductDomainService</span> <span class="k">implements</span> <span class="nx">ProductService</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">ProductRepository</span><span class="p">)</span> <span class="p">{}</span>

    <span class="k">async</span> <span class="nx">save</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">validateProductPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">product</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">ProductServiceError</span><span class="p">(</span><span class="dl">'</span><span class="s1">Product price cannot be negative or equal to zero</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">validateProductPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">product</span><span class="p">.</span><span class="nx">unitPrice</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">CategoryDomainService</span> <span class="k">implements</span> <span class="nx">CategoryService</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">CategoryRepository</span><span class="p">)</span> <span class="p">{}</span>

    <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Category</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">findAll</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Category</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">findAll</span><span class="p">()</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">SupplierDomainService</span> <span class="k">implements</span> <span class="nx">SupplierService</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">SupplierRepository</span><span class="p">)</span> <span class="p">{}</span>

    <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Supplier</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><h3 id="definición-de-la-capa-application"><span class="mr-2">Definición de la capa application</span><a href="#definición-de-la-capa-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Acá definimos el caso de uso, una opción también válida es reemplazar el nombre ProductApplication por algo más descriptivo como ProductCreator o algo de este estilo, pero lo importante acá es definir esta interfaz como punto de entrada para poder usar el caso de uso es importante que sea una interfaz también ya que facilita el reemplazo en las pruebas unitarias.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kr">interface</span> <span class="nx">ProductApplication</span> <span class="p">{</span>
    <span class="nx">createProduct</span><span class="p">(</span><span class="nx">newProduct</span><span class="p">:</span> <span class="nx">NewProductDTO</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="implementación-del-caso-de-uso"><span class="mr-2">Implementación del caso de uso</span><a href="#implementación-del-caso-de-uso" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Como podemos ver nuestro caso de uso tienen una lógica de validación algo más compleja que el servicio de dominio mientras un servicio de dominio se encarga de validaciones de negocio de su entidad relacionada, un servicio de aplicación o caso de uso puede hacer invocaciones a distintos servicios fuera del scope de la entidad en este caso estas validaciones con servicios de dominio de otras entidades es a modo de ejemplo, pero describe perfectamente la idea.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductApplicationService</span> <span class="k">implements</span> <span class="nx">ProductApplication</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span>
        <span class="k">private</span> <span class="nx">product</span><span class="p">:</span> <span class="nx">ProductService</span><span class="p">,</span>
        <span class="k">private</span> <span class="nx">category</span><span class="p">:</span> <span class="nx">CategoryService</span><span class="p">,</span>
        <span class="k">private</span> <span class="nx">supplier</span><span class="p">:</span> <span class="nx">SupplierService</span><span class="p">,</span>
    <span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="k">async</span> <span class="nx">createProduct</span><span class="p">(</span><span class="nx">newProduct</span><span class="p">:</span> <span class="nx">NewProductDTO</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">category</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">category</span><span class="p">.</span><span class="nx">findById</span><span class="p">(</span><span class="nx">newProduct</span><span class="p">.</span><span class="nx">categoryId</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">category</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">ProductApplicationError</span><span class="p">(</span><span class="s2">`Categoría no encontrada id=</span><span class="p">${</span><span class="nx">newProduct</span><span class="p">.</span><span class="nx">categoryId</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="kd">const</span> <span class="nx">supplier</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">supplier</span><span class="p">.</span><span class="nx">findById</span><span class="p">(</span><span class="nx">newProduct</span><span class="p">.</span><span class="nx">supplierId</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">supplier</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">ProductApplicationError</span><span class="p">(</span><span class="s2">`Proveedor no encontrado id=</span><span class="p">${</span><span class="nx">newProduct</span><span class="p">.</span><span class="nx">supplierId</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="kd">const</span> <span class="nx">entity</span> <span class="o">=</span> <span class="nx">Product</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">newProduct</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">category</span><span class="p">,</span> <span class="nx">supplier</span><span class="p">)</span>
        <span class="kd">const</span> <span class="nx">saved</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">product</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">entity</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">saved</span><span class="p">.</span><span class="nx">productId</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><h2 id="arquitectura-hexagonal-y-la-facilidad-de-los-test-unitarios"><span class="mr-2">Arquitectura hexagonal y la facilidad de los test unitarios</span><a href="#arquitectura-hexagonal-y-la-facilidad-de-los-test-unitarios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Al aplicar arquitectura hexagonal en nuestro proyecto los test unitarios suelen ser más simples de implementar, si se te da el caso en que aún te cuesta realizar un test unitario por dependencias o problemas de falseado de componentes puede que necesites refactorizar tus piezas de software y ver si se cumple el principio de responsabilidad única.</p><h3 id="test-unitarios-sobre-productservice"><span class="mr-2">test unitarios sobre ProductService</span><a href="#test-unitarios-sobre-productservice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A continuación preparamos unos test unitarios sobre nuestro componente ProductDomainService los test son sencillos, pero validan el comportamiento deseado por las reglas de negocio.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">ProductrepositoryMock</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">):</span> <span class="nx">ProductRepository</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="na">save</span><span class="p">:</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">().</span><span class="nx">mockReturnValue</span><span class="p">(</span><span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">product</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">ProductDomainService</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>

    <span class="kd">let</span> <span class="na">service</span><span class="p">:</span> <span class="nx">ProductService</span> <span class="o">=</span> <span class="kc">null</span>

    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should call ProductRepository.save()"</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">repositoryMock</span> <span class="o">=</span>  <span class="nx">ProductrepositoryMock</span><span class="p">(({</span> <span class="na">productId</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="k">as</span> <span class="nx">Product</span><span class="p">))</span>
        <span class="nx">service</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductDomainService</span><span class="p">(</span><span class="nx">repositoryMock</span><span class="p">)</span>
        <span class="k">await</span> <span class="nx">service</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span> <span class="na">productId</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">unitPrice</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span> <span class="k">as</span> <span class="nx">Product</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">repositoryMock</span><span class="p">.</span><span class="nx">save</span><span class="p">).</span><span class="nx">toBeCalled</span><span class="p">()</span>
    <span class="p">});</span>

    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should return true productService.validateProductPrice() when unitPrice is greater than 0 "</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">repositoryMock</span> <span class="o">=</span>  <span class="nx">ProductrepositoryMock</span><span class="p">(({</span> <span class="na">productId</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="k">as</span> <span class="nx">Product</span><span class="p">))</span>
        <span class="nx">service</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductDomainService</span><span class="p">(</span><span class="nx">repositoryMock</span><span class="p">)</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">service</span><span class="p">.</span><span class="nx">validateProductPrice</span><span class="p">({</span> <span class="na">productId</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">unitPrice</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span> <span class="k">as</span> <span class="nx">Product</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
    <span class="p">});</span>

    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should throw ProductServiceError when unitPrice is negative or zero"</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">repositoryMock</span> <span class="o">=</span>  <span class="nx">ProductrepositoryMock</span><span class="p">(({</span> <span class="na">productId</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="k">as</span> <span class="nx">Product</span><span class="p">))</span>
        <span class="nx">service</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductDomainService</span><span class="p">(</span><span class="nx">repositoryMock</span><span class="p">)</span>
        <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">service</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span> <span class="na">productId</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">unitPrice</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span> <span class="k">as</span> <span class="nx">Product</span><span class="p">)).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="nx">ProductServiceError</span><span class="p">)</span>
        <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">service</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span> <span class="na">productId</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">unitPrice</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span> <span class="p">}</span> <span class="k">as</span> <span class="nx">Product</span><span class="p">)).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">(</span><span class="nx">ProductServiceError</span><span class="p">)</span>
    <span class="p">});</span>

<span class="p">})</span>
</pre></table></code></div></div><h2 id="capa-de-infraestructuctura"><span class="mr-2">Capa de infraestructuctura</span><a href="#capa-de-infraestructuctura" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Generamos la siguiente estructura:</p><ul><li><code class="language-plaintext highlighter-rouge">adapters</code>: serán las implementaciones de los puertos definidos en nuestra capa de dominio<li><code class="language-plaintext highlighter-rouge">http-server</code>: definiremos toda la lógica de nuestro servidor http en este caso solo tendremos un endpoint y un filtro http para controlar los errores en este módulo emplearemos Nestjs<li><code class="language-plaintext highlighter-rouge">northwind-database</code>: en este módulo tendremos la conexión a la base de datos Northwind y en esta parte estarán las entidades de base de datos no confundir con entidades de dominio son cosas distintas a pesar de que el modelo de la base de datos representa el negocio estas entidades están más relacionadas con TypeOrm que nada.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre> infraestructure
├──  adapters
│   ├──  category.repository.adapter.ts
│   ├──  product.repository.adapter.ts
│   └──  supplier.repository.adapter.ts
├──  http-server
│   ├──  controllers
│   │   └──  product.controller.ts
│   ├──  exception-filters
│   │   └──  product-exception.filter.ts
│   └──  model
│       ├──  app.response.ts
│       └──  create-product.request.ts
├──  infraestructure.module.ts
├──  northwind-database
│   ├──  entities
│   │   ├──  category.entity.ts
│   │   ├──  product.entity.ts
│   │   └──  supplier.entity.ts
│   └──  northwind-database.module.ts
└──  shared
    └──  AppLogger.ts

</pre></table></code></div></div><h2 id="iniciando-la-integración-con-northwind"><span class="mr-2">Iniciando la integración con Northwind</span><a href="#iniciando-la-integración-con-northwind" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Para levantar la base de datos necesitar tener instalado docker y docker-compose ahora iniciamos nuestra base de datos de Northwind con docker-compose y un script del esquema de Northwind encontrados en el siguiente repositorio <a href="https://github.com/nullpointer-excelsior/nestjs-northwind-hexagonal/tree/main/clean-architecture-examples/part-1-create-hexagonal-app-with-nestjs">Github repository</a> nos dirigimos al directorio northwind-db/ y encontraremos un archivo docker-compose.yml con el siguiente contenido:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">northwind-db</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">postgres:13</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">POSTGRES_DB</span><span class="pi">:</span> <span class="s">northwind</span>
      <span class="na">POSTGRES_USER</span><span class="pi">:</span> <span class="s">northwind</span>
      <span class="na">POSTGRES_PASSWORD</span><span class="pi">:</span> <span class="s">northwind</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">postgresql_bin:/usr/lib/postgresql</span>
      <span class="pi">-</span> <span class="s">postgresql_data:/var/lib/postgresql/data</span>
      <span class="pi">-</span> <span class="s">./northwind.sql:/docker-entrypoint-initdb.d/northwind.sql</span>
      <span class="pi">-</span> <span class="s">./files:/files</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">5432:5432</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">db</span>

<span class="na">networks</span><span class="pi">:</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">bridge</span>

<span class="na">volumes</span><span class="pi">:</span>
  <span class="na">pgadmin_root_prefs</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">local</span>
  <span class="na">postgresql_data</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">local</span>
  <span class="na">postgresql_bin</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">local</span>

</pre></table></code></div></div><p>entonces ejecutamos lo siguiente</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c"># up database</span>
docker-compose up <span class="nt">-d</span> 
<span class="c"># show running containers</span>
docker ps 
</pre></table></code></div></div><p>Si todo salió bien tendremos la base de datos northwind con postgres como motor, ahora instalamos las librerías necesarias para conectarnos a la base de datos.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm <span class="nb">install</span> <span class="nt">--save</span> @nestjs/typeorm typeorm pg
</pre></table></code></div></div><p>Como habíamos señalado en una arquitectura hexagonal, todas las interacciones fuera de nuestra lógica core deben hacerse en la capa infraestructure la cual es la que interactúa con el mundo exterior, entonces generaremos el siguiente submódulo de infraestructure.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nest g module infraestructure/northwind-database
</pre></table></code></div></div><p>Dentro de este módulo crearemos las entidades de base de datos que mapean las estructura de tablas del modelo, estas entidades no son los mismos que las entidades de capa de dominio son conceptos distintos en hexagonal, ya que Las entidades de dominio reflejan el modelo de negocio mientras que las entidades de base de datos reflejan las tablas y relaciones y algunos casos estos modelos no son iguales.</p><h3 id="entidades-de-base-de-datos"><span class="mr-2">Entidades de base de datos</span><a href="#entidades-de-base-de-datos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A continuación definiremos las entidades de base de datos con sus correspondientes decoradores.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Entity</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">products</span><span class="dl">'</span><span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductEntity</span> <span class="p">{</span>
    <span class="p">@</span><span class="nd">PrimaryGeneratedColumn</span><span class="p">({</span><span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">product_id</span><span class="dl">'</span><span class="p">})</span>
    <span class="nx">productId</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">product_name</span><span class="dl">'</span><span class="p">})</span>
    <span class="nx">productName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">quantity_per_unit</span><span class="dl">'</span><span class="p">})</span>
    <span class="nx">quantityPerUnit</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">unit_price</span><span class="dl">'</span><span class="p">})</span>
    <span class="nx">unitPrice</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">units_in_stock</span><span class="dl">'</span><span class="p">})</span>
    <span class="nx">unitsInStock</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">units_on_order</span><span class="dl">'</span><span class="p">})</span>
    <span class="nx">unitsOnOrder</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">default</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>
    <span class="nx">discontinued</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">ManyToOne</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">CategoryEntity</span><span class="p">)</span>
    <span class="p">@</span><span class="nd">JoinColumn</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">category_id</span><span class="dl">"</span> <span class="p">})</span>
    <span class="nx">category</span><span class="p">:</span> <span class="nx">CategoryEntity</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">ManyToOne</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">SupplierEntity</span><span class="p">)</span>
    <span class="p">@</span><span class="nd">JoinColumn</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">supplier_id</span><span class="dl">"</span> <span class="p">})</span>
    <span class="nx">supplier</span><span class="p">:</span> <span class="nx">SupplierEntity</span><span class="p">;</span>
    
<span class="p">}</span>

<span class="p">@</span><span class="nd">Entity</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">categories</span><span class="dl">'</span> <span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CategoryEntity</span> <span class="p">{</span>
    <span class="p">@</span><span class="nd">PrimaryGeneratedColumn</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">category_id</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">categoryId</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">category_name</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">categoryName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">()</span>
    <span class="nx">description</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">()</span>
    <span class="nx">picture</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">OneToMany</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">ProductEntity</span><span class="p">,</span> <span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">)</span>
    <span class="nx">products</span><span class="p">:</span> <span class="nx">ProductEntity</span><span class="p">[]</span>
<span class="p">}</span>

<span class="p">@</span><span class="nd">Entity</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">suppliers</span><span class="dl">'</span> <span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">SupplierEntity</span> <span class="p">{</span>
    <span class="p">@</span><span class="nd">PrimaryGeneratedColumn</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">supplier_id</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">supplierId</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">company_name</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">companyName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">contact_name</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">contactName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">contact_title</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">contactTitle</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">address</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">address</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">city</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">city</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">postal_code</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">postalCode</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">country</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">country</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">phone</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">phone</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">homepage</span><span class="dl">'</span> <span class="p">})</span>
    <span class="nx">homepage</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">OneToMany</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">ProductEntity</span><span class="p">,</span> <span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">product</span><span class="p">.</span><span class="nx">category</span><span class="p">)</span>
    <span class="nx">products</span><span class="p">:</span> <span class="nx">ProductEntity</span><span class="p">[]</span>
<span class="p">}</span>
</pre></table></code></div></div><p>El siguiente paso es inyectar el módulo de TypeOrm a NorthwindDatabaseModule. Agregamos las credenciales y definimos las entidades a utilizar con esto nuestro módulo está terminado.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/common</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">TypeOrmModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/typeorm</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">CategoryEntity</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./entities/category.entity</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductEntity</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./entities/product.entity</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">SupplierEntity</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./entities/supplier.entity</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
    <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">TypeOrmModule</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">({</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">postgres</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">host</span><span class="p">:</span> <span class="dl">'</span><span class="s1">localhost</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">port</span><span class="p">:</span> <span class="mi">5432</span><span class="p">,</span>
            <span class="na">username</span><span class="p">:</span> <span class="dl">'</span><span class="s1">northwind</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">password</span><span class="p">:</span> <span class="dl">'</span><span class="s1">northwind</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">database</span><span class="p">:</span> <span class="dl">'</span><span class="s1">northwind</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">entities</span><span class="p">:</span> <span class="p">[</span>
                <span class="nx">ProductEntity</span><span class="p">,</span>
                <span class="nx">CategoryEntity</span><span class="p">,</span>
                <span class="nx">SupplierEntity</span>
            <span class="p">],</span>
            <span class="na">synchronize</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">logging</span><span class="p">:[</span><span class="dl">'</span><span class="s1">query</span><span class="dl">'</span><span class="p">]</span>
        <span class="p">}),</span>
    <span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">NorthwindDatabaseModule</span> <span class="p">{</span> <span class="p">}</span>
</pre></table></code></div></div><h2 id="definiendo-los-adapters-para-los-puertos-de-nuestra-capa-de-dominio"><span class="mr-2">Definiendo los Adapters para los puertos de nuestra capa de dominio</span><a href="#definiendo-los-adapters-para-los-puertos-de-nuestra-capa-de-dominio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ahora como ya tenemos la persistencia lista, implementaremos los puertos de nuestra capa de dominio:</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CategoryRepositoryAdapter</span> <span class="k">implements</span> <span class="nx">CategoryRepository</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(@</span><span class="nd">InjectRepository</span><span class="p">(</span><span class="nx">CategoryEntity</span><span class="p">)</span> <span class="k">private</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">Repository</span><span class="o">&lt;</span><span class="nx">CategoryEntity</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
    
    <span class="k">async</span> <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Category</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">findOneBy</span><span class="p">({</span> <span class="na">categoryId</span><span class="p">:</span> <span class="nx">id</span> <span class="p">})</span>
    <span class="p">}</span>

    <span class="k">async</span> <span class="nx">findAll</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Category</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">SupplierRepositoryAdapter</span> <span class="k">implements</span> <span class="nx">SupplierRepository</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(@</span><span class="nd">InjectRepository</span><span class="p">(</span><span class="nx">SupplierEntity</span><span class="p">)</span> <span class="k">private</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">Repository</span><span class="o">&lt;</span><span class="nx">SupplierEntity</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="k">async</span> <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Supplier</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">findOneBy</span><span class="p">({</span> <span class="na">supplierId</span><span class="p">:</span> <span class="nx">id</span> <span class="p">})</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductRepositoryAdapter</span> <span class="k">implements</span> <span class="nx">ProductRepository</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(@</span><span class="nd">InjectRepository</span><span class="p">(</span><span class="nx">ProductEntity</span><span class="p">)</span> <span class="k">private</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">Repository</span><span class="o">&lt;</span><span class="nx">ProductEntity</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="k">async</span> <span class="nx">save</span><span class="p">(</span><span class="nx">p</span><span class="p">:</span> <span class="nx">Product</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><h2 id="definiendo-el-módulo-http-server"><span class="mr-2">Definiendo el módulo http-server</span><a href="#definiendo-el-módulo-http-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ahora definiremos el módulo dehttp-server haciendo uso de Nestjs</p><h3 id="modelo"><span class="mr-2">Modelo</span><a href="#modelo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kr">interface</span> <span class="nx">AppResponse</span> <span class="p">{</span>
    <span class="nl">status</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">data</span><span class="p">?:</span> <span class="kr">any</span>
<span class="p">}</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">CreateProductRequest</span> <span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">categoryId</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="nl">supplierId</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="exception-filter"><span class="mr-2">Exception Filter</span><a href="#exception-filter" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Definiremos un exception filter para poder controlar las excepciones de una forma centralizada y sin tener que delegar esta responsabilidad de definir una respuesta a nuestros servicio de dominio o de aplicación, que lo haga el framework nos ahorraremos trycatch innecesarios.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Catch</span><span class="p">(</span><span class="nx">ProductApplicationError</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductCreatorFilter</span> <span class="k">implements</span> <span class="nx">ExceptionFilter</span> <span class="p">{</span>

    <span class="k">catch</span><span class="p">(</span><span class="nx">exception</span><span class="p">:</span> <span class="nx">ProductApplicationError</span><span class="p">,</span> <span class="nx">host</span><span class="p">:</span> <span class="nx">ArgumentsHost</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="kd">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">switchToHttp</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getResponse</span><span class="o">&lt;</span><span class="nx">Response</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getRequest</span><span class="o">&lt;</span><span class="nx">Request</span><span class="o">&gt;</span><span class="p">()</span>

        <span class="nx">Logger</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">`ProductController (</span><span class="p">${</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span><span class="p">}</span><span class="s2">) at {</span><span class="p">${</span><span class="nx">request</span><span class="p">.</span><span class="nx">path</span><span class="p">}</span><span class="s2">} error: </span><span class="p">${</span><span class="nx">exception</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>

        <span class="nx">response</span>
            <span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">BAD_REQUEST</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">json</span><span class="p">({</span>
                <span class="na">status</span><span class="p">:</span> <span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">BAD_REQUEST</span><span class="p">,</span>
                <span class="na">message</span><span class="p">:</span> <span class="nx">exception</span><span class="p">.</span><span class="nx">message</span>
            <span class="p">});</span>

    <span class="p">}</span>

<span class="p">}</span>

</pre></table></code></div></div><h3 id="controlador-punto-de-entrada-que-invocara-a-productapplicationservice"><span class="mr-2">Controlador punto de entrada que invocara a ProductApplicationService</span><a href="#controlador-punto-de-entrada-que-invocara-a-productapplicationservice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ahora definimos en controlador que será el punto de entrada para poder crear el producto, este endpoint recibe un nombre de producto, una, id de categoría y un, id de proveedor. Esta clase hace uso de la anotación <code class="language-plaintext highlighter-rouge">@UseFilter()</code> Para poder emplear el filtro de excepciones que habíamos definido ahora la inyección de nuestro servicio lo hacemos mediante el constructor y la anotación <code class="language-plaintext highlighter-rouge">@Inject(PRODUCT_APPLICATION)</code> Necesitamos inyectar nuestro servicio de esta manera, ya que los servicio de dominio y de aplicación que definimos debemos crearlos mediante custom provider una opción que nos da Nestjs en escenario más complejos para la inyección de dependencias.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">/product</span><span class="dl">'</span><span class="p">)</span>
<span class="p">@</span><span class="nd">UseFilters</span><span class="p">(</span><span class="nx">ProductCreatorFilter</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductController</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">PRODUCT_APPLICATION</span><span class="p">)</span> <span class="k">private</span> <span class="nx">application</span><span class="p">:</span> <span class="nx">ProductApplication</span><span class="p">)</span> <span class="p">{}</span>

    <span class="p">@</span><span class="nd">Post</span><span class="p">()</span>
    <span class="k">async</span> <span class="nx">createProduct</span><span class="p">(@</span><span class="nd">Body</span><span class="p">()</span> <span class="nx">request</span><span class="p">:</span> <span class="nx">CreateProductRequest</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">AppResponse</span><span class="o">&gt;</span> <span class="p">{</span>
        
        <span class="nx">AppLogger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`(POST) Create product`</span><span class="p">,</span> <span class="nx">request</span><span class="p">)</span>
        <span class="kd">const</span> <span class="nx">productId</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">application</span><span class="p">.</span><span class="nx">createProduct</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span> 
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="na">status</span><span class="p">:</span> <span class="mi">201</span><span class="p">,</span>
            <span class="na">message</span><span class="p">:</span> <span class="s2">`Product(id=</span><span class="p">${</span><span class="nx">productId</span><span class="p">}</span><span class="s2">) created OK`</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><p>El core de nuestra arquitectura hexagonal esta completo, definimos pruebas unitarias que validan las lógicas de negocio propuestas, y pudimos implementar un enfoque mas descriptivo de nuestra aplicación.</p><h2 id="que-se-viene-despúes-de-tener-nuestras-capas-domain-application-e-infraestructure"><span class="mr-2">¿Que se viene despúes de tener nuestras capas domain, application e infraestructure?</span><a href="#que-se-viene-despúes-de-tener-nuestras-capas-domain-application-e-infraestructure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ahora nos queda configurar los módulos <code class="language-plaintext highlighter-rouge">core</code>, <code class="language-plaintext highlighter-rouge">infraestructure</code> y <code class="language-plaintext highlighter-rouge">northwind-database</code>, para ello necesitamos definir CustomProviders y Módulos dinámicos de Nestjs, estos son temas avanzados dentro el framework que los abordaré en otro post con mayor detalle les dejaré el repositorio con el código donde podrán revisar la configuración, pero se vienen cosas más avanzadas donde explicaremos a fondo estas funcionalidades y que podemos hacer.</p><p>Puedes ver los demás artículos de arquitectura hexagonal acá 😉</p><ul><li><a href="/posts/implementando-hexagonal-con-nestjs-part2/">Arquitectura hexagonal Parte II </a><li><a href="/posts/implementando-hexagonal-con-nestjs-part3/">Arquitectura hexagonal Parte III </a><li><a href="/posts/implementando-hexagonal-con-nestjs-part4/">Arquitectura hexagonal Parte IV </a></ul><h2 id="github-repository"><span class="mr-2"><a href="https://github.com/nullpointer-excelsior/nestjs-northwind-hexagonal">Github repository</a></span><a href="#github-repository" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Finalizando con meme de despedida aca las conclusiones son del lector.</p><p><img data-src="https://i.ibb.co/VMK6zFv/Zombo-Meme-08102022161800.jpg" alt="meme" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/programacion/'>Programacion</a>, <a href='//categories/nestjs/'>Nestjs</a>, <a href='//categories/arquitectura-de-software/'>Arquitectura de software</a>, <a href='//categories/typescript/'>Typescript</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/typescript/" class="post-tag no-text-decoration" >typescript</a> <a href="//tags/nestjs/" class="post-tag no-text-decoration" >nestjs</a> <a href="//tags/hexagonal/" class="post-tag no-text-decoration" >hexagonal</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada está licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Arquitectura+hexagonal+con+nestjs+Parte+I+-+Nullpointer+Excelsior&url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fimplementando-hexagonal-con-nestjs-part1%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Arquitectura+hexagonal+con+nestjs+Parte+I+-+Nullpointer+Excelsior&u=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fimplementando-hexagonal-con-nestjs-part1%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fimplementando-hexagonal-con-nestjs-part1%2F&text=Arquitectura+hexagonal+con+nestjs+Parte+I+-+Nullpointer+Excelsior" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fimplementando-hexagonal-con-nestjs-part1%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Actualizado recientemente</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/microservicios-observabilidad-en-microservicios-un-ejemplo-practico-de-trazas-distribuidas/">Microservicios 2 Observabilidad en NestJs, un ejemplo práctico de trazas distribuidas</a><li><a href="/posts/realtime-with-reactive-programming/">Aplicaciones en tiempo real con programación reactiva</a><li><a href="/posts/tranajando-con-1millon-de-registros-con-java-stream/">Trabajando con 1 millón de registros con Java Stream</a><li><a href="/posts/disenando-microservicios-con-ddd/">Diseñando Microservicios con Domain Driven Design y NestJS</a><li><a href="/posts/alto-rendimiento-con-cqrs-eventos-en-nestjs/">CQRS en Soluciones de Alto Rendimiento con Nestjs</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/implementando-hexagonal-con-nestjs-part2/"><div class="card-body"> <em class="small" data-ts="1666798320" data-df="YYYY-MM-DD" > 2022-10-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Arquitectura hexagonal Parte II Conectando una clean architecture con Nestjs</h3><div class="text-muted small"><p> La segunda parte de esta serie de arquitectura hexagonal o (clean architecture) profundizaremos como configurar la interacción de un framework con el core de nuestra arquitectura, Nestjs nos ofre...</p></div></div></a></div><div class="card"> <a href="/posts/nestjs-tips-la-versatilidad-de-configuration-module/"><div class="card-body"> <em class="small" data-ts="1666971120" data-df="YYYY-MM-DD" > 2022-10-28 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Nestjs tips La versatilidad de ConfigMdule</h3><div class="text-muted small"><p> El manejo de credenciales y configuraciones en nuestras aplicaciones es generalmente algo indispensable para los distintos escenarios de desarrollo y despliegue. Algo tedioso a veces, pero nuestr...</p></div></div></a></div><div class="card"> <a href="/posts/implementando-hexagonal-con-nestjs-part3/"><div class="card-body"> <em class="small" data-ts="1667835120" data-df="YYYY-MM-DD" > 2022-11-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Arquitectura hexagonal Parte III Modelando el Dominio a Fondo con Domain Driven Design</h3><div class="text-muted small"><p> En post anteriores vimos como implementar una arquitectura hexagonal y aprendimos sus principales conceptos y componentes. En esta oportunidad modelaremos en profundidad el Dominio de nuestra apl...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/sqli/" class="btn btn-outline-primary" prompt="Anterior"><p>Cuando un SQL Injection deja a tu aplicación como un chiste</p></a> <a href="//posts/implementando-hexagonal-con-nestjs-part2/" class="btn btn-outline-primary" prompt="Nuevo"><p>Arquitectura hexagonal Parte II Conectando una clean architecture con Nestjs</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/nullpointer-excelsior">Benjamin</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Hecho con <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
