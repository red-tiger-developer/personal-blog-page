<!DOCTYPE html><html lang="es-ES" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Arquitectura hexagonal Parte II Conectando una clean architecture con Nestjs" /><meta name="author" content="Benjamin" /><meta property="og:locale" content="es_ES" /><meta name="description" content="IngenierÃ­a de software aplicada, tips, buenas prÃ¡ctias y cÃ³digos" /><meta property="og:description" content="IngenierÃ­a de software aplicada, tips, buenas prÃ¡ctias y cÃ³digos" /><link rel="canonical" href="https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part2/" /><meta property="og:url" content="https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part2/" /><meta property="og:site_name" content="Nullpointer Excelsior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-26T12:32:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Arquitectura hexagonal Parte II Conectando una clean architecture con Nestjs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Benjamin"},"dateModified":"2022-12-05T00:19:47-03:00","datePublished":"2022-10-26T12:32:00-03:00","description":"IngenierÃ­a de software aplicada, tips, buenas prÃ¡ctias y cÃ³digos","headline":"Arquitectura hexagonal Parte II Conectando una clean architecture con Nestjs","mainEntityOfPage":{"@type":"WebPage","@id":"https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part2/"},"url":"https://nullpointer-excelsior.github.io/posts/implementando-hexagonal-con-nestjs-part2/"}</script><title>Arquitectura hexagonal Parte II Conectando una clean architecture con Nestjs | Nullpointer Excelsior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nullpointer Excelsior"><meta name="application-name" content="Nullpointer Excelsior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.webp" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nullpointer Excelsior</a></div><div class="site-subtitle font-italic">IngenierÃ­a de software aplicada</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÃAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/nullpointer-excelsior" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Arquitectura hexagonal Parte II Conectando una clean architecture con Nestjs</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Arquitectura hexagonal Parte II Conectando una clean architecture con Nestjs</h1><div class="post-meta text-muted"> <span> Publicado <em class="" data-ts="1666798320" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-10-26 </em> </span> <span> Actualizado <em class="" data-ts="1670210387" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-12-05 </em> </span><div class="d-flex justify-content-between"> <span> Por <em> Benjamin </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2185 palabras"> <em>12 min</em> de lectura</span></div></div></div><div class="post-content"><p><img data-src="https://i.ibb.co/6nTjp5n/Screen-Shot-2022-11-02-at-16-17-23.png" alt="logo" data-proofer-ignore></p><p>La segunda parte de esta serie de arquitectura hexagonal o (clean architecture) profundizaremos como configurar la interacciÃ³n de un framework con el core de nuestra arquitectura, Nestjs nos ofrece un diseÃ±o adaptable para poder cubrir casos de uso avanzado. La idea es estar lo menos acoplados al framework y que este se adapte a nuestra capa <code class="language-plaintext highlighter-rouge">core</code> la cual contienen los casos de uso, las reglas de negocio y las entidades.</p><h2 id="quÃ©-es-nestjs-short-answer"><span class="mr-2">Â¿QuÃ© es Nestjs? short answer</span><a href="#quÃ©-es-nestjs-short-answer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Nestjs es un framework progresivo de NodeJS desarrollado en TypeScript diseÃ±ado para facilitar el desarrollo de aplicaciones backend, aportando a los programadores una buena estructura y metodologÃ­a inicial. Una de sus caracterÃ­sticas es que puedes desarrollar cualquier tipo de proyecto backend, ya que las integraciones estÃ¡n ya disponibles en el framework y solo necesitaras instalar el mÃ³dulo para poder trabajar, otro punto importante es que sigue la misma arquitectura que angular podemos desarrollar aplicaciones mediante anotaciones, mÃ³dulos y podemos hacer uso de la inyecciÃ³n de dependencias para crear nuestras clases de servicios, Resumiendo Nestjs es como el spring de Nodejs.</p><h2 id="custom-providers-y-mÃ³dulos-dinÃ¡micos-en-nestjs"><span class="mr-2">Custom providers y mÃ³dulos dinÃ¡micos en Nestjs</span><a href="#custom-providers-y-mÃ³dulos-dinÃ¡micos-en-nestjs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="custom-providers"><span class="mr-2">Custom Providers</span><a href="#custom-providers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Unos de los conceptos principales de nestsjs son los provider que no son nada mÃ¡s que clases de tipo service, objetos o valores que pueden ser inyectados en la aplicaciÃ³n la forma simple es mediante anotaciones, pero como nuestro proyecto necesita ser integrado al framework de una forma limpia emplearemos el uso de custom providers para lograr nuestro objetivo.</p><h3 id="mÃ³dulos-dinÃ¡micos"><span class="mr-2">MÃ³dulos dinÃ¡micos</span><a href="#mÃ³dulos-dinÃ¡micos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Los mÃ³dulos bÃ¡sicamente son una pieza de software que agrupa una capa o una funcionalidad de la aplicaciÃ³n esta contienen controllers, providers y toda pieza de software relacionada con la idea del mÃ³dulo. Los componentes creados bajo el contexto de Nestjs pueden estar aislados o ser exportadas a otros mÃ³dulos. En Nestjs puedes crear mÃ³dulos estÃ¡ticos en los cuales definimos dependencias, providers y controllers y con esto podras reutilizarlo en otros mÃ³dulos, pero en escenarios mÃ¡s complejos puedes definirlos de forma dinÃ¡mica, esta caracterÃ­stica nos permite crear fÃ¡cilmente mÃ³dulos personalizables que pueden registrar y configurar proveedores de forma dinÃ¡mica. Justo lo que necesitamos para nuestra aplicaciÃ³n.</p><h2 id="manos-a-la-obra-integrando-nuestra-arquitectura-hexagonal-con-nestjs"><span class="mr-2">Manos a la obra integrando nuestra arquitectura hexagonal con Nestjs</span><a href="#manos-a-la-obra-integrando-nuestra-arquitectura-hexagonal-con-nestjs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La estructura de nuestra aplicaciÃ³n actualmente es esta, ya hay definidos unos archivos <code class="language-plaintext highlighter-rouge">XXX.module.ts</code> entonces partiremos por configurar el mÃ³dulo <code class="language-plaintext highlighter-rouge">core</code>.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre>â”œâ”€â”€ ï„• core
â”‚   â”œâ”€â”€ ï„• application
â”‚   â”‚   â”œâ”€â”€ î˜¨ ProductApplication.ts
â”‚   â”‚   â””â”€â”€ ï„• services
â”‚   â”‚       â”œâ”€â”€ î˜¨ ProductApplicationService.spec.ts
â”‚   â”‚       â””â”€â”€ î˜¨ ProductApplicationService.ts
â”‚   â”œâ”€â”€ î˜¨ core.module.ts
â”‚   â”œâ”€â”€ ï„• domain
â”‚   â”‚   â”œâ”€â”€ ï„• entities
â”‚   â”‚   â”‚   â”œâ”€â”€ î˜¨ Category.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ î˜¨ Product.ts
â”‚   â”‚   â”‚   â””â”€â”€ î˜¨ Supplier.ts
â”‚   â”‚   â”œâ”€â”€ ï„• ports
â”‚   â”‚   â”‚   â”œâ”€â”€ ï„• inbound
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ î˜¨ CategoryService.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ î˜¨ ProductService.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ î˜¨ SupplierService.ts
â”‚   â”‚   â”‚   â””â”€â”€ ï„• outbound
â”‚   â”‚   â”‚       â”œâ”€â”€ î˜¨ CategoryRepository.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ î˜¨ ProductRepository.ts
â”‚   â”‚   â”‚       â””â”€â”€ î˜¨ SupplierRepository.ts
â”‚   â”‚   â””â”€â”€ ï„• services
â”‚   â”‚       â”œâ”€â”€ î˜¨ CategoryDomainService.spec.ts
â”‚   â”‚       â”œâ”€â”€ î˜¨ CategoryDomainService.ts
â”‚   â”‚       â”œâ”€â”€ î˜¨ ProductDomainService.spec.ts
â”‚   â”‚       â”œâ”€â”€ î˜¨ ProductDomainService.ts
â”‚   â”‚       â”œâ”€â”€ î˜¨ SupplierDomainService.spec.ts
â”‚   â”‚       â””â”€â”€ î˜¨ SupplierDomainService.ts
â”‚   â””â”€â”€ ï„• shared
â”‚       â”œâ”€â”€ ï„• dto
â”‚       â”‚   â””â”€â”€ î˜¨ NewProductDTO.ts
â”‚       â””â”€â”€ ï„• error
â”‚           â”œâ”€â”€ î˜¨ ProductApplicationError.ts
â”‚           â””â”€â”€ î˜¨ ProductServiceError.ts
â”œâ”€â”€ ï„• infraestructure
â”‚   â”œâ”€â”€ ï„• adapters
â”‚   â”‚   â”œâ”€â”€ î˜¨ category.repository.adapter.ts
â”‚   â”‚   â”œâ”€â”€ î˜¨ product.repository.adapter.ts
â”‚   â”‚   â””â”€â”€ î˜¨ supplier.repository.adapter.ts
â”‚   â”œâ”€â”€ ï„• http-server
â”‚   â”‚   â”œâ”€â”€ ï„• controllers
â”‚   â”‚   â”‚   â”œâ”€â”€ î˜¨ product.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ î˜¨ root.controller.ts
â”‚   â”‚   â”œâ”€â”€ ï„• exception-filters
â”‚   â”‚   â”‚   â””â”€â”€ î˜¨ product-exception.filter.ts
â”‚   â”‚   â”œâ”€â”€ î˜¨ http-server.module.ts
â”‚   â”‚   â”œâ”€â”€ ï„• model
â”‚   â”‚   â”‚   â”œâ”€â”€ î˜¨ app.response.ts
â”‚   â”‚   â”‚   â””â”€â”€ î˜¨ create-product.request.ts
â”‚   â”‚   â””â”€â”€ ï„• utils
â”‚   â”‚       â””â”€â”€ î˜¨ generate-swagger-docs.ts
â”‚   â”œâ”€â”€ î˜¨ infraestructure.module.ts
â”‚   â”œâ”€â”€ ï„• northwind-database
â”‚   â”‚   â”œâ”€â”€ ï„• entities
â”‚   â”‚   â”‚   â”œâ”€â”€ î˜¨ category.entity.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ î˜¨ product.entity.ts
â”‚   â”‚   â”‚   â””â”€â”€ î˜¨ supplier.entity.ts
â”‚   â”‚   â””â”€â”€ î˜¨ northwind-database.module.ts
â”‚   â””â”€â”€ ï„• shared
â”‚       â”œâ”€â”€ î˜¨ Log.ts
â”‚       â””â”€â”€ î˜¨ shared.module.ts

</pre></table></code></div></div><p>Para crear un mÃ³dulo dinÃ¡mico debemos crear un mÃ©todo estÃ¡tico que devolverÃ¡ un objeto <code class="language-plaintext highlighter-rouge">DynamicModule</code> del paquete <code class="language-plaintext highlighter-rouge">@Nest/common</code> que bÃ¡sicamente es lo mismo que usar la anotaciÃ³n <code class="language-plaintext highlighter-rouge">@Module</code> la cual define las propiedades del mÃ³dulo la Ãºnica diferencia es que DynamicModule el parÃ¡metro module es obligatorio y hace referencia al mismo mÃ³dulo. El nombre del mÃ³dulo <code class="language-plaintext highlighter-rouge">register()</code> no es mandatorio por convenciÃ³n los nombres utilizados son <code class="language-plaintext highlighter-rouge">forRoot()</code>, <code class="language-plaintext highlighter-rouge">forAsyncRoot()</code>, <code class="language-plaintext highlighter-rouge">register()</code> y <code class="language-plaintext highlighter-rouge">asyncRegister()</code> este mÃ©todo puede ser tanto asÃ­ncrono como sÃ­ncrono.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">DynamicModule</span><span class="p">,</span> <span class="nx">Module</span><span class="p">,</span> <span class="nx">Type</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@Nestjs/common</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Module</span><span class="p">({})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CoreModule</span> <span class="p">{</span>

  <span class="k">static</span> <span class="nx">register</span><span class="p">():</span> <span class="nx">DynamicModule</span> <span class="p">{</span>
    <span class="k">return</span> <span class="c1">// my awesome module config</span>
  <span class="p">}</span>

<span class="p">}</span>

</pre></table></code></div></div><p>El siguiente paso serÃ¡ definir que parÃ¡metros recibirÃ¡ nuestro mÃ©todo, ya que acÃ¡ es donde la definiremos la configuraciÃ³n de nuestro mÃ³dulo. entonces creamos la siguiente interface</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">type</span> <span class="nx">CoreModuleOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">modules</span><span class="p">:</span> <span class="nx">Type</span><span class="p">[];</span>
  <span class="nl">adapters</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">productService</span><span class="p">:</span> <span class="nx">Type</span><span class="o">&lt;</span><span class="nx">ProductService</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nl">categoryService</span><span class="p">:</span> <span class="nx">Type</span><span class="o">&lt;</span><span class="nx">CategoryService</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nl">supplierService</span><span class="p">:</span> <span class="nx">Type</span><span class="o">&lt;</span><span class="nx">SupplierService</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>La propiedad <code class="language-plaintext highlighter-rouge">modules</code> recibirÃ¡ los mÃ³dulos dependencias que contendrÃ¡n los servicios que necesitemos inyectar en nuestro mÃ³dulo <code class="language-plaintext highlighter-rouge">core</code>. Esta interface mediante su porpiedad <code class="language-plaintext highlighter-rouge">adapters</code> recibirÃ¡ las implementaciones de las interfaces <code class="language-plaintext highlighter-rouge">ProductService</code>, <code class="language-plaintext highlighter-rouge">CategoryService</code> y <code class="language-plaintext highlighter-rouge">SupplierService</code> las cuales definimos como puertos en nuestra capa <code class="language-plaintext highlighter-rouge">core</code>.</p><p>Nuestro mÃ³dulo va tomando esta forma.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">DynamicModule</span><span class="p">,</span> <span class="nx">Module</span><span class="p">,</span> <span class="nx">Type</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@Nestjs/common</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Module</span><span class="p">({})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CoreModule</span> <span class="p">{</span>

  <span class="k">static</span> <span class="nx">register</span><span class="p">(</span><span class="nx">options</span><span class="p">:</span> <span class="nx">CoreModuleOptions</span><span class="p">):</span> <span class="nx">DynamicModule</span> <span class="p">{</span>
    
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">adapters</span><span class="p">,</span> <span class="nx">modules</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">options</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">productService</span><span class="p">,</span> <span class="nx">categoryService</span><span class="p">,</span> <span class="nx">supplierService</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">adapters</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="na">module</span><span class="p">:</span> <span class="nx">CoreModule</span><span class="p">,</span>
      <span class="na">providers</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>

  <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>Muy bien el prÃ³ximo paso es definir los <code class="language-plaintext highlighter-rouge">providers</code> en este caso necesitamos primero definir los token que son nada mÃ¡s que strings Ãºnicos que serÃ¡n utilizados para identificar que <code class="language-plaintext highlighter-rouge">provider</code> queremos inyectar</p><p>definimos los siguientes providers:</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1">// Application service reference</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">PRODUCT_APPLICATION</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">PRODUCT_APPLICATION</span><span class="dl">'</span>
<span class="c1">// domain services references</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">CATEGORY_SERVICE</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">CATEGORY_SERVICE</span><span class="dl">'</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">PRODUCT_SERVICE</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">PRODUCT_SERVICE</span><span class="dl">'</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">SUPPLIER_SERVICE</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SUPPLIER_SERVICE</span><span class="dl">'</span>
</pre></table></code></div></div><p>Ahora crearemos una objeto que definirÃ¡ nuestro custom provider este deberÃ¡ tener las siguientes propiedades:</p><ul><li><code class="language-plaintext highlighter-rouge">provide</code>: es la clase del provider o un string con el nombre de un servicio el cual Nestjs tendrÃ¡ que inyectar en donde se solicite su uso, en nuestro caso no vamos a inyectar una clase sino una interfaz, por lo tanto, debemos definir un nombre, ya que en Nestjs para inyectar un valor que no es una clase se necesita definir un Injection token que nada mÃ¡s que un string identificatorio<li><code class="language-plaintext highlighter-rouge">useFactrory</code>: es una funciÃ³n que recibe argumentos y devuelve el objeto que queremos definir como un custom provider los argumentos que recibirÃ¡ esta funciÃ³n en este caso son los servicios que queremos que Nestjs inyecte a nuestro ProductApplicationService (casos de uso de la entidad productos)y para poder inyectar los servicios que necesita se hace mediante la propiedad inject<li><code class="language-plaintext highlighter-rouge">inject</code>: es un array de proveedores existentes en el mÃ³dulo los cuales serÃ¡n los parÃ¡metros de la funciÃ³n useFactory()</ul><p>Entonces para crear un Custom Provider para un servicio de dominio serÃ¡ de la siguiente manera:</p><p>Como nuestro modelo lo indica para crear el servicio de dominio ProductService</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductDomainService</span> <span class="k">implements</span> <span class="nx">ProductService</span> <span class="p">{</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">ProductRepository</span><span class="p">)</span> <span class="p">{}</span>

    <span class="k">async</span> <span class="nx">save</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">validateProductPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">product</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">ProductServiceError</span><span class="p">(</span><span class="dl">'</span><span class="s1">Product price cannot be negative or equal to zero</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">validateProductPrice</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">product</span><span class="p">.</span><span class="nx">unitPrice</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>necesitamos de un ProductRepository</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">ProductRepository</span><span class="p">)</span> <span class="p">{}</span>
</pre></table></code></div></div><p>Donde <code class="language-plaintext highlighter-rouge">productRepository</code> proviene del objeto <code class="language-plaintext highlighter-rouge">CoreModuleOptions</code> entonces creamos una funciÃ³n <code class="language-plaintext highlighter-rouge">ProductServiceProvider</code> donde injectaremos los servicios necesarios para crear nuestro <code class="language-plaintext highlighter-rouge">ProductDomainService</code></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>
<span class="kd">const</span> <span class="nx">ProductServiceProvider</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">provide</span><span class="p">:</span> <span class="nx">PRODUCT_SERVICE</span><span class="p">,</span> <span class="c1">// provider token</span>
  <span class="nx">useFactory</span><span class="p">(</span><span class="na">repository</span><span class="p">:</span> <span class="nx">ProductRepository</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// return a service instance </span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">ProductDomainService</span><span class="p">(</span><span class="nx">repository</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="na">inject</span><span class="p">:[</span>
    <span class="nx">productRepository</span> <span class="c1">// get this value from CoreModuleOptions</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></table></code></div></div><p>La funciÃ³n useFactory es sencilla solo recibe los providers inyectados por Nestjs que necesitamos y con eso podemos instanciar un Servicio de forma manual pero adecuado a nuestras necesitades.</p><p>En este otro caso nosotros devolvemos la instancia de una implementacion de la interfaz <code class="language-plaintext highlighter-rouge">ProductApplication</code></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>
  <span class="kd">function</span> <span class="nx">useFactory</span><span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">ProductDomainService</span><span class="p">,</span> <span class="nx">category</span><span class="p">:</span> <span class="nx">CategoryDomainService</span><span class="p">,</span> <span class="nx">supplier</span><span class="p">:</span> <span class="nx">SupplierDomainService</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ProductApplication implementation</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">ProductApplicationService</span><span class="p">(</span><span class="nx">product</span><span class="p">,</span> <span class="nx">category</span><span class="p">,</span> <span class="nx">supplier</span><span class="p">)</span>
  <span class="p">}</span>
</pre></table></code></div></div><p>La inyecciÃ³n de nuestro Servicio de applicaciÃ³n serÃ¡ de la siguiente manera con la diferencia que injectamos los token en vez de los adapters que recibiremos:</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">ProductApplicationProvider</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">provide</span><span class="p">:</span> <span class="nx">PRODUCT_APPLICATION</span><span class="p">,</span>
      <span class="nx">useFactory</span><span class="p">(</span><span class="na">product</span><span class="p">:</span> <span class="nx">ProductDomainService</span><span class="p">,</span> <span class="na">category</span><span class="p">:</span> <span class="nx">CategoryDomainService</span><span class="p">,</span> <span class="na">supplier</span><span class="p">:</span> <span class="nx">SupplierDomainService</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">ProductApplicationService</span><span class="p">(</span><span class="nx">product</span><span class="p">,</span> <span class="nx">category</span><span class="p">,</span> <span class="nx">supplier</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="na">inject</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">PRODUCT_SERVICE</span><span class="p">,</span>
        <span class="nx">CATEGORY_SERVICE</span><span class="p">,</span>
        <span class="nx">SUPPLIER_SERVICE</span>
      <span class="p">]</span>
    <span class="p">}</span>
</pre></table></code></div></div><p>Finalmente nuestro mÃ³dulo core es el siguiente</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
</pre><td class="rouge-code"><pre><span class="cm">/**
 * Options for core module 
 */</span>
<span class="k">export</span> <span class="kd">type</span> <span class="nx">CoreModuleOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">modules</span><span class="p">:</span> <span class="nx">Type</span><span class="p">[];</span>
  <span class="nl">adapters</span><span class="p">?:</span> <span class="p">{</span>
    <span class="na">productRepository</span><span class="p">:</span> <span class="nx">Type</span><span class="o">&lt;</span><span class="nx">ProductRepository</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nl">categoryRepository</span><span class="p">:</span> <span class="nx">Type</span><span class="o">&lt;</span><span class="nx">CategoryRepository</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="nl">supplierRepository</span><span class="p">:</span> <span class="nx">Type</span><span class="o">&lt;</span><span class="nx">SupplierRepository</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**
 * Providers token for netsjs injection
 */</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">PRODUCT_APPLICATION</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">PRODUCT_APPLICATION</span><span class="dl">'</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">CATEGORY_SERVICE</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">CATEGORY_SERVICE</span><span class="dl">'</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">PRODUCT_SERVICE</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">PRODUCT_SERVICE</span><span class="dl">'</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">SUPPLIER_SERVICE</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SUPPLIER_SERVICE</span><span class="dl">'</span>


<span class="p">@</span><span class="nd">Module</span><span class="p">({})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CoreModule</span> <span class="p">{</span>

  <span class="k">static</span> <span class="nx">register</span><span class="p">({</span> <span class="nx">modules</span><span class="p">,</span> <span class="nx">adapters</span> <span class="p">}:</span> <span class="nx">CoreModuleOptions</span><span class="p">):</span> <span class="nx">DynamicModule</span> <span class="p">{</span>

    <span class="kd">const</span> <span class="p">{</span> <span class="nx">categoryRepository</span><span class="p">,</span> <span class="nx">productRepository</span><span class="p">,</span> <span class="nx">supplierRepository</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">adapters</span>
    <span class="cm">/**
     * ApplicationService Provider
     * */</span>
    <span class="kd">const</span> <span class="nx">ProductApplicationProvider</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">provide</span><span class="p">:</span> <span class="nx">PRODUCT_APPLICATION</span><span class="p">,</span>
      <span class="nx">useFactory</span><span class="p">(</span><span class="na">product</span><span class="p">:</span> <span class="nx">ProductDomainService</span><span class="p">,</span> <span class="na">category</span><span class="p">:</span> <span class="nx">CategoryDomainService</span><span class="p">,</span> <span class="na">supplier</span><span class="p">:</span> <span class="nx">SupplierDomainService</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">ProductApplicationService</span><span class="p">(</span><span class="nx">product</span><span class="p">,</span> <span class="nx">category</span><span class="p">,</span> <span class="nx">supplier</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="na">inject</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">PRODUCT_SERVICE</span><span class="p">,</span>
        <span class="nx">CATEGORY_SERVICE</span><span class="p">,</span>
        <span class="nx">SUPPLIER_SERVICE</span>
      <span class="p">]</span>
    <span class="p">}</span>

    <span class="cm">/**
     * DomainService Providers
     * */</span>
    <span class="kd">const</span> <span class="nx">CategoryServiceProvider</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">provide</span><span class="p">:</span> <span class="nx">CATEGORY_SERVICE</span><span class="p">,</span>
      <span class="nx">useFactory</span><span class="p">(</span><span class="na">repository</span><span class="p">:</span> <span class="nx">CategoryRepository</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">CategoryDomainService</span><span class="p">(</span><span class="nx">repository</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="na">inject</span><span class="p">:[</span>
        <span class="nx">categoryRepository</span>
      <span class="p">]</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">SupplierServiceProvider</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">provide</span><span class="p">:</span> <span class="nx">PRODUCT_SERVICE</span><span class="p">,</span>
      <span class="nx">useFactory</span><span class="p">(</span><span class="na">repository</span><span class="p">:</span> <span class="nx">ProductRepository</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">ProductDomainService</span><span class="p">(</span><span class="nx">repository</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="na">inject</span><span class="p">:[</span>
        <span class="nx">productRepository</span>
      <span class="p">]</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">ProductServiceProvider</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">provide</span><span class="p">:</span> <span class="nx">SUPPLIER_SERVICE</span><span class="p">,</span>
      <span class="nx">useFactory</span><span class="p">(</span><span class="na">repository</span><span class="p">:</span> <span class="nx">SupplierRepository</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">SupplierDomainService</span><span class="p">(</span><span class="nx">repository</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="na">inject</span><span class="p">:[</span>
        <span class="nx">supplierRepository</span>
      <span class="p">]</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="na">module</span><span class="p">:</span> <span class="nx">CoreModule</span><span class="p">,</span>
      <span class="na">global</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">...</span><span class="nx">modules</span>
      <span class="p">],</span>
      <span class="na">providers</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">ProductApplicationProvider</span><span class="p">,</span>
        <span class="nx">CategoryServiceProvider</span><span class="p">,</span>
        <span class="nx">SupplierServiceProvider</span><span class="p">,</span>
        <span class="nx">ProductServiceProvider</span>
      <span class="p">],</span>
      <span class="na">exports</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">PRODUCT_APPLICATION</span>
      <span class="p">],</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>Ahora lo siguiente serÃ¡ registrar a <code class="language-plaintext highlighter-rouge">core</code> en la raiz de todos mÃ³dulos en <code class="language-plaintext highlighter-rouge">app.module</code> llamando al mÃ©todo register().</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nx">CoreModule</span><span class="p">.</span><span class="nx">register</span><span class="p">({</span>
  <span class="na">modules</span><span class="p">:</span> <span class="p">[</span>
      <span class="nx">InfraestructureModule</span>
  <span class="p">],</span>
  <span class="na">adapters</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">productRepository</span><span class="p">:</span> <span class="nx">ProductRepositoryAdapter</span><span class="p">,</span>
    <span class="na">categoryRepository</span><span class="p">:</span> <span class="nx">CategoryRepositoryAdapter</span><span class="p">,</span>
    <span class="na">supplierRepository</span><span class="p">:</span> <span class="nx">SupplierRepositoryAdapter</span>
  <span class="p">}</span>
<span class="p">}),</span>
</pre></table></code></div></div><p>El mÃ³dulo principal de la aplicaciÃ³n registrarÃ¡ a <code class="language-plaintext highlighter-rouge">core</code> y shared` de forma global es decir, estarÃ¡ disponible para todos los mÃ³dulos que definamos en nuestra aplicaciÃ³n sin necesidad de hacer excesivos imports en nuestras definiciones de mÃ³dulos.</p><p>Para lograr esto se hace mediante la propiedad <code class="language-plaintext highlighter-rouge">global: true</code> definiendo en el decorador <code class="language-plaintext highlighter-rouge">@Module()</code> o en el objeto <code class="language-plaintext highlighter-rouge">DynamicModule</code>.</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>
<span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
  <span class="na">global</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">...</span><span class="nx">otherprops</span>
<span class="p">})</span>

<span class="p">@</span><span class="nd">Module</span><span class="p">({})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CoreModule</span> <span class="p">{</span>

  <span class="k">static</span> <span class="nx">register</span><span class="p">(</span><span class="nx">options</span><span class="p">:</span> <span class="nx">CoreModuleOptions</span><span class="p">):</span> <span class="nx">DynamicModule</span> <span class="p">{</span>
    <span class="c1">// ...ommited </span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">module</span><span class="p">:</span> <span class="nx">CoreModule</span><span class="p">,</span>
      <span class="na">global</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="c1">// other props omitted</span>
  <span class="p">}</span>

<span class="p">}</span>

</pre></table></code></div></div><p>Por Ãºltimo registramos el mÃ³dulo <code class="language-plaintext highlighter-rouge">infraestructure</code> para terminar de conectar todas las capas de nuestra aplicaciÃ³n. El resultado final es el siguiente en AppModule:</p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Â¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">InfraestructureModule</span><span class="p">,</span>
    <span class="nx">SharedModule</span><span class="p">,</span>
    <span class="nx">CoreModule</span><span class="p">.</span><span class="nx">register</span><span class="p">({</span>
      <span class="na">modules</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">InfraestructureModule</span>
      <span class="p">],</span>
      <span class="na">adapters</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">productRepository</span><span class="p">:</span> <span class="nx">ProductRepositoryAdapter</span><span class="p">,</span>
        <span class="na">categoryRepository</span><span class="p">:</span> <span class="nx">CategoryRepositoryAdapter</span><span class="p">,</span>
        <span class="na">supplierRepository</span><span class="p">:</span> <span class="nx">SupplierRepositoryAdapter</span>
      <span class="p">}</span>
    <span class="p">}),</span>
  <span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{</span> <span class="p">}</span>
</pre></table></code></div></div><p>Finalmente integramos nuestra arquitectura hexagonal con Nestjs de una manera totalmente desacoplada del framework. La versatilidad de los mÃ³dulos dinÃ¡micos y custom providers nos permiten crear aplicaciones mantenibles y con lÃ³gicas desconectadas de frameworks o las librerÃ­as de moda. Este mismo enfoque de los mÃ³dulos dinÃ¡micos es una buena prÃ¡ctica al momento de definir grupos de piezas de software que queremos que sean flexibles y configurables de una forma centralizada.</p><h2 id="github-repository"><span class="mr-2"><a href="https://github.com/nullpointer-excelsior/nestjs-northwind-hexagonal/tree/main/clean-architecture-examples/part-2-connecting-core-infraestructure-with-nestjs">Github repository</a></span><a href="#github-repository" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Puedes ver los demÃ¡s artÃ­culos de arquitectura hexagonal acÃ¡ ğŸ˜‰</p><ul><li><a href="/posts/implementando-hexagonal-con-nestjs-part1/">Arquitectura hexagonal Parte I </a><li><a href="/posts/implementando-hexagonal-con-nestjs-part3/">Arquitectura hexagonal Parte III </a><li><a href="/posts/implementando-hexagonal-con-nestjs-part4/">Arquitectura hexagonal Parte IV </a></ul><h2 id="conclusiÃ³n"><span class="mr-2">ConclusiÃ³n</span><a href="#conclusiÃ³n" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>No soy de conclusiones estas siempre van por parte de ti y si intentas poner en prÃ¡ctica lo expuesto podrÃ¡s tener un concepto mÃ¡s amplio del tema e incluso poder aplicarlo en otros escenarios.</p><p><img data-src="https://i.ibb.co/zQsBcqS/Bean-Cheating-02112022164520.jpg" alt="meme" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/programacion/'>Programacion</a>, <a href='//categories/nestjs/'>Nestjs</a>, <a href='//categories/arquitectura-de-software/'>Arquitectura de software</a>, <a href='//categories/typescript/'>Typescript</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/typescript/" class="post-tag no-text-decoration" >typescript</a> <a href="//tags/nestjs/" class="post-tag no-text-decoration" >nestjs</a> <a href="//tags/hexagonal/" class="post-tag no-text-decoration" >hexagonal</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada estÃ¡ licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Arquitectura+hexagonal+Parte+II+Conectando+una+clean+architecture+con+Nestjs+-+Nullpointer+Excelsior&url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fimplementando-hexagonal-con-nestjs-part2%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Arquitectura+hexagonal+Parte+II+Conectando+una+clean+architecture+con+Nestjs+-+Nullpointer+Excelsior&u=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fimplementando-hexagonal-con-nestjs-part2%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fimplementando-hexagonal-con-nestjs-part2%2F&text=Arquitectura+hexagonal+Parte+II+Conectando+una+clean+architecture+con+Nestjs+-+Nullpointer+Excelsior" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnullpointer-excelsior.github.io%2Fposts%2Fimplementando-hexagonal-con-nestjs-part2%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="Â¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Actualizado recientemente</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/microservicios-observabilidad-en-microservicios-un-ejemplo-practico-de-trazas-distribuidas/">Microservicios 2 Observabilidad en NestJs, un ejemplo prÃ¡ctico de trazas distribuidas</a><li><a href="/posts/realtime-with-reactive-programming/">Aplicaciones en tiempo real con programaciÃ³n reactiva</a><li><a href="/posts/tranajando-con-1millon-de-registros-con-java-stream/">Trabajando con 1 millÃ³n de registros con Java Stream</a><li><a href="/posts/disenando-microservicios-con-ddd/">DiseÃ±ando Microservicios con Domain Driven Design y NestJS</a><li><a href="/posts/alto-rendimiento-con-cqrs-eventos-en-nestjs/">CQRS en Soluciones de Alto Rendimiento con Nestjs</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/implementando-hexagonal-con-nestjs-part1/"><div class="card-body"> <em class="small" data-ts="1666711920" data-df="YYYY-MM-DD" > 2022-10-25 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Arquitectura hexagonal con nestjs Parte I</h3><div class="text-muted small"><p> No voy a profundizar en que es una arquitectura hexagonal, ya que tenemos un montÃ³n de recursos que te lo explican de forma detallada, pero ojo que cuando hablamos de este tipo de arquitecturas d...</p></div></div></a></div><div class="card"> <a href="/posts/nestjs-tips-la-versatilidad-de-configuration-module/"><div class="card-body"> <em class="small" data-ts="1666971120" data-df="YYYY-MM-DD" > 2022-10-28 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Nestjs tips La versatilidad de ConfigMdule</h3><div class="text-muted small"><p> El manejo de credenciales y configuraciones en nuestras aplicaciones es generalmente algo indispensable para los distintos escenarios de desarrollo y despliegue. Algo tedioso a veces, pero nuestr...</p></div></div></a></div><div class="card"> <a href="/posts/implementando-hexagonal-con-nestjs-part3/"><div class="card-body"> <em class="small" data-ts="1667835120" data-df="YYYY-MM-DD" > 2022-11-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Arquitectura hexagonal Parte III Modelando el Dominio a Fondo con Domain Driven Design</h3><div class="text-muted small"><p> En post anteriores vimos como implementar una arquitectura hexagonal y aprendimos sus principales conceptos y componentes. En esta oportunidad modelaremos en profundidad el Dominio de nuestra apl...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/implementando-hexagonal-con-nestjs-part1/" class="btn btn-outline-primary" prompt="Anterior"><p>Arquitectura hexagonal con nestjs Parte I</p></a> <a href="//posts/nestjs-tips-la-versatilidad-de-configuration-module/" class="btn btn-outline-primary" prompt="Nuevo"><p>Nestjs tips La versatilidad de ConfigMdule</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://github.com/nullpointer-excelsior">Benjamin</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explÃ­citamente, las entradas de este blog estÃ¡n licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Hecho con <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/nestjs/">nestjs</a> <a class="post-tag" href="/tags/arquitectura/">arquitectura</a> <a class="post-tag" href="/tags/hexagonal/">hexagonal</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/microservicios/">microservicios,</a> <a class="post-tag" href="/tags/typescript/">Typescript</a> <a class="post-tag" href="/tags/architecture/">Architecture</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Â¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
